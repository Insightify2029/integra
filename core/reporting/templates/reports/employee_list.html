{% extends "base.html" %}

{% block extra_styles %}
<style>
    .report-summary {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }

    .summary-card {
        background: linear-gradient(135deg, {{ primary_color }}, {{ primary_color }}dd);
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        text-align: center;
        min-width: 150px;
    }

    .summary-card .value {
        font-size: 28px;
        font-weight: bold;
        display: block;
    }

    .summary-card .label {
        font-size: 12px;
        opacity: 0.9;
    }

    .status-badge {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
    }

    .status-active {
        background: #d1fae5;
        color: #065f46;
    }

    .status-inactive {
        background: #fee2e2;
        color: #991b1b;
    }

    .status-suspended {
        background: #fef3c7;
        color: #92400e;
    }

    .employee-photo {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #e5e7eb;
    }

    .filters-info {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        padding: 10px 15px;
        margin-bottom: 15px;
        font-size: 12px;
        color: #64748b;
    }
</style>
{% endblock %}

{% block content %}
<!-- Summary Cards -->
<div class="report-summary">
    <div class="summary-card">
        <span class="value">{{ employees | length }}</span>
        <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</span>
    </div>

    {% if show_salary_summary %}
    <div class="summary-card">
        <span class="value">{{ employees | sum_column('salary') | currency }}</span>
        <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</span>
    </div>

    <div class="summary-card">
        <span class="value">{{ employees | avg_column('salary') | currency }}</span>
        <span class="label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨</span>
    </div>
    {% endif %}

    {% if departments_count %}
    <div class="summary-card">
        <span class="value">{{ departments_count }}</span>
        <span class="label">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</span>
    </div>
    {% endif %}
</div>

<!-- Applied Filters -->
{% if filters %}
<div class="filters-info">
    <strong>Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©:</strong>
    {% for filter in filters %}
    <span>{{ filter.label }}: {{ filter.value }}</span>{% if not loop.last %} | {% endif %}
    {% endfor %}
</div>
{% endif %}

<!-- Employee Table -->
<table>
    <thead>
        <tr>
            <th style="width: 40px;">#</th>
            {% if show_photo %}<th style="width: 50px;">Ø§Ù„ØµÙˆØ±Ø©</th>{% endif %}
            <th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
            {% if show_company %}<th>Ø§Ù„Ø´Ø±ÙƒØ©</th>{% endif %}
            <th>Ø§Ù„Ù‚Ø³Ù…</th>
            <th>Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</th>
            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ†</th>
            {% if show_salary %}<th>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</th>{% endif %}
            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
        </tr>
    </thead>
    <tbody>
        {% for emp in employees %}
        <tr>
            <td>{{ loop.index }}</td>
            {% if show_photo %}
            <td>
                {% if emp.photo %}
                <img src="{{ emp.photo }}" class="employee-photo" alt="{{ emp.name }}">
                {% else %}
                <div class="employee-photo" style="background: #e5e7eb; display: flex; align-items: center; justify-content: center; color: #9ca3af;">ğŸ‘¤</div>
                {% endif %}
            </td>
            {% endif %}
            <td>{{ emp.employee_number | default('-') }}</td>
            <td><strong>{{ emp.name }}</strong></td>
            {% if show_company %}<td>{{ emp.company | default('-') }}</td>{% endif %}
            <td>{{ emp.department | default('-') }}</td>
            <td>{{ emp.job_title | default('-') }}</td>
            <td>{{ emp.hire_date | date }}</td>
            {% if show_salary %}<td>{{ emp.salary | currency }}</td>{% endif %}
            <td>
                {% if emp.status == 'Ù†Ø´Ø·' or emp.is_active %}
                <span class="status-badge status-active">Ù†Ø´Ø·</span>
                {% elif emp.status == 'Ù…Ø¹Ù„Ù‚' %}
                <span class="status-badge status-suspended">Ù…Ø¹Ù„Ù‚</span>
                {% else %}
                <span class="status-badge status-inactive">ØºÙŠØ± Ù†Ø´Ø·</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
    {% if show_salary %}
    <tfoot>
        <tr>
            <td colspan="{{ 7 if show_company else 6 }}"><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</strong></td>
            <td><strong>{{ employees | sum_column('salary') | currency }}</strong></td>
            <td></td>
        </tr>
    </tfoot>
    {% endif %}
</table>

<!-- Page Info -->
<div class="page-info" style="margin-top: 20px; font-size: 11px; color: #9ca3af; text-align: center;">
    ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙŠ: {{ generated_at | datetime }} | Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: {{ employees | length }}
</div>
{% endblock %}
