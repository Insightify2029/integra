# INTEGRA v2.1 - ุฎุทุฉ ุชุทููุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ุงููุชูุฏูุฉ
**ุงูุชุงุฑูุฎ:** 2 ูุจุฑุงูุฑ 2026
**ุงูุญุงูุฉ:** ูุณูุฏุฉ ูููุฑุงุฌุนุฉ ูุงูุงุนุชูุงุฏ

---

## ูุธุฑุฉ ุนุงูุฉ

ูุฐู ุงูุฎุทุฉ ุชุบุทู **16 ูุญูุฑุงู ุฑุฆูุณูุงู** ูุชุทููุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ:

| ุงููุญูุฑ | ุงููุตู | ุงูุฃููููุฉ |
|---|---|---|
| **A** | ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุฃุณุงุณูุฉ (ูู ERP Research) โ | ุฃุณุงุณู - ููุจูู ุนููู ูู ุดูุก |
| **B** | ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุฏูุฌ (Ollama AI) โ | ุงุณุชุฑุงุชูุฌู - ูุฑูุน ููุงุกุฉ ุงูุนูู |
| **C** | ููุฏููู ุงูุฅูููู (Outlook Classic Sync) โ | ุชุดุบููู - ูุฑุจุท ุณูุฑ ุงูุนูู ุงููููู |
| **D** | ุชุญุณููุงุช ุงูููุชุจุงุช ุงููุชุงุญุฉ (Enhancement Track) โ | ุชุญุณููู - ุงุณุชุบูุงู ุงูุฅููุงููุงุช ุงูููุฌูุฏุฉ |
| **G** | ููุฏููู ุงูุฅูููู ุงููุชูุฏู (AI-Powered Email) โ | ูุชูุฏู - ุฐูุงุก ุงุตุทูุงุนู ููุฅูููู |
| **H** | ููุฏููู ุงูููุงู (Tasks Module) โ | ุงุณุชุฑุงุชูุฌู - ุงูููุจ ุงููุงุจุถ ูููุธุงู |
| **I** | ููุฏููู ุงูุชูููู (Calendar Module) โ | ุงุณุชุฑุงุชูุฌู - ุชูุธูู ุงูููุช ูุงูููุงุนูุฏ |
| **J** | ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฐูู (Smart Notifications) โ | ุฃุณุงุณู - ุงูุฑุงุจุท ุจูู ูู ุดูุก |
| **K** | ููุธููุฉ ูููุงุก AI ุงููุชูุงููุฉ (AI Orchestration) โ | ุซูุฑู - ุงูุนูู ุงููุฏุจุฑ ููุจุฑูุงูุฌ |
| **L** | ูุตูู ุงูุชูุงุฑูุฑ ูุงูููุงุฐุฌ (Report & Form Designer) โ | ุงุญุชุฑุงูู - ุชุตููู ุญุฑ ููุชูุงุฑูุฑ ูุงูููุงุฐุฌ |
| **M** | ุงูุฑุจุท ูุน Power BI Desktop (BI Connector) โ | ุชุญูููู - ุชุญูููุงุช ูุชูุฏูุฉ ุจุฏูู ุชุฑุงุฎูุต |
| **N** | ุงููุณุงุนุฏ ุงูุฐูู ุงููุชูุงูู (AI Copilot) โ | ุงุณุชุฑุงุชูุฌู - ุงูุนูู ุงููุฏุจุฑ ููุจุฑูุงูุฌ |
| **O** | ุงููุนู ุงูุฒููู ุงููุงุฆู (Hyper Time Intelligence) โ | ุฃุณุงุณู - ุงูุจูุนุฏ ุงูุฒููู ููุฐูุงุก |
| **P** | ูุฏูุฑ ุงููููุงุช ุงูุฐูู (Smart File Manager) โ | ุงุณุชุฑุงุชูุฌู - ุฅุฏุงุฑุฉ ุงููููุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู |
| **Q** | ุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ ูุงูุทุงุจุนุงุช (Device & Printer Manager) โ | ุฃุณุงุณู - ุงููุณุญ ุงูุถูุฆู ูุงูุทุจุงุนุฉ |
| **R** | ุชูุงูู ุชุทุจููุงุช ุณุทุญ ุงูููุชุจ (Desktop Apps Integration) โ | ููุชูู - WhatsApp/Telegram/Teams/Automation |
| **S** | ูุธุงู ุชุตููู ุงูููุฑูุฒ ุงููุชูุฏู (Form Designer Enhancement) ๐ด | ุงุณุชุฑุงุชูุฌู - JSON Config + Visual Editor + Live Edit |

> **ููุงุญุธุฉ ูููุฉ:** ุงููุญูุฑ D ูุนุชูุฏ ุนูู ุชุญููู ููู `claude/ALL_Libraries.txt` ูุงุณุชุบูุงู ุงูููุชุจุงุช ุงููุซุจุชุฉ ูุนููุงู
>
> **๐ ูุญูุฑ S:** ุงูุฎุทุฉ ุงูุชูุตูููุฉ ูู `claude/FORM_DESIGNER_MASTER_PLAN.md`

### ๐ฏ ุงูุฑุคูุฉ ุงูุฌุฏูุฏุฉ: AI-First Workflow Automation

```
๐ง ุงูุฅูููู โโโ ๐ ุงูุฅุดุนุงุฑุงุช โโโ โ ุงูููุงู โโโ ๐ ุงูุชูููู
                    โ                                   โ
                    โโโโโโโโโโโ ๐ค AI ูุฏูุฑ ูู ุดูุก โโโโโโโ
```

**ุงูุณููุงุฑูู ุงููููุฐุฌู:**
1. ูุตู ุฅูููู ูู HR ุจุทูุจ ุชุณููุฉ ุฅุฌุงุฒุฉ
2. AI ููุฑุฃ ููููู ุงูุฅูููู ุชููุงุฆูุงู
3. ุฅุดุนุงุฑ ูุธูุฑ ูู ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช (ุฃููููุฉ ุงูุฌุฑุณ)
4. ุงููุณุชุฎุฏู ููุดุฆ ูููุฉ ูู ุงูุฅุดุนุงุฑ
5. ุงููููุฉ ุชุชุณุฌู ูู ุงูุชูููู
6. AI ููุชุญ ูููุฐุฌ ุงูุชุณููุฉ ููููุฃ ุงูุจูุงูุงุช ุชููุงุฆูุงู
7. ุงููุณุชุฎุฏู ูุนุชูุฏ ููุญูุธ
8. ุฎูุงุฑ ุทุจุงุนุฉ ุฃู ุฅุฑุณุงู ุฑุฏ ููุฅูููู ุงูุฃุตูู

---

## ุงููุญูุฑ A: ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุฃุณุงุณูุฉ

> ูุตุฏุฑ: ERP Infrastructure Research + ุฃููุงุท Odoo/ERPNext

### A1. ูุธุงู Logging ุงุญุชุฑุงูู (Loguru) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ
- **ุงูููุชุจุฉ:** `loguru` (ูุซุจุชุฉ โ)
- **ุงููุทููุจ:**
  - ูููุงุช log ููููุฉ ูุน rotation (10MB) ู retention (30 ููู) โ
  - ูุณุชููุงุช: DEBUG/INFO/WARNING/ERROR/CRITICAL โ
  - ููู audit ูููุตู ูุชุชุจุน ุงูุนูููุงุช ุงูุญุณุงุณุฉ (ุฑูุงุชุจุ ุชุนุฏููุงุช ููุธููู) โ
  - JSON structured logging ููุชุญููู โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/logging/app_logger.py` โ
  - `core/logging/audit_logger.py` โ

### A2. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ (Global Exception Handler) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ
- **ุงููุทููุจ:**
  - ุงูุชูุงุท ูู ุงูุฃุฎุทุงุก ุบูุฑ ุงููุนุงูุฌุฉ ูู PyQt5 โ
  - ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู โ
  - ุชุณุฌูู ุงูุชูุงุตูู ุงููุงููุฉ ูู log โ
  - ููุน ุงูุจุฑูุงูุฌ ูู ุงูุฅุบูุงู ุงูููุงุฌุฆ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/error_handling/exception_hook.py` โ

### A3. ุงูุญูุธ ุงูุชููุงุฆู (Auto-Save + Recovery) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-08)
- **ุงููุทููุจ:**
  - QTimer ูู 60 ุซุงููุฉ ูุญูุธ ุงูุจูุงูุงุช ุบูุฑ ุงููุญููุธุฉ โ
  - ูููุงุช recovery ูู ูุฌูุฏ ูุฎุตุต โ
  - ูุญุต ุนูุฏ ุจุฏุก ุงูุชุดุบูู ูุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช โ
  - ุฅุดุนุงุฑ ุงููุณุชุฎุฏู ุจูุฌูุฏ ุจูุงูุงุช ูุงุจูุฉ ููุงุณุชุฑุฌุงุน (RecoveryDialog) โ
  - ุฅุตูุงุญ: ุฃููุงู theme-aware ุจุฏู hardcoded โ
  - ุฅุตูุงุญ: bare excepts โ specific exceptions + logging โ
  - ุฅุตูุงุญ: Qt.UserRole ุจุฏู magic number 256 โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/recovery/auto_save.py` โ
  - `core/recovery/recovery_manager.py` โ
  - `core/recovery/__init__.py` โ

### A4. Audit Trail ุจุงูู Database (PostgreSQL Triggers) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-08)
- **ุงููุทููุจ:**
  - ุฌุฏูู `audit.logged_actions` ูุชุณุฌูู ูู ุชุบููุฑ โ
  - Trigger ุนูู ุงูุฌุฏุงูู ุงูุญุณุงุณุฉ (employees, companies, departments, job_titles, banks, employee_statuses, nationalities) โ
  - ุชุณุฌูู: ููู ุบููุฑ + ุฅูู ุงููู ุงุชุบููุฑ + ุงูููู ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ + ุงูููุช โ
  - ุดุงุดุฉ ุนุฑุถ ุณุฌู ุงูุชุฏููู ูู ุงูุจุฑูุงูุฌ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/database/audit/audit_schema.sql` โ (DDL ูุฅูุดุงุก ุงูู schema ูุงูุฌุฏูู ูุงูู indexes)
  - `core/database/audit/audit_triggers.sql` โ (Trigger function + ุชุทุจูู ุนูู 7 ุฌุฏุงูู)
  - `core/database/audit/audit_manager.py` โ (ุฅุฏุงุฑุฉ ูุงููุฉ: setup, enable/disable, query, stats, purge)
  - `core/database/audit/audit_setup.py` โ (ุชููุฆุฉ ุชููุงุฆูุฉ ุนูุฏ ุจุฏุก ุงูุชุดุบูู)
  - `core/database/audit/__init__.py` โ (exports ูุญุฏูุซุฉ)
  - `modules/mostahaqat/screens/audit_log/audit_log_screen.py` โ (ุดุงุดุฉ ุนุฑุถ ูุงููุฉ ูุน ููุงุชุฑ ูุชูุงุตูู)
  - `modules/mostahaqat/screens/audit_log/__init__.py` โ

### A5. ูุนุงูุฌุฉ ุฎูููุฉ ุขููุฉ (Background Processing) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-03)
- **ุงููุทููุจ:**
  - QThreadPool + Worker pattern ููุญุฏ โ
  - Connection pool ููุงุนุฏุฉ ุงูุจูุงูุงุช (thread-safe) โ (ุชู ุงูุชูููุฐ - D2)
  - Progress signals ููู UI โ
  - ุฅุฏุงุฑุฉ ูุฑูุฒูุฉ ููููุงู ุงูุฎูููุฉ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/threading/__init__.py` โ
  - `core/threading/worker.py` โ
  - `core/threading/task_manager.py` โ
- **ูููุงุช ูุคุฌูุฉ:**
  - `core/database/connection/pool.py` โ (ุชู ุงูุชูููุฐ)

### A6. ุงูุฌุฏููุฉ (APScheduler) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงูููุชุจุฉ:** `apscheduler` (ูุซุจุชุฉ โ)
- **ุงููุทููุจ:**
  - QtScheduler ูุชูุงูู ูุน PyQt5 event loop โ
  - ูุนุงูุฌุฉ ุงูููุงู ุงููุงุฆุชุฉ (misfire handling) โ
  - ูุงุฌูุฉ ูุฅุฏุงุฑุฉ ุงูููุงู ุงููุฌุฏููุฉ โ
  - ุฏุนู interval, cron, date triggers โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/scheduler/__init__.py` โ
  - `core/scheduler/scheduler_manager.py` โ

### A7. ูุฑุงูุจุฉ ุงููููุงุช (File Watching) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงูููุชุจุฉ:** `watchdog` (ูุซุจุชุฉ โ)
- **ุงููุทููุจ:**
  - Hot folder ูุงุณุชูุฑุงุฏ ูููุงุช Excel/CSV ุชููุงุฆูุงู โ
  - Debouncing + stability detection โ
  - 4 ูุฌูุฏุงุช: input โ processing โ archive โ error โ
  - ุชูุงูู ูุน ูุธุงู ุงูุงุณุชูุฑุงุฏ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/file_watcher/__init__.py` โ
  - `core/file_watcher/watcher.py` โ
  - `core/file_watcher/hot_folder.py` โ

### A8. ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููุชูุฏู โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ูุณุฎ ุชููุงุฆู ูุฌุฏูู (ูููู/ุฃุณุจูุนู/ุดูุฑู - GFS) โ
  - pg_dump ุจุตูุบุฉ ูุถุบูุทุฉ (-Fc) โ
  - Checksum ููุชุญูู ูู ุณูุงูุฉ ุงููุณุฎุฉ โ
  - ุชูุธูู ุชููุงุฆู ูููุณุฎ ุงููุฏููุฉ โ
  - ุชูุงูู ูุน APScheduler โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/backup/__init__.py` โ
  - `core/backup/backup_manager.py` โ

### A9. ุงูุฃูุงู (Security) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-08)
- **ุงูููุชุจุงุช:** `argon2-cffi` โ, `keyring` โ, `cryptography` โ
- **ุงููุทููุจ:**
  - Argon2id password hashing (ูุน PBKDF2 fallback) โ
  - OS keyring ูุชุฎุฒูู ุจูุงูุงุช ุงูุงุชุตุงู (ูุน encrypted file fallback) โ
  - RBAC (Role-Based Access Control) - 5 ุฃุฏูุงุฑ ู 24 ุตูุงุญูุฉ โ
  - Account lockout ุจุนุฏ 5 ูุญุงููุงุช ูุงุดูุฉ (15 ุฏูููุฉ) โ
  - Session management ูุน timeout (8 ุณุงุนุงุช) โ
  - Fernet encryption ููุจูุงูุงุช ุงูุญุณุงุณุฉ โ
  - Key rotation support โ
  - ุฅุตูุงุญ: thread-safe singleton ูู RBAC โ
  - ุฅุตูุงุญ: bare excepts โ specific exceptions + logging ูู encryption.py โ
  - ุฅุตูุงุญ: ุงุณุชุฎุฏุงู app_logger ุจุฏู logging.getLogger โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/security/auth_manager.py` โ (Argon2 + lockout + sessions)
  - `core/security/credential_store.py` โ (keyring + encrypted file)
  - `core/security/encryption.py` โ (Fernet + IBAN + file encryption)
  - `core/security/rbac.py` โ (RBAC + decorators)
  - `core/security/__init__.py` โ

### A10. ุงูุชุญูู ูุชุนุฏุฏ ุงููุณุชููุงุช (Validation) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-08)
- **ุงูููุชุจุฉ:** `pydantic` (ูุซุจุชุฉ โ)
- **ุงููุทููุจ:**
  - Pydantic schemas ูู Employee (Create, Update, Response, ListItem) โ
  - Pydantic schemas ูู Payroll (Create, Update, Response, Summary) โ
  - PostgreSQL constraints ูุฎุท ุฏูุงุน ุฃุฎูุฑ โ
  - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจู โ
  - Custom validators (phone, IBAN, salary, dates) โ
  - Auto-calculation (gross, deductions, net salary) โ
  - PayrollStatus enum (ูุณูุฏุฉ/ููุฏ ุงููุฑุงุฌุนุฉ/ูุนุชูุฏ/ูุฏููุน/ููุบู) โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/validation/schemas/employee.py` โ
  - `core/validation/schemas/payroll.py` โ
  - `core/validation/schemas/__init__.py` โ
  - `core/validation/__init__.py` โ

---

## ุงููุญูุฑ B: ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุฏูุฌ (Ollama AI)

### ุงูููููู
ุฏูุฌ Ollama AI ูุญููุงู ุฏุงุฎู INTEGRA ูุชุญููู ุงูุจูุงูุงุชุ ูุฑุงุกุฉ ุงูุฅููููุงุชุ ุชูููุฏ ุงูุชูุงุฑูุฑุ ูุงูุชูุจููุงุช ุงูุฐููุฉ - ุจุฏูู ุฅูุชุฑูุช ูุจุฎุตูุตูุฉ ูุงููุฉ.

### ุงูุชูููุงุช
| ุงููููู | ุงูุชูููุฉ |
|---|---|
| AI Engine | Ollama (ูุซุจุช ูุญููุงู) |
| Python Library | `ollama` (pip install ollama) |
| ุงูุงุชุตุงู | localhost:11434 (REST API) |
| ุงูุชูุงูู ูุน UI | QThread workers + streaming |

### B1. ุทุจูุฉ ุงูุงุชุตุงู (AI Service Layer) โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - Client class ููุงุชุตุงู ุจู Ollama โ
  - ูุญุต ุญุงูุฉ ุงูุฎุฏูุฉ (ูุชููุฑุฉ/ุบูุฑ ูุชููุฑุฉ) โ
  - ุฅุฏุงุฑุฉ ุงูููุฏูุงุช ุงููุชุงุญุฉ โ
  - Streaming support ูุน QThread โ
  - System prompts ูุฎุตุตุฉ ููู ูุธููุฉ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/ai/ollama_client.py` โ (381 ุณุทุฑ - Ollama Client ูุงูู ูุน fallback)
  - `core/ai/ai_service.py` โ (368 ุณุทุฑ - AI Service Layer)
  - `core/ai/prompts/` โ (ูุฌูุฏ system prompts)

### B2. ูุณุงุนุฏ ุงูุฅูููู ุงูุฐูู โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ูุฑุงุกุฉ ูุชูุฎูุต ุงูุฅููููุงุช โ
  - ุงุณุชุฎุฑุงุฌ ุงูููุงู (Tasks) ูู ุงูุฅููููุงุช โ
  - ุชุตููู ุงูุฅููููุงุช (ุนุงุฌู/ููู/ุนุงุฏู) โ
  - ุงูุชุฑุงุญ ุฑุฏูุฏ โ
  - ูุดู ุฅููููุงุช ุชุญุชุงุฌ ุฅุฌุฑุงุก ููุฑู โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/ai/agents/email_agent.py` โ (466 ุณุทุฑ - 17 ุฏุงูุฉุ 4 ููุงุณุงุช)

### B3. ูุณุงุนุฏ ุงูุจูุงูุงุช โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ุชุญููู ุจูุงูุงุช ุงูููุธููู ูุงูุฑูุงุชุจ โ
  - ูุดู ุงูุฃุฎุทุงุก ูุงูุดุฐูุฐ ูู ุงูุจูุงูุงุช โ
  - ุงูุชุฑุงุญ ุชุตุญูุญุงุช โ
  - ุชูููุฏ ููุฎุตุงุช ูุชูุงุฑูุฑ ูุตูุฉ โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/ai/agents/data_agent.py` โ (578 ุณุทุฑ - 18 ุฏุงูุฉุ 5 ููุงุณุงุช)

### B4. ูุธุงู ุงูุชูุจููุงุช ุงูุฐููุฉ โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ุชุญููู ุฏูุฑู ููุจูุงูุงุช ูุงูุชุดุงู ุฃููุงุท ุชุญุชุงุฌ ุงูุชุจุงู โ
  - ุชูุจููุงุช: ุนููุฏ ูุงุฑุจุช ุนูู ุงูุงูุชูุงุกุ ุฑูุงุชุจ ุบูุฑ ุทุจูุนูุฉุ ููุงู ูุชุฃุฎุฑุฉ โ
  - ุฃููููุงุช: ุนุงุฌู (ุฃุญูุฑ) / ููู (ุจุฑุชูุงูู) / ุนุงุฏู (ุฃุฒุฑู) โ
  - ูุญุต ุงูุจูุงูุงุช ุงููุงูุตุฉ โ
  - ุชูุงูู ูุน Ollama AI โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/ai/agents/alert_agent.py` โ

### B5. ูุงุฌูุฉ ุงูู AI ูู ุงูุจุฑูุงูุฌ โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ุดุฑูุท ุฌุงูุจู ุฃู ูุงูุฐุฉ chat ูุน ุงูู AI โ
  - ุนุฑุถ ุงููุชุงุฆุฌ ูุน streaming (ุญุฑู ุจุญุฑู) โ
  - ุฃุฒุฑุงุฑ ุณุฑูุนุฉ: "ูุฎูุต ุงูุฅููููุงุช" / "ุฑุงุฌุน ุงูุฑูุงุชุจ" / "ุฅูู ุงูููุงูุ" โ
  - ุณุฌู ุงููุญุงุฏุซุงุช โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `ui/components/ai/chat_panel.py` โ (524 ุณุทุฑ - 23 ุฏุงูุฉุ 5 ููุงุณุงุช)
  - `ui/components/ai/ai_toolbar.py` โ (289 ุณุทุฑ - 14 ุฏุงูุฉุ 3 ููุงุณุงุช)

### ุงูููุฏูุงุช ุงูููุชุฑุญุฉ ูู Ollama
| ุงูุงุณุชุฎุฏุงู | ุงูููุฏู | ุงูุญุฌู |
|---|---|---|
| ุชุญููู ุนุงู + ุนุฑุจู | `gemma3` ุฃู `llama3.2` | 4-8GB |
| ุชูุฎูุต + ุงุณุชุฎุฑุงุฌ ููุงู | `mistral` | 4GB |
| ููุฏ + ุชุญููู ุจูุงูุงุช | `codellama` | 4GB |

> **ููุงุญุธุฉ:** ูุญุชุงุฌ ูุนุฑู ุฅููุงููุงุช ุงูุฃุฌูุฒุฉ (RAM + GPU) ุนุดุงู ูุฎุชุงุฑ ุงูููุฏู ุงูููุงุณุจ.

---

## ุงููุญูุฑ C: ููุฏููู ุงูุฅูููู (Outlook Classic Sync)

### ุงูููููู
ุชุฒุงูู ูุงูู ูุน Outlook Classic ุนุจุฑ COM automation (pywin32) - ูู ุงูุฅููููุงุช ุชุธูุฑ ุฏุงุฎู INTEGRA ูุน ุฅููุงููุฉ ุงูุจุญุซุ ุงูุชุตูููุ ูุงูุชุญููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู.

### ุงูุชูููุงุช
| ุงููููู | ุงูุชูููุฉ |
|---|---|
| COM Automation | `pywin32` (win32com.client) |
| Outlook Object Model | MAPI Namespace |
| ุงูุชุฒุงูู | QThread + QTimer (polling) |
| ุงูุชุฎุฒูู ุงููุญูู | PostgreSQL (email cache) |

### C1. ุทุจูุฉ ุงูุงุชุตุงู ุจู Outlook โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ุงูุงุชุตุงู ุจู Outlook Classic ุนุจุฑ COM โ
  - ุงููุตูู ููู ุงููุฌูุฏุงุช (Inbox, Sent, Drafts, Custom folders) โ
  - ูุฑุงุกุฉ ุงูุฅููููุงุช: ุงูููุถูุนุ ุงููุฑุณูุ ุงูุชุงุฑูุฎุ ุงููุตุ ุงููุฑููุงุช โ
  - ุฅุฑุณุงู ุฅููููุงุช ูู ุฏุงุฎู INTEGRA โ
  - ููู/ูุณุฎ ุฅููููุงุช ุจูู ุงููุฌูุฏุงุช โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/email/outlook_connector.py` โ (696 ุณุทุฑ - 31 ุฏุงูุฉ - COM automation ูุงูู)

### C2. ุงูุชุฒุงูู ูุงูุชุฎุฒูู ุงููุญูู โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ูููุฐุฌ ุจูุงูุงุช ุงูุฅูููู โ
  - Email cache ูุญูู โ
  - ูุฒุงููุฉ ูุน Outlook โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/email/email_cache.py` โ (527 ุณุทุฑ - 21 ุฏุงูุฉ)
  - `core/email/email_models.py` โ (243 ุณุทุฑ - 6 ููุงุณุงุช)

### C3. ูุงุฌูุฉ ููุฏููู ุงูุฅูููู โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ูุงูุฐุฉ ุงูุฅูููู ุงูุฑุฆูุณูุฉ โ
  - ุนุฑุถ ูุงุฆูุฉ ุงูุฅููููุงุช โ
  - ูุนุงููุฉ ุงูุฅูููู โ
  - ุชูุงูู ูุน AI โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `modules/email/email_window.py` โ (93 ุณุทุฑ - ูุงูุฐุฉ ุฑุฆูุณูุฉ ุชุณุชุฎุฏู EmailPanel)
  - `ui/components/email/email_panel.py` โ (591 ุณุทุฑ - 28 ุฏุงูุฉ - ูุงุฌูุฉ ูุงููุฉ)
  - `ui/components/email/email_list.py` โ (ูุงุฆูุฉ ุงูุฅููููุงุช)
  - `ui/components/email/email_viewer.py` โ (ุนุฑุถ ุงูุฅูููู)

### C4. ุชูุงูู AI + Email โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
- **ุงููุทููุจ:**
  - ุงูู AI ููุฑุง ุงูุฅููููุงุช ุงูุฌุฏูุฏุฉ ููุณุชุฎุฑุฌ ููุงู โ
  - ุชุตููู ุงูุฅููููุงุช โ
  - ุชูุจููุงุช โ
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/ai/agents/email_agent.py` โ (466 ุณุทุฑ - ูุดุชุฑู ูุน B2)

---

## ุฎุทุฉ ุงูุชูููุฐ ุงููุฑุญููุฉ

### ุงููุฑุญูุฉ 1: ุงูุฃุณุงุณูุงุช (ุฃุณุจูุนูู)
```
A1 โ Logging (Loguru)
A2 โ Exception Handler
A5 โ Background Processing (Worker pattern)
```
> ูุฐู ูู ุงูุฃุณุงุณูุงุช ุงููู ูู ุดูุก ููุจูู ุนูููุง

### ุงููุฑุญูุฉ 2: ุงูุจูุงูุงุช ูุงูุฃูุงู (ุฃุณุจูุนูู)
```
A4 โ Audit Trail (PostgreSQL triggers)
A10 โ Pydantic Validation
A9 โ Security (RBAC + Argon2)
```

### ุงููุฑุญูุฉ 3: ุงูุฃุชูุชุฉ (ุฃุณุจูุน)
```
A3 โ Auto-Save + Recovery
A6 โ APScheduler
A8 โ Backup ุงููุชูุฏู
```

### ุงููุฑุญูุฉ 4: ุงูุฐูุงุก ุงูุงุตุทูุงุนู (ุฃุณุจูุนูู)
```
B1 โ Ollama Service Layer
B5 โ AI Chat Panel ูู ุงูู UI
B3 โ Data Agent (ุชุญููู ุจูุงูุงุช)
```

### ุงููุฑุญูุฉ 5: ููุฏููู ุงูุฅูููู (ุฃุณุจูุนูู)
```
C1 โ Outlook Connector
C2 โ Email Sync + Cache
C3 โ Email UI
```

### ุงููุฑุญูุฉ 6: ุงูุชูุงูู ุงูุฐูู (ุฃุณุจูุน)
```
B2 + C4 โ AI Email Agent
B4 โ Smart Alerts
A7 โ File Watching
```

---

## ุงููุชุทูุจุงุช ููุชูููุฐ

### โ ุงูููุชุจุงุช - ูููุง ูุซุจุชุฉ!
> **ุชู ุงูุชุญูู ุจุชุงุฑูุฎ 3 ูุจุฑุงูุฑ 2026** ูู ููู `claude/ALL_Libraries.txt`

```
โ ollama 0.6.1         - AI
โ APScheduler 3.11.2   - Scheduling
โ watchdog 6.0.0       - File Watching
โ argon2-cffi 25.1.0   - Password Hashing
โ keyring 25.7.0       - Credential Storage
โ pywin32 311          - Outlook Integration
โ pydantic 2.12.5      - Validation
โ SQLAlchemy 2.0.46    - Database Pool
โ rich 14.2.0          - Console
โ humanize 4.15.0      - Formatting
โ plotly 6.5.2         - Charts
โ cryptography 46.0.3  - Encryption
โ PyQt-Fluent-Widgets 1.11.0 - Modern UI
```

**ูุง ููุฌุฏ ููุชุจุงุช ุชุญุชุงุฌ ุชุซุจูุช! ๐**

### ูุนูููุงุช ูุทููุจุฉ ูู ูุญูุฏ:
1. **ุฅููุงููุงุช ุงูุฃุฌูุฒุฉ:** RAM + GPU (ูุงุฎุชูุงุฑ ููุฏู Ollama ุงูููุงุณุจ)
2. **ุญุณุงุจ Outlook:** ูู Outlook Classic ูุซุจุช ููุชุตู ุนูู ุงูุฌูุงุฒููุ
3. **ุงูููุฏูุงุช ุงููุญููุฉ ุนูู Ollama:** `ollama list` ููุนุฑูุฉ ุงููุชุงุญ
4. **ุฃููููุงุช ุงูุนูู:** ูู ูุจุฏุฃ ุจุงููุญูุฑ A ุฃู B ุฃู C ุฃู Dุ

---

## ูููู ุงููุฌูุฏุงุช ุงูุฌุฏูุฏ
```
core/
โโโ logging/           โ A1
โโโ error_handling/    โ A2
โโโ recovery/          โ A3
โโโ database/
โ   โโโ audit/         โ A4
โ   โโโ connection/    (ููุฌูุฏ)
โ   โโโ queries/       (ููุฌูุฏ)
โโโ threading/         โ A5
โโโ scheduler/         โ A6
โโโ file_watcher/      โ A7
โโโ backup/            โ A8
โโโ security/          โ A9
โโโ validation/        โ A10
โโโ ai/                โ B1-B4
โ   โโโ ollama_client.py
โ   โโโ ai_service.py
โ   โโโ prompts/
โ   โโโ agents/
โโโ email/             โ C1-C2
    โโโ outlook_connector.py
    โโโ sync/
    โโโ models/

modules/
โโโ email/             โ C3-C4
โ   โโโ window/
โ   โโโ screens/
โ   โโโ toolbar/
โ   โโโ ai/
โโโ mostahaqat/        (ููุฌูุฏ)

ui/
โโโ components/
    โโโ ai/            โ B5
```

---

## ุงููุญูุฑ D: ุชุญุณููุงุช ุจูุงุกู ุนูู ุงูููุชุจุงุช ุงููุชุงุญุฉ (Enhancement Track)

> **ูุตุฏุฑ:** ุชุญููู ููู `claude/ALL_Libraries.txt` - ุงูููุชุจุงุช ุงููุซุจุชุฉ ูุนููุงู
> **ุงูุชุงุฑูุฎ:** 3 ูุจุฑุงูุฑ 2026
> **ุงููุฏู:** ุงุณุชุบูุงู ุงูููุชุจุงุช ุงูููุฌูุฏุฉ ูุชุญุณูู ุงูุฃุฏุงุก ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

### ๐ฆ ุงูููุชุจุงุช ุงููุชุงุญุฉ ุบูุฑ ุงููุณุชุบูุฉ

| ุงูููุชุจุฉ | ุงูุฅุตุฏุงุฑ | ุงููุฆุฉ | ุงูุงุณุชุฎุฏุงู ุงูููุชุฑุญ |
|---------|---------|-------|------------------|
| `rich` | 14.2.0 | Console/Logging | ุชุญุณูู ุงูู console output ูุงูู debugging |
| `pydantic` | 2.12.5 | Validation | ุงูุชุญูู ูู ุงูุจูุงูุงุช (ูุฎุทุท ูู A10) |
| `SQLAlchemy` | 2.0.46 | Database | Connection Pool + ORM |
| `PyQt-Fluent-Widgets` | 1.11.0 | UI | ููููุงุช Windows 11 style |
| `pyqt-toast-notification` | 1.3.3 | UI | ุฅุดุนุงุฑุงุช Toast ุญุฏูุซุฉ |
| `superqt` | 0.7.7 | UI | Widgets ูุชูุฏูุฉ (Collapsible, RangeSlider) |
| `plotly` | 6.5.2 | Charts | ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ |
| `matplotlib` | 3.10.8 | Charts | ุฑุณูู ุจูุงููุฉ ุซุงุจุชุฉ |
| `humanize` | 4.15.0 | Formatting | ุชูุณูู ุฃุฑูุงู ูุชูุงุฑูุฎ |
| `cryptography` | 46.0.3 | Security | ุชุดููุฑ ุงูุจูุงูุงุช |
| `Faker` | 40.1.0 | Testing | ุจูุงูุงุช ููููุฉ ููุงุฎุชุจุงุฑ |
| `nltk` | 3.9.2 | NLP | ูุนุงูุฌุฉ ูุตูุต ุนุฑุจูุฉ |
| `tqdm` | 4.67.1 | Progress | Progress bars ูุชูุฏูุฉ |
| `QDarkStyle` | 3.2.3 | Themes | Dark theme ุฌุงูุฒ |
| `qt-material` | 2.17 | Themes | Material Design theme |
| `qrcode` | 8.2 | Utility | ุชูููุฏ QR codes |

---

### D1. ุชุญุณูู ูุธุงู Logging (Enhancement ูู A1) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงูุญุงูุฉ ุงูุญุงููุฉ:** `loguru` + `rich` console output
**ุงูุชุญุณูู:** ุฅุถุงูุฉ `rich` ููู console output

**ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ:**
- โจ Console output ูููู ูููุณู ุจุดูู ุงุญุชุฑุงูู
- โจ Tables ููุฃุฎุทุงุก ูุงูุฅุญุตุงุฆูุงุช
- โจ Syntax highlighting ููู tracebacks
- โจ Progress bars ูู ุงูู console ุฃุซูุงุก ุงูุนูููุงุช ุงูุทูููุฉ
- โจ Panel boxes ููุฑุณุงุฆู ุงููููุฉ

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/logging/rich_console.py` โ
- ุชุญุฏูุซ `core/logging/__init__.py` โ

**ูุซุงู:**
```python
from rich.console import Console
from rich.table import Table
from rich.progress import Progress

console = Console()

# ุนุฑุถ ุฌุฏูู
table = Table(title="ุฅุญุตุงุฆูุงุช ุงูููุธููู")
table.add_column("ุงููุณู", style="cyan")
table.add_column("ุงูุนุฏุฏ", style="green")
console.print(table)

# Progress bar
with Progress() as progress:
    task = progress.add_task("ุฌุงุฑู ุงููุนุงูุฌุฉ...", total=100)
    # ...
```

---

### D2. Connection Pool ููุงุนุฏุฉ ุงูุจูุงูุงุช (ุชุญุณูู ุฌููุฑู) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงูุญุงูุฉ ุงูุญุงููุฉ:** SQLAlchemy Connection Pool
**ุงูุชุญุณูู:** ุชู ุชุทุจูู SQLAlchemy Connection Pool

**ุงููุดุงูู ุงูุญุงููุฉ:**
- โ ุงุชุตุงู ูุงุญุฏ ููู ุงูุชุทุจูู
- โ ูุง ูุฏุนู multi-threading ุจุดูู ุขูู
- โ ูุง ููุฌุฏ auto-reconnect

**ุงูุญู:**
```python
from sqlalchemy import create_engine
from sqlalchemy.pool import QueuePool

engine = create_engine(
    "postgresql://user:pass@localhost/integra",
    poolclass=QueuePool,
    pool_size=5,           # ุงุชุตุงูุงุช ุฏุงุฆูุฉ
    max_overflow=10,       # ุงุชุตุงูุงุช ุฅุถุงููุฉ ุนูุฏ ุงูุญุงุฌุฉ
    pool_timeout=30,       # timeout ููุงูุชุธุงุฑ
    pool_recycle=1800,     # ุฅุนุงุฏุฉ ุชุฏููุฑ ูู 30 ุฏูููุฉ
    pool_pre_ping=True     # ูุญุต ุงูุงุชุตุงู ูุจู ุงูุงุณุชุฎุฏุงู
)
```

**ุงููููุฒุงุช:**
- โจ Thread-safe connections
- โจ Auto-reconnect ุนูุฏ ุงููุทุงุน ุงูุงุชุตุงู
- โจ ุฃุฏุงุก ุฃูุถู ูุน ุงูููุงู ุงููุชูุงุฒูุฉ
- โจ Health checks ุชููุงุฆูุฉ

**ุงููููุงุช:**
- `core/database/connection/pool.py` (ุฌุฏูุฏ)
- ุชุญุฏูุซ `core/database/connection/__init__.py`

---

### D3. Toast Notifications (ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงูุญุงูุฉ ุงูุญุงููุฉ:** `pyqt-toast-notification` ูุน fallback
**ุงูุชุญุณูู:** ุชู ุชุทุจูู Toast Notifications

**ุงููุดุงูู ุงูุญุงููุฉ:**
- โ MessageBox ูููู ุงูุนูู (modal)
- โ ูุธูุฑ ูุฏูู
- โ ูุง ูุฎุชูู ุชููุงุฆูุงู

**ุงูุญู:**
```python
from pyqt_toast import Toast, ToastPreset

# ุฅุดุนุงุฑ ูุฌุงุญ
Toast.show(
    parent=self,
    title="ุชู ุงูุญูุธ",
    text="ุชู ุญูุธ ุจูุงูุงุช ุงูููุธู ุจูุฌุงุญ",
    preset=ToastPreset.SUCCESS,
    duration=3000  # 3 ุซูุงูู
)

# ุฅุดุนุงุฑ ุฎุทุฃ
Toast.show(
    parent=self,
    title="ุฎุทุฃ",
    text="ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช",
    preset=ToastPreset.ERROR
)
```

**ุงููููุฒุงุช:**
- โจ ูุง ูููู ุงูุนูู (non-blocking)
- โจ ูุฎุชูู ุชููุงุฆูุงู
- โจ ูุธูุฑ ุญุฏูุซ ูุฃููู
- โจ ุฃููุงุน ูุชุนุฏุฏุฉ (Success, Error, Warning, Info)

**ุงููููุงุช:**
- `ui/components/notifications/toast_manager.py` (ุฌุฏูุฏ)
- ุชุญุฏูุซ `ui/dialogs/__init__.py`

---

### D4. ุชูุณูู ุงูุจูุงูุงุช (Humanize) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงูุญุงูุฉ ุงูุญุงููุฉ:** `humanize` ูุน ุฏุนู ุนุฑุจู ูุงูู
**ุงูุชุญุณูู:** `humanize` ููุชูุณูู

**ุฃูุซูุฉ:**
```python
import humanize
from datetime import datetime, timedelta

# ุงูุฃุฑูุงู
humanize.intcomma(5000)           # "5,000"
humanize.intword(1000000)         # "1 million"

# ุงูุชูุงุฑูุฎ (ุจุงูุนุฑุจู)
humanize.activate("ar")
humanize.naturaltime(datetime.now() - timedelta(minutes=5))  # "ููุฐ 5 ุฏูุงุฆู"
humanize.naturalday(datetime.now())                           # "ุงูููู"

# ุฃุญุฌุงู ุงููููุงุช
humanize.naturalsize(1024000)     # "1.0 MB"
```

**ุงูุงุณุชุฎุฏุงู ูู INTEGRA:**
- โจ "ุขุฎุฑ ุชุญุฏูุซ: ููุฐ 5 ุฏูุงุฆู" ุจุฏู timestamp
- โจ "ุงูุฑุงุชุจ: 5,000 ุฑ.ุณ" ุจุฏู 5000
- โจ "ุญุฌู ุงููุณุฎุฉ: 2.5 MB" ุจุฏู bytes

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/utils/formatters.py` โ
- `core/utils/__init__.py` (ุชุตุฏูุฑ) โ

---

### D5. ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ (Charts) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `plotly` 6.5.2 + `matplotlib` 3.10.8
**ุงูุงุณุชุฎุฏุงู:** Dashboard ูุฅุญุตุงุฆูุงุช

**Plotly (ุชูุงุนูู - ููู Dashboard):**
```python
import plotly.express as px
from PyQt5.QtWebEngineWidgets import QWebEngineView

# ุฑุณู ุจูุงูู ุฏุงุฆุฑู
fig = px.pie(
    values=[30, 25, 20, 25],
    names=["ุงูุฅุฏุงุฑุฉ", "ุงููุจูุนุงุช", "ุงูุฅูุชุงุฌ", "ุงูุฏุนู"],
    title="ุชูุฒูุน ุงูููุธููู ุญุณุจ ุงููุณู"
)

# ุนุฑุถ ูู PyQt5
web_view = QWebEngineView()
web_view.setHtml(fig.to_html())
```

**ุงูุงุณุชุฎุฏุงู ูู INTEGRA:**
- โจ Dashboard ุฅุญุตุงุฆูุงุช ุงูููุธููู
- โจ ุชุญููู ุงูุฑูุงุชุจ ูุงููุณุชุญูุงุช
- โจ ุชูุงุฑูุฑ ุจุตุฑูุฉ ุชูุงุนููุฉ

**ุงููููุงุช ุงููููุฐุฉ:**
- `ui/components/charts/plotly_widget.py` โ

---

### D6. ููููุงุช UI ูุชูุฏูุฉ (Fluent + SuperQt) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:**
- `PyQt-Fluent-Widgets` 1.11.0 - Windows 11 style โ
- `superqt` 0.7.7 - Widgets ูุชูุฏูุฉ โ

**ููููุงุช Fluent:**
```python
from qfluentwidgets import (
    PushButton, PrimaryPushButton,
    LineEdit, SearchLineEdit,
    ComboBox, CheckBox,
    ProgressBar, InfoBar,
    FluentIcon, NavigationInterface
)

# ุฒุฑ ุฃุณุงุณู
btn = PrimaryPushButton("ุญูุธ", self)
btn.setIcon(FluentIcon.SAVE)

# ุดุฑูุท ุจุญุซ
search = SearchLineEdit(self)
search.setPlaceholderText("ุงุจุญุซ ุนู ููุธู...")

# ุฅุดุนุงุฑ
InfoBar.success(
    title="ุชู",
    content="ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ",
    parent=self
)
```

**ููููุงุช SuperQt:**
```python
from superqt import QCollapsible, QRangeSlider

# ูุณู ูุงุจู ููุทู
collapsible = QCollapsible("ุฎูุงุฑุงุช ูุชูุฏูุฉ")
collapsible.addWidget(my_options_widget)

# Slider ุจูููุชูู (min-max)
range_slider = QRangeSlider()
range_slider.setRange(0, 10000)
range_slider.setValue((2000, 8000))  # ูุทุงู ุงูุฑุงุชุจ
```

**ุงููููุงุช:**
- `ui/components/fluent/` (ูุฌูุฏ ุฌุฏูุฏ)
- ุชุญุฏูุซ ุงูููููุงุช ุงูุญุงููุฉ ุชุฏุฑูุฌูุงู

---

### D7. ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ โ **ููุชูู**

**ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-04)
**ุงููุชุงุญ:** `cryptography` 46.0.3 + `keyring` 25.7.0

**ุงูููุฒุงุช ุงููููุฐุฉ:**
- โ ุชุดููุฑ/ูู ุชุดููุฑ ุงููุตูุต (Fernet AES-128-CBC)
- โ ุชุดููุฑ/ูู ุชุดููุฑ ุงููููุงุช
- โ ุชุฌุฒุฆุฉ ูููุงุช ุงููุฑูุฑ (PBKDF2)
- โ ุชุฎุฒูู ุงูููุงุชูุญ ูู OS keyring
- โ ุฏูุงู ูุณุงุนุฏุฉ: encrypt_iban, mask_iban

**ุงูุงุณุชุฎุฏุงู ูู INTEGRA:**
```python
from core.security import encrypt, decrypt, hash_password, verify_password

# ุชุดููุฑ ุจูุงูุงุช
encrypted = encrypt("ูุต ุณุฑู")
original = decrypt(encrypted)

# ูููุงุช ุงููุฑูุฑ
hashed = hash_password("password123")
if verify_password("password123", hashed):
    print("Correct!")
```

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/security/encryption.py` โ

---

### D8. ุจูุงูุงุช ุงุฎุชุจุงุฑ (Faker) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `Faker` 40.1.0
**ุงูุงุณุชุฎุฏุงู:** ุชูููุฏ ุจูุงูุงุช ููููุฉ ููุชุทููุฑ ูุงูุงุฎุชุจุงุฑ

```python
from faker import Faker

fake = Faker('ar_SA')  # ุจูุงูุงุช ุนุฑุจูุฉ ุณุนูุฏูุฉ

# ููุธู ูููู
employee = {
    "name_ar": fake.name(),
    "email": fake.email(),
    "phone": fake.phone_number(),
    "address": fake.address(),
    "hire_date": fake.date_between(start_date='-5y'),
    "salary": fake.random_int(min=3000, max=15000),
    "iban": fake.iban()
}
```

**ุงูุงุณุชุฎุฏุงู ูู INTEGRA:**
- โจ ุชูููุฏ ุจูุงูุงุช ููู demo
- โจ ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ูุน ุจูุงูุงุช ูุซูุฑุฉ
- โจ ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ

**ุงููููุงุช ุงููููุฐุฉ:**
- `tools/data_generator.py` โ (CLI tool with CSV/JSON export)

---

### D9. QR Codes โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `qrcode` 8.2
**ุงูุงุณุชุฎุฏุงู:** ุจุทุงูุงุช ุงูููุธููู ูุงูุชูุงุฑูุฑ

```python
import qrcode
from io import BytesIO

# ุชูููุฏ QR code
qr = qrcode.QRCode(version=1, box_size=10, border=5)
qr.add_data(f"EMP:{employee_id}")
qr.make(fit=True)

img = qr.make_image(fill_color="black", back_color="white")

# ุชุญููู ูู QPixmap
buffer = BytesIO()
img.save(buffer, format='PNG')
pixmap = QPixmap()
pixmap.loadFromData(buffer.getvalue())
```

**ุงูุงุณุชุฎุฏุงู ูู INTEGRA:**
- โจ ุจุทุงูุฉ ูููุฉ ุงูููุธู ุจู QR
- โจ ุฑูุงุจุท ุณุฑูุนุฉ ูู ุงูุชูุงุฑูุฑ
- โจ ุชุณุฌูู ุญุถูุฑ ุจุงูู QR

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/utils/qr_generator.py` โ
- `core/utils/__init__.py` (ุชุตุฏูุฑ) โ

---

### D10. ุฃููููุงุช ุงุญุชุฑุงููุฉ (QtAwesome) โ ููุชูู (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `QtAwesome` (ุชุญุชุงุฌ ุชุซุจูุช: `pip install qtawesome`)
**ุงูุงุณุชุฎุฏุงู:** ุฃููููุงุช ูุชุฌููุฉ ุงุญุชุฑุงููุฉ ูู ูู ุงููุงุฌูุฉ

**ุงููููุฒุงุช:**
- โจ 6000+ ุฃููููุฉ ูู Font Awesome, Material Design, etc.
- โจ ูุชุฌููุฉ (SVG) - ูุง ุชุชุดูู ุนูุฏ ุงูุชูุจูุฑ
- โจ ูุงุจูุฉ ููุชุฎุตูุต (ุงููููุ ุงูุญุฌูุ ุงูุชุฃุซูุฑุงุช)
- โจ ูุชูุงููุฉ ูุน PyQt5

**ูุซุงู:**
```python
import qtawesome as qta

# ุฃููููุฉ ุจุณูุทุฉ
icon = qta.icon('fa5s.save')
button.setIcon(icon)

# ุฃููููุฉ ููููุฉ
icon = qta.icon('fa5s.user', color='#3498db')

# ุฃููููุฉ ูุน ุชุฃุซูุฑ
icon = qta.icon('fa5s.spinner', animation=qta.Spin(button))
```

**ุงููููุงุช:**
- `core/utils/icons.py` (ุฌุฏูุฏ)
- ุชุญุฏูุซ ูู ุงูู UI components

---

### D11. ุงุณุชูุฑุงุฏ Excel (Pandas + OpenPyXL) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `pandas` 2.2.3 + `openpyxl` 3.1.5 (ูุซุจุชุฉ โ)
**ุงูุงุณุชุฎุฏุงู:** ุฑูุน ุจูุงูุงุช ุงูููุธููู ุจุงูุฌููุฉ ูู ูููุงุช Excel

**ุงููููุฒุงุช:**
- โจ ุงุณุชูุฑุงุฏ ูููุงุช Excel (.xlsx, .xls)
- โจ ุงุณุชูุฑุงุฏ ูููุงุช CSV
- โจ ูุนุงููุฉ ุงูุจูุงูุงุช ูุจู ุงูุงุณุชูุฑุงุฏ
- โจ ุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- โจ ุฏูุฌ ูุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ

**ูุซุงู:**
```python
import pandas as pd

# ูุฑุงุกุฉ Excel
df = pd.read_excel("employees.xlsx", sheet_name="Sheet1")

# ุชุญูู ูู ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ
required = ["ุงูุงุณู", "ุงูุฑุงุชุจ", "ุงููุณู"]
missing = [col for col in required if col not in df.columns]

# ุชุญููู ููุงููุณ
employees = df.to_dict('records')
```

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/import_export/excel_importer.py` โ
- `core/import_export/__init__.py` (ุชุตุฏูุฑ) โ

---

### D12. ุชุตุฏูุฑ Word (python-docx) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `python-docx` (ุชุญุชุงุฌ ุชุซุจูุช: `pip install python-docx`)
**ุงูุงุณุชุฎุฏุงู:** ุชุตุฏูุฑ ุชูุงุฑูุฑ HR ุจุตูุบุฉ Word

**ุงููููุฒุงุช:**
- โจ ุชูุงุฑูุฑ ููุธููู ุจุชูุณูู ุงุญุชุฑุงูู
- โจ ุฌุฏุงูู ูุตูุฑ
- โจ header ู footer
- โจ ููุงูุจ ุฌุงูุฒุฉ

**ูุซุงู:**
```python
from docx import Document
from docx.shared import Inches

doc = Document()
doc.add_heading('ุชูุฑูุฑ ุงูููุธููู', 0)

table = doc.add_table(rows=1, cols=3)
hdr_cells = table.rows[0].cells
hdr_cells[0].text = 'ุงูุงุณู'
hdr_cells[1].text = 'ุงููุณู'
hdr_cells[2].text = 'ุงูุฑุงุชุจ'

for employee in employees:
    row_cells = table.add_row().cells
    row_cells[0].text = employee['name']
    row_cells[1].text = employee['department']
    row_cells[2].text = str(employee['salary'])

doc.save('report.docx')
```

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/import_export/word_exporter.py` โ (RTL/Arabic support)

---

### D13. ูุฑุงุกุฉ PDF (pdfplumber) โ **ููุชูู** (8 ูุจุฑุงูุฑ 2026)

**ุงููุชุงุญ:** `pdfplumber` (ุชุญุชุงุฌ ุชุซุจูุช: `pip install pdfplumber`)
**ุงูุงุณุชุฎุฏุงู:** ูุนุงูุฌุฉ ูุณุชูุฏุงุช PDF ูุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช

**ุงููููุฒุงุช:**
- โจ ุงุณุชุฎุฑุงุฌ ูุต ูู PDF
- โจ ุงุณุชุฎุฑุงุฌ ุฌุฏุงูู
- โจ ูุฑุงุกุฉ ูุณุชูุฏุงุช ููุณูุญุฉ (ูุน OCR)
- โจ ูุนุงูุฌุฉ ูุดูู ุญุณุงุจุงุช ุจูููุฉ

**ูุซุงู:**
```python
import pdfplumber

with pdfplumber.open("document.pdf") as pdf:
    for page in pdf.pages:
        # ุงุณุชุฎุฑุงุฌ ุงููุต
        text = page.extract_text()

        # ุงุณุชุฎุฑุงุฌ ุงูุฌุฏุงูู
        tables = page.extract_tables()
        for table in tables:
            for row in table:
                print(row)
```

**ุงููููุงุช ุงููููุฐุฉ:**
- `core/import_export/pdf_reader.py` โ

---

## ุฎุทุฉ ุชูููุฐ ุงูุชุญุณููุงุช (ุงููุญูุฑ D)

### ุงููุฑุญูุฉ D1: ุชุญุณููุงุช ุณุฑูุนุฉ (ุฃุณุจูุน ูุงุญุฏ)
```
D3 โ Toast Notifications (ุณููุ ุฃุซุฑ ูุจูุฑ)
D4 โ Humanize Formatting (ุณููุ ูุญุณู UX)
D8 โ Faker ููุงุฎุชุจุงุฑ (ูููุฏ ููุชุทููุฑ)
```

### ุงููุฑุญูุฉ D2: ุชุญุณููุงุช ุงูุฃุฏุงุก (ุฃุณุจูุน ูุงุญุฏ)
```
D2 โ Connection Pool (ููู ุฌุฏุงู ููุงุณุชูุฑุงุฑ)
D1 โ Rich Logging (ูุณุงุนุฏ ูู ุงูู debugging)
```

### ุงููุฑุญูุฉ D3: ุชุญุณููุงุช UI (ุฃุณุจูุนูู)
```
D5 โ Plotly Charts (Dashboard)
D6 โ Fluent Widgets (ุชุฏุฑูุฌู)
D9 โ QR Codes
```

### ุงููุฑุญูุฉ D4: ุงูุฃูุงู (ุฃุณุจูุน ูุงุญุฏ)
```
D7 โ Encryption (ูุชูุงูู ูุน A9)
```

---

## ููุฎุต ุงูููุชุจุงุช

### โ ูุซุจุชุฉ ููุณุชุฎุฏูุฉ:
- `PyQt5` - ุงููุงุฌูุฉ ุงูุฑุณูููุฉ
- `psycopg2` - ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `loguru` - ุงูุชุณุฌูู

### โ ูุซุจุชุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู (ุงููุญูุฑ D):
- `rich`, `humanize`, `tqdm` - Console & Formatting
- `SQLAlchemy` - Database Pool
- `pydantic` - Validation (A10)
- `PyQt-Fluent-Widgets`, `superqt`, `pyqt-toast-notification` - UI
- `plotly`, `matplotlib` - Charts
- `cryptography`, `argon2-cffi`, `keyring` - Security (A9)
- `APScheduler` - Scheduling (A6)
- `watchdog` - File Watching (A7)
- `ollama` - AI (B1-B4)
- `pywin32` - Outlook (C1-C4)
- `Faker` - Testing
- `qrcode` - QR Generation

### โ ูุง ุชุญุชุงุฌ ุชุซุจูุช ุฅุถุงูู:
**ูู ุงูููุชุจุงุช ุงููุทููุจุฉ ููุฎุทุฉ ูุซุจุชุฉ ุจุงููุนู!** โ

---

## ูุธุงู ุงูุจูุงุก ูุงูุชุดุบูู (Build System) โ **ููุชูู**

> **ุงูุชุงุฑูุฎ:** 3 ูุจุฑุงูุฑ 2026
> **ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู

### ุงููููุงุช ุงูููุดุฃุฉ:

| ุงูููู | ุงููุตู |
|-------|-------|
| `build.py` | ุณูุฑูุจุช ุงูุจูุงุก ุงูุฑุฆูุณู |
| `INTEGRA.spec` | ุฅุนุฏุงุฏุงุช PyInstaller |
| `version_info.txt` | ูุนูููุงุช ุงูุฅุตุฏุงุฑ ูู Windows |
| `resources/icons/integra.ico` | ุฃููููุฉ ุงูุจุฑูุงูุฌ |

### ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู:

```bash
# ุจูุงุก ูุงูู (EXE + ุงุฎุชุตุงุฑ ุณุทุญ ุงูููุชุจ)
python build.py

# ุจูุงุก ุงูููู ุงูุชูููุฐู ููุท
python build.py --exe

# ุฅูุดุงุก ุงุฎุชุตุงุฑ ุณุทุญ ุงูููุชุจ ููุท
python build.py --shortcut

# ุชูุธูู ูููุงุช ุงูุจูุงุก
python build.py --clean

# ุชุดุบูู ุงูุจุฑูุงูุฌ
python build.py --run

# ุนุฑุถ ุญุงูุฉ ุงูุจูุงุก
python build.py --status
```

### ุงููุชูุฌุฉ:
- **ุงูููู ุงูุชูููุฐู:** `dist/INTEGRA.exe`
- **ุงูุงุฎุชุตุงุฑ:** ุณุทุญ ุงูููุชุจ โ `INTEGRA`
- **ุงูุฃููููุฉ:** ุชุธูุฑ ูู ุงูููู ูุงูุงุฎุชุตุงุฑ

### ูููุฑุงุญู ุงููุงุฏูุฉ (E - Commercial):

```
E1. Installer (NSIS/Inno Setup)
    โโโ ุชุซุจูุช PostgreSQL ุชููุงุฆูุงู
    โโโ ุชุซุจูุช ุงููุชุทูุจุงุช
    โโโ ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
    โโโ ุฅุนุฏุงุฏ ุงูุฎุฏูุงุช

E2. Auto-Update System
    โโโ ูุญุต ุงูุชุญุฏูุซุงุช ุนูุฏ ุงูุชุดุบูู
    โโโ ุชุญููู ูุชุซุจูุช ุงูุชุญุฏูุซุงุช
    โโโ Rollback ูู ุญุงูุฉ ุงููุดู
```

---

## ุชุฑุชูุจ ุงูุฃููููุงุช ุงููุญุฏูุซ

> **ุขุฎุฑ ุชุญุฏูุซ:** 3 ูุจุฑุงูุฑ 2026
> **ููุงุญุธุฉ:** ุงูุฃููููุฉ ุงูุญุงููุฉ ูู ุงูุงุณุชุฎุฏุงู ุงูุดุฎุตูุ ุงููุฑุงุญู ุงูุชุฌุงุฑูุฉ (E, F) ูู ุงูููุงูุฉ

---

### โ ุฃููููุฉ ุนุงููุฉ (ุถุฑูุฑูุฉ ููุนูู ุงููููู) - ููุชูู

| ุงูุฑูู | ุงูุจูุฏ | ุงูููุชุจุฉ | ุงููุงุฆุฏุฉ | ุงูุญุงูุฉ |
|-------|-------|---------|---------|--------|
| 0.1 | ูุธุงู ุงูุจูุงุก | PyInstaller | ููู ุชูููุฐู + shortcut | โ ููุชูู |
| A1 | Logging | loguru | ุชุณุฌูู ุงูุฃุญุฏุงุซ ูุงูุฃุฎุทุงุก | โ ููุชูู |
| A2 | Exception Handler | PyQt5 | ููุน ุงูุฅุบูุงู ุงูููุงุฌุฆ | โ ููุชูู |
| A5 | Background Processing | QThread | ููุงู ุฎูููุฉ ุจุฏูู ุชุฌููุฏ | โ ููุชูู |
| **D3** | **Toast Notifications** | `pyqt-toast-notification` | **ุฅุดุนุงุฑุงุช ุญุฏูุซุฉ ุจุฏู MessageBox** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D6** | **ุชุตููู ุญุฏูุซ ูููุงุฌูุฉ** | `PyQt-Fluent-Widgets` | **ูุธูุฑ Windows 11 ุงุญุชุฑุงูู** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D10** | **ุฃููููุงุช ุงุญุชุฑุงููุฉ** | `QtAwesome` | **6000+ ุฃููููุฉ ุฌุงูุฒุฉ** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D2** | **Connection Pool** | `SQLAlchemy` | **ุงุณุชูุฑุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D1** | **Rich Console Logging** | `rich` | **Console output ุงุญุชุฑุงูู** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |

---

### ๐ก ุฃููููุฉ ูุชูุณุทุฉ (ุชุญุณูู ุงูุฅูุชุงุฌูุฉ) - โ ููุชูู ุจุงููุงูู

| ุงูุฑูู | ุงูุจูุฏ | ุงูููุชุจุฉ | ุงููุงุฆุฏุฉ | ุงูุญุงูุฉ |
|-------|-------|---------|---------|--------|
| **D11** | **ุงุณุชูุฑุงุฏ Excel** | `pandas` + `openpyxl` | **ุฑูุน ุจูุงูุงุช ุจุงูุฌููุฉ** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D12** | **ุชุตุฏูุฑ Word** | `python-docx` | **ุชูุงุฑูุฑ HR ุจุตูุบุฉ Word** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **D13** | **ูุฑุงุกุฉ PDF** | `pdfplumber` | **ูุนุงูุฌุฉ ูุณุชูุฏุงุช** | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| D4 | Humanize Formatting | `humanize` | "ููุฐ 5 ุฏูุงุฆู" ุจุฏู timestamp | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| D5 | ุฑุณูู ุจูุงููุฉ | `plotly` / `pyqtgraph` | Dashboard ุชูุงุนูู | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| A3 | Auto-Save | QTimer | ุญูุงูุฉ ุงูุจูุงูุงุช ูู ุงูุถูุงุน | โ ููุชูู |
| A4 | Audit Trail | PostgreSQL Triggers | ุชุชุจุน ุงูุชุบููุฑุงุช | โ ููุชูู |

---

### ๐ข ูููุณุชูุจู (ุชุทููุฑ ูุชูุฏู) - โ ููุชูู ุจุงููุงูู

| ุงูุฑูู | ุงูุจูุฏ | ุงูููุชุจุฉ | ุงููุงุฆุฏุฉ | ุงูุญุงูุฉ |
|-------|-------|---------|---------|--------|
| B1-B5 | ุงูุฐูุงุก ุงูุงุตุทูุงุนู | `ollama` | ุชุญููู ุฐูู ุจุฏูู ุฅูุชุฑูุช | โ ููุชูู |
| D8 | ุจูุงูุงุช ุงุฎุชุจุงุฑ | `Faker` | ุชูููุฏ ุจูุงูุงุช ููููุฉ | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| D9 | QR Code | `qrcode` | ุจุทุงูุงุช ุงูููุธููู | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| C1-C4 | ููุฏููู ุงูุฅูููู | `pywin32` | ุชูุงูู Outlook | โ ููุชูู |
| A9 | ุงูุฃูุงู | `argon2-cffi` + `keyring` | ุชุดููุฑ ูุตูุงุญูุงุช | โ ููุชูู |

---

## ุฎุทุฉ ุงูุชูููุฐ ุงูุชูุตูููุฉ

### ุงููุฑุญูุฉ 0: ุงูุชุดุบูู โ **ููุชูู**
```
โ ูุธุงู ุงูุจูุงุก (build.py)
โ ููู ุชูููุฐู (INTEGRA.exe / INTEGRA.pyw)
โ ุงุฎุชุตุงุฑ ุณุทุญ ุงูููุชุจ
โ Sync System ูุนุทู ูุคูุชุงู
```

### ุงููุฑุญูุฉ 1: ุงูุฃุณุงุณูุงุช โ **ููุชูู**
```
โ A1 โ Logging (Loguru)
โ A2 โ Exception Handler
โ A5 โ Background Processing
```

### ุงููุฑุญูุฉ 2: ุชุญุณููุงุช ุงููุงุฌูุฉ โ **ููุชูู (8 ูุจุฑุงูุฑ 2026)**
```
โ D3  โ Toast Notifications (ุฅุดุนุงุฑุงุช ุญุฏูุซุฉ)
โ D6  โ PyQt-Fluent-Widgets (ูุธูุฑ Windows 11)
โ D10 โ QtAwesome Icons (ุฃููููุงุช ุงุญุชุฑุงููุฉ)
```

### ุงููุฑุญูุฉ 3: ุงุณุชูุฑุงุฑ ูุฃุฏุงุก
```
D2  โ Connection Pool (ุงุณุชูุฑุงุฑ DB)
D4  โ Humanize Formatting (ุชูุณูู ุงูุจูุงูุงุช)
A3  โ Auto-Save + Recovery
```

### ุงููุฑุญูุฉ 4: ุงุณุชูุฑุงุฏ/ุชุตุฏูุฑ ุงูุจูุงูุงุช
```
D11 โ Excel Import (pandas + openpyxl)
D12 โ Word Export (python-docx)
D13 โ PDF Processing (pdfplumber)
```

### ุงููุฑุญูุฉ 5: ุฑุณูู ุจูุงููุฉ ูDashboard
```
D5  โ Plotly Charts
D9  โ QR Codes
```

### ุงููุฑุญูุฉ 6: ุงูุจูุงูุงุช ูุงูุฃูุงู
```
A4  โ Audit Trail
A10 โ Pydantic Validation
A9  โ Security (RBAC)
```

### ุงููุฑุญูุฉ 7: ุงูุฐูุงุก ุงูุงุตุทูุงุนู
```
B1 โ Ollama Service Layer
B5 โ AI Chat Panel
B3 โ Data Agent
B4 โ Smart Alerts
```

### ุงููุฑุญูุฉ 8: ููุฏููู ุงูุฅูููู โ **ููุชูู**
```
โ C1 โ Outlook Connector
โ C2 โ Email Sync + Cache
โ C3 โ Email UI
โ C4 โ AI + Email Integration
```

### ุงููุฑุญูุฉ 9: ููุฏููู ุงูุฅูููู ุงููุชูุฏู (AI-Powered) โ **ููุชูู (8 ูุจุฑุงูุฑ 2026)**

> **ุงููุญูุฑ G: ุงูุฅูููู ุงูุฐูู** - ุชุญููู ููุฏููู ุงูุฅูููู ุฅูู ูุณุงุนุฏ ุฐูู ูุชูุงูู
> **ุงููููุงุช:** `modules/email_ai/` (6 ูููุงุช Python)

```
G1 โ AI Email Assistant (ูุณุงุนุฏ ุงูุฅูููู ุงูุฐูู) โ
     - ุชุญููู ุชููุงุฆู ููู ุฅูููู ุฌุฏูุฏ (AI + rule-based fallback)
     - ุชุตููู ุฐูู (13 ุชุตููู: ุนูู ุนุงุฌู/ุนุงุฏู/ููุนููุ ุงุฌุชูุงุนุ ูููุฉุ ุงุนุชูุงุฏุ HRุ ูุงููุ ุดุฎุตูุ ูุดุฑุฉุ ุชููุงุฆูุ ูุดุจูู)
     - ุงุณุชุฎุฑุงุฌ ุงูููุงู ูุงูููุงุนูุฏ ูุงูููุงุนูุฏ ุงูููุงุฆูุฉ ุชููุงุฆูุงู
     - ูุดู ุงูุฅููููุงุช ุงููุดุจููุฉ
     - ุชุญููู ุงููุดุงุนุฑ ูุงููุจุฑุฉ
     โ modules/email_ai/email_assistant.py

G2 โ Smart Notifications (ุงูุฅุดุนุงุฑุงุช ุงูุฐููุฉ) โ
     - ุฅุดุนุงุฑุงุช ููุฑูุฉ ููุฅููููุงุช ุงูุนุงุฌูุฉ
     - ุชูุจูู ุจุงูููุงู ุงููุณุชุฎุฑุฌุฉ ูู ุงูุฅููููุงุช
     - ููุฎุต ูููู ุชููุงุฆู
     - ูุญุต ุชุฑุงูู ุงูุฅููููุงุช ุบูุฑ ุงูููุฑูุกุฉ
     - ูุญุต ุงููุชุงุจุนุงุช (ุฅููููุงุช ุจุฏูู ุฑุฏ)
     - ุฑุจุท ูุน Toast Notifications (D3) ููุธุงู ุงูุฅุดุนุงุฑุงุช (J)
     โ modules/email_ai/smart_notifications.py

G3 โ Email Compose AI (ูุชุงุจุฉ ุงูุฅูููู ุจุงูุฐูุงุก) โ
     - ุฅูุดุงุก ุฑุฏ ุชููุงุฆู ูุน AI (7 ูุจุฑุงุช: ุฑุณูู/ุงุญุชุฑุงูู/ูุฏู/ูุฎุชุตุฑ/ุชูุตููู/ุงุนุชุฐุงุฑู/ุดูุฑ)
     - ุชุญุณูู ุตูุงุบุฉ ุงูุฅูููู
     - ุชุฑุฌูุฉ ุฐููุฉ (ุนุฑุจู โ ุฅูุฌููุฒู)
     - 10 ููุงูุจ ุฐููุฉ (ุชุฃููุฏ ุงุณุชูุงูุ ูุจูู/ุฑูุถ ุงุฌุชูุงุนุ ุฅุชูุงู ูููุฉุ ุทูุจ ุฅุฌุงุฒุฉุ ูุชุงุจุนุฉุ ุชุนุฑููุ ุงุนุชุฐุงุฑุ ุชุตุนูุฏุ ุดูุฑ)
     - ุชูููุฏ ููุถูุน ููุงุณุจ ุชููุงุฆูุงู
     โ modules/email_ai/compose_ai.py

G4 โ Email Search & Analytics (ุงูุจุญุซ ูุงูุชุญูููุงุช) โ
     - ุจุญุซ ุฐูู ูุน ุชุฑุชูุจ ุญุณุจ ุงูุฃูููุฉ (relevance scoring)
     - ุชุญูููุงุช ุดุงููุฉ (ุฃูุซุฑ ูุฑุณูุ ุฃููุงุช ุงูุฐุฑูุฉุ ุชูุฒูุน ูููู/ุฃุณุจูุนู)
     - ุชุชุจุน ุงููุญุงุฏุซุงุช (conversation threading)
     - ุฅูุฌุงุฏ ุฅููููุงุช ุฐุงุช ุตูุฉ
     - ููู ูุฑุณู ุดุงูู (SenderStats)
     โ modules/email_ai/search_analytics.py

G5 โ Auto-Actions (ุงูุฅุฌุฑุงุกุงุช ุงูุชููุงุฆูุฉ) โ
     - ูุญุฑู ููุงุนุฏ ูุงูู (conditions + operators + actions)
     - 10 ุฃููุงุน ุฅุฌุฑุงุกุงุช (ูููุ ุชุญุฏูุฏ ูููุฑูุก/ุจุนูุงูุฉุ ุชุตูููุ ุฅูุดุงุก ูููุฉ/ุฅุดุนุงุฑุ ุฑุฏ ุชููุงุฆูุ ุฃุฑุดูุฉุ ุชุญููู)
     - 3 ููุงุนุฏ ุงูุชุฑุงุถูุฉ (ุฃุฑุดูุฉ ูุดุฑุงุชุ ุชุนููู ุนุงุฌูุ ุฅูุดุงุก ููุงู)
     - ุฃุฑุดูุฉ ุฐููุฉ ููุฅููููุงุช ุงููุฏููุฉ
     - ูุญุต ุงููุชุงุจุนุงุช ุงููุทููุจุฉ
     - ุญูุธ/ุชุญููู ุงูููุงุนุฏ ูู ููู JSON
     โ modules/email_ai/auto_actions.py

G6 โ Employee Integration (ุฑุจุท ุจุงูููุธููู) โ
     - ุฑุจุท ุงูุฅูููู ุจููู ุงูููุธู (3 ุงุณุชุฑุงุชูุฌูุงุช: ุจุฑูุฏุ ุงุณูุ ูุทุงู)
     - ุณุฌู ุงููุฑุงุณูุงุช ููู ููุธู
     - ููู ุฅูููู ุดุงูู (EmployeeEmailProfile)
     - ุชุญููู ุชูุงุนูุงุช ุงูููุธููู
     - AI ูุนุฑู ุงููุฑุณู ูููุชุฑุญ ุฅุฌุฑุงุกุงุช (HRุ ูุงููุฉุ ููุงู)
     - ูุงุฆูุฉ ุงููุฑุงุณููู ููู ููุธู
     โ modules/email_ai/employee_integration.py
```

---

## ุงููุญูุฑ H: ููุฏููู ุงูููุงู (Tasks Module) โ **ููุชูู**

> **ุงูููููู:** ูุธุงู ุฅุฏุงุฑุฉ ููุงู ูุชูุงูู ูุณุชูุญู ูู Google Tasks ูุน ููุฉ AI
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุญุงูุฉ:** โ ููุชูู ุจุงููุงูู (20 ููู Python + SQL schema)
> **ุงูุฃููููุฉ:** ุงุณุชุฑุงุชูุฌู - ุงูููุจ ุงููุงุจุถ ููุธุงู ุงูุนูู

### ุงูููููู ุงูุนุงู

ููุฏููู ููุงู ุงุญุชุฑุงูู ูุชูุงูู ูุน ุงูุฅูููู ูุงูุชูููู ูุงูู AI ูุฃุชูุชุฉ ุณูุฑ ุงูุนูู ุงููููู.

```
๐ง ุงูุฅูููู โโ โ ุงูููุงู โโ ๐ ุงูุชูููู
                 โ
              ๐ค AI
```

### H1. ููุงุฐุฌ ุงูุจูุงูุงุช (Data Models)

**ุฌุฏูู ุงูููุงู (tasks):**
```sql
CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    title VARCHAR(500) NOT NULL,
    description TEXT,
    status VARCHAR(50) DEFAULT 'pending',  -- pending, in_progress, completed, cancelled
    priority VARCHAR(20) DEFAULT 'normal', -- urgent, high, normal, low
    category VARCHAR(100),                 -- hr, finance, operations, etc.

    -- ุงูุฑุจุท
    parent_task_id INTEGER REFERENCES tasks(id),  -- ููููุงู ุงููุฑุนูุฉ
    source_email_id VARCHAR(255),                 -- ูุตุฏุฑ ุงูุฅูููู
    employee_id INTEGER REFERENCES employees(id), -- ุงูููุธู ุงููุฑุชุจุท

    -- ุงูุชูุงุฑูุฎ
    due_date TIMESTAMP,
    reminder_date TIMESTAMP,
    start_date TIMESTAMP,
    completed_at TIMESTAMP,

    -- ุงูุชูุฑุงุฑ
    is_recurring BOOLEAN DEFAULT FALSE,
    recurrence_pattern JSONB,  -- {"type": "daily|weekly|monthly", "interval": 1, ...}

    -- AI
    ai_analysis JSONB,         -- ุชุญููู AI ูููููุฉ
    ai_suggested_action TEXT,  -- ุงูุฅุฌุฑุงุก ุงูููุชุฑุญ

    -- ุงููุธุงู
    created_by INTEGER,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงูููุงู ุงููุฑุนูุฉ (ููุจุณุงุทุฉ)
CREATE TABLE task_checklist (
    id SERIAL PRIMARY KEY,
    task_id INTEGER REFERENCES tasks(id) ON DELETE CASCADE,
    title VARCHAR(500) NOT NULL,
    is_completed BOOLEAN DEFAULT FALSE,
    sort_order INTEGER DEFAULT 0
);

-- ุฌุฏูู ูุฑููุงุช ุงูููุงู
CREATE TABLE task_attachments (
    id SERIAL PRIMARY KEY,
    task_id INTEGER REFERENCES tasks(id) ON DELETE CASCADE,
    file_name VARCHAR(255),
    file_path TEXT,
    file_size INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);
```

**ุงููููุงุช:**
- `core/database/tables/tasks.sql`
- `modules/tasks/models/task_models.py`

### H2. ูุงุฆูุฉ ุงูููุงู (Task List UI)

**ุงููููุฒุงุช:**
- ุนุฑุถ ูุงุฆูุฉ ุจูู ุงูููุงู ูุน ููุชุฑุฉ ูุจุญุซ
- ุชุตููุฉ ุญุณุจ: ุงูุญุงูุฉุ ุงูุฃููููุฉุ ุงูุชุตูููุ ุงูุชุงุฑูุฎ
- ุชุฑุชูุจ ุญุณุจ: ุงูุฃููููุฉุ ุชุงุฑูุฎ ุงูุงุณุชุญูุงูุ ุชุงุฑูุฎ ุงูุฅูุดุงุก
- ุจุทุงูุงุช ููุงู ููููุฉ ุญุณุจ ุงูุฃููููุฉ
- ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ: ุชุบููุฑ ุงูุญุงูุฉุ ุงูุฃููููุฉุ ุงูุญุฐู
- ุณุญุจ ูุฅููุงุช ูุชุบููุฑ ุงูุชุฑุชูุจ

**ุงููููุงุช:**
- `modules/tasks/screens/task_list/task_list_screen.py`
- `modules/tasks/widgets/task_card.py`
- `modules/tasks/widgets/task_filters.py`

### H3. ููุญุฉ ูุงูุจุงู (Kanban Board)

**ุงูุฃุนูุฏุฉ:**
```
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
โ   ููุฏ       โ   ููุฏ       โ    ููุชูู    โ    ููุบู    โ
โ  ุงูุงูุชุธุงุฑ   โ   ุงูุชูููุฐ   โ             โ             โ
โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโค
โ [ูููุฉ 1]   โ [ูููุฉ 3]   โ [ูููุฉ 5]   โ            โ
โ [ูููุฉ 2]   โ [ูููุฉ 4]   โ [ูููุฉ 6]   โ            โ
โ            โ            โ [ูููุฉ 7]   โ            โ
โโโโโโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโดโโโโโโโโโโโโโโ
```

**ุงููููุฒุงุช:**
- ุณุญุจ ูุฅููุงุช ุจูู ุงูุฃุนูุฏุฉ
- ุนุฑุถ ูุตุบุฑ ูุชูุงุตูู ุงููููุฉ
- ุฃููุงู ุญุณุจ ุงูุฃููููุฉ
- ููุชุฑุฉ ุญุณุจ ุงูุชุตููู
- WIP Limits (ุญุฏ ุงูููุงู ูู ูู ุนููุฏ)

**ุงููููุงุช:**
- `modules/tasks/screens/task_board/kanban_board.py`
- `modules/tasks/widgets/kanban_column.py`
- `modules/tasks/widgets/draggable_task_card.py`

### H4. ุชูุงูู ุงูููุงู ูุงูุฅูููู

**ุงูุณููุงุฑูู:**
```
1. ูุตู ุฅูููู โ AI ูุญููู
2. AI ููุชุดู: "ุทูุจ ุชุณููุฉ ุฅุฌุงุฒุฉ"
3. AI ูููุดุฆ ุฅุดุนุงุฑ ูู ุงููุธุงู
4. ุงููุณุชุฎุฏู ูุฎุชุงุฑ "ุฅูุดุงุก ูููุฉ"
5. ุงููููุฉ ุชููุดุฃ ูุน:
   - ุงูุนููุงู ูู ููุถูุน ุงูุฅูููู
   - ุงููุตู ูู ูุต ุงูุฅูููู
   - ุฑุจุท ุจุงูุฅูููู ุงูุฃุตูู
   - ุฑุจุท ุจุงูููุธู (ุฅุฐุง ููุฌุฏ)
   - AI ููุชุฑุญ ุงูุฅุฌุฑุงุก
```

**ุงููููุงุช:**
- `modules/tasks/integration/email_to_task.py`
- `modules/tasks/integration/task_email_linker.py`

### H5. ุงูููุงู ุงููุชูุฑุฑุฉ

**ุฃููุงุท ุงูุชูุฑุงุฑ:**
- ูููู (ูู ููู / ูู X ุฃูุงู)
- ุฃุณุจูุนู (ุฃูุงู ูุญุฏุฏุฉ ูู ุงูุฃุณุจูุน)
- ุดูุฑู (ููู ูุญุฏุฏ / ุฃูู ุฃุญุฏุ ุฅูุฎ)
- ุณููู (ุชุงุฑูุฎ ูุญุฏุฏ)

**ูุซุงู:**
```python
recurrence_pattern = {
    "type": "weekly",
    "interval": 1,
    "days_of_week": ["sunday", "tuesday", "thursday"],
    "end_type": "never",  # or "count" or "date"
    "end_count": 10,
    "end_date": "2026-12-31"
}
```

**ุงููููุงุช:**
- `modules/tasks/recurring/recurrence_manager.py`
- `modules/tasks/recurring/recurrence_patterns.py`

### H6. ูููู ุงูููุงู ุงูุฐูู (Task AI Agent)

**ุงููุฏุฑุงุช:**
- ุงูุชุฑุงุญ ุฃููููุฉ ุงููููุฉ ุชููุงุฆูุงู
- ุงูุชุฑุงุญ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุจูุงุกู ุนูู ููุน ุงููููุฉ
- ุงูุชุฑุงุญ ุงูุฅุฌุฑุงุก ุงูููุงุณุจ
- ุชุตููู ุงููููุฉ ุชููุงุฆูุงู
- ุงูุชุดุงู ุงูููุงู ุงููุชุฃุฎุฑุฉ ูุงูุชูุจูู
- ุงูุชุฑุงุญ ุชูููุถ ุงููููุฉ

**ุงููููุงุช:**
- `core/ai/agents/task_agent.py`

---

## ุงููุญูุฑ I: ููุฏููู ุงูุชูููู (Calendar Module) โ

> **ุงูููููู:** ุชูููู ุงุญุชุฑุงูู ูุณุชูุญู ูู Google Calendar ูุน ุชูุงูู ุฐูู
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุฃููููุฉ:** ุงุณุชุฑุงุชูุฌู - ุชูุธูู ุงูููุช ูุงูููุงุนูุฏ
> **ุงูุญุงูุฉ:** โ **ููุชูู ุจุงููุงูู** (4 ูุจุฑุงูุฑ 2026)

### ุงูููููู ุงูุนุงู

ุชูููู ูุชูุงูู ูุนุฑุถ ุงูููุงู ูุงูุฃุญุฏุงุซ ูุงูููุงุนูุฏ ูู ูุงุฌูุฉ ููุญุฏุฉ.

### I1. ููุงุฐุฌ ุงูุจูุงูุงุช (Data Models)

**ุฌุฏูู ุงูุฃุญุฏุงุซ (calendar_events):**
```sql
CREATE TABLE calendar_events (
    id SERIAL PRIMARY KEY,
    title VARCHAR(500) NOT NULL,
    description TEXT,
    event_type VARCHAR(50) DEFAULT 'event',  -- event, task, reminder, meeting

    -- ุงูุชูููุช
    start_datetime TIMESTAMP NOT NULL,
    end_datetime TIMESTAMP,
    is_all_day BOOLEAN DEFAULT FALSE,
    timezone VARCHAR(50) DEFAULT 'Asia/Riyadh',

    -- ุงูุฑุจุท
    task_id INTEGER REFERENCES tasks(id),
    employee_id INTEGER REFERENCES employees(id),

    -- ุงูุชุฐููุฑุงุช
    reminders JSONB,  -- [{"type": "notification", "minutes_before": 30}, ...]

    -- ุงูุชูุฑุงุฑ
    is_recurring BOOLEAN DEFAULT FALSE,
    recurrence_pattern JSONB,

    -- ุงูููู ูุงูุชุตููู
    color VARCHAR(20) DEFAULT '#3498db',
    category VARCHAR(100),

    -- ุงููุดุงุฑููู
    attendees JSONB,  -- [{"email": "...", "status": "accepted|pending|declined"}]

    -- ุงููุธุงู
    source VARCHAR(50),  -- integra, outlook, manual
    external_id VARCHAR(255),  -- ูุนุฑู ุฎุงุฑุฌู ูููุฒุงููุฉ
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

**ุงููููุงุช:**
- `core/database/tables/calendar_events.sql`
- `modules/calendar/models/calendar_models.py`

### I2. ุงูุนุฑุถ ุงูุดูุฑู (Month View)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              โ  ูุจุฑุงูุฑ 2026  โถ                            โ
โโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโค
โ ุงูุฃุญุฏ  โ ุงูุฅุซููู โ ุงูุซูุงุซุงุกโ ุงูุฃุฑุจุนุงุกโ ุงูุฎููุณ โ ุงูุฌูุนุฉ โ ุงูุณุจุชโ
โโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโค
โ   1    โ   2    โ   3    โ   4    โ   5    โ   6    โ  7  โ
โ        โ [ุชุณููุฉ]โ        โ        โ        โ        โ     โ
โโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโค
โ   8    โ   9    โ   10   โ   11   โ   12   โ   13   โ 14  โ
โ        โ        โ[ุงุฌุชูุงุน]โ        โ        โ        โ     โ
โโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโ
```

**ุงููููุงุช:**
- `modules/calendar/views/month_view.py`
- `modules/calendar/widgets/day_cell.py`

### I3. ุงูุนุฑุถ ุงูุฃุณุจูุนู (Week View)

```
โโโโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโ
โ ุงูููุช   โ ุงูุฃุญุฏ  โ ุงูุฅุซูููโ ุงูุซูุงุซุงุกโุงูุฃุฑุจุนุงุกโ ุงูุฎููุณ โ ุงูุฌูุนุฉ โ ุงูุณุจุช โ
โโโโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโค
โ 08:00   โ        โ        โ        โ        โ        โ        โ        โ
โ 09:00   โ [ูููุฉ] โ        โ        โ[ุงุฌุชูุงุน]โ        โ        โ        โ
โ 10:00   โ        โ[ุชุณููุฉ] โ        โ        โ        โ        โ        โ
โ 11:00   โ        โ        โ        โ        โ        โ        โ        โ
โ ...     โ        โ        โ        โ        โ        โ        โ        โ
โโโโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโ
```

**ุงููููุงุช:**
- `modules/calendar/views/week_view.py`
- `modules/calendar/widgets/time_grid.py`

### I4. ุงูุนุฑุถ ุงููููู (Day View)

**ุงููููุงุช:**
- `modules/calendar/views/day_view.py`
- `modules/calendar/widgets/hour_block.py`

### I5. ุชุฒุงูู ุงูููุงู ูุงูุชูููู

**ุงููุงุนุฏุฉ:**
- ูู ูููุฉ ููุง `due_date` ุชุธูุฑ ูู ุงูุชูููู ุชููุงุฆูุงู
- ุนูุฏ ุชุบููุฑ ุชุงุฑูุฎ ุงููููุฉุ ูุชุญุฏุซ ุงูุชูููู
- ุนูุฏ ุณุญุจ ุญุฏุซ ูู ุงูุชููููุ ูุชุญุฏุซ ุชุงุฑูุฎ ุงููููุฉ

**ุงููููุงุช:**
- `modules/calendar/sync/task_calendar_sync.py`

### I6. ูุฒุงููุฉ Outlook Calendar

**ุงููููุฒุงุช:**
- ูุฑุงุกุฉ ุฃุญุฏุงุซ Outlook Calendar
- ุฅูุดุงุก ุฃุญุฏุงุซ ูู Outlook ูู INTEGRA
- ูุฒุงููุฉ ุซูุงุฆูุฉ ุงูุงุชุฌุงู
- ุชุฌูุจ ุงูุชูุฑุงุฑุงุช

**ุงููููุงุช:**
- `modules/calendar/sync/outlook_calendar_sync.py`

### I7. ูููู ุงูุชูููู ุงูุฐูู (Calendar AI Agent)

**ุงููุฏุฑุงุช:**
- ุงูุชุฑุงุญ ุฃูุถู ููุช ูููููุฉ
- ุงูุชุดุงู ุงูุชุนุงุฑุถุงุช ูู ุงูููุงุนูุฏ
- ุงูุชุฑุงุญ ุฅุนุงุฏุฉ ุฌุฏููุฉ
- ุชุญููู ุฃููุงุท ุงูุนูู
- ุงูุชุฑุงุญ ูุชุฑุงุช ุฑุงุญุฉ

**ุงููููุงุช:**
- `core/ai/agents/calendar_agent.py`

---

## ุงููุญูุฑ J: ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฐูู (Smart Notifications) โ **ููุชูู**

> **ุงูููููู:** ูุฑูุฒ ุฅุดุนุงุฑุงุช ููุญุฏ ูุฑุจุท ูู ุงูููุฏูููุงุช
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุญุงูุฉ:** โ ููุชูู ุจุงููุงูู (16 ููู Python + SQL schema)
> **ุงูุฃููููุฉ:** ุฃุณุงุณู - ุงูุฑุงุจุท ุจูู ูู ุดูุก

### ุงูููููู ุงูุนุงู

ูุธุงู ุฅุดุนุงุฑุงุช ูุฑูุฒู ูุฌูุน ุงูุฅุดุนุงุฑุงุช ูู ูู ุงูููุฏูููุงุช ูุน ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ (3)     โ ุฃููููุฉ ุงูุฌุฑุณ ูุน Badge              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ๐ฌ ูุฑูุฒ ุงูุฅุดุนุงุฑุงุช                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ด ุนุงุฌู: ุทูุจ ุชุณููุฉ ุฅุฌุงุฒุฉ ูู HR                 โ
โ    [ุฅูุดุงุก ูููุฉ] [ูุชุญ ุงูุฅูููู] [ุชุฌุงูู]          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ก ููู: ุงุฌุชูุงุน ุจุนุฏ ุณุงุนุฉ                        โ
โ    [ูุชุญ ุงูุชูููู] [ุชุฃุฌูู 15 ุฏูููุฉ]              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ต ุนุงุฏู: ุชู ุญูุธ ุงูุชุณููุฉ ุจูุฌุงุญ                  โ
โ    [ูุชุญ ุงูุชุณููุฉ] [ุทุจุงุนุฉ]                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### J1. ููุงุฐุฌ ุงูุจูุงูุงุช

**ุฌุฏูู ุงูุฅุดุนุงุฑุงุช (notifications):**
```sql
CREATE TABLE notifications (
    id SERIAL PRIMARY KEY,
    title VARCHAR(500) NOT NULL,
    body TEXT,
    notification_type VARCHAR(50),  -- email, task, calendar, system, ai
    priority VARCHAR(20) DEFAULT 'normal',  -- urgent, high, normal, low

    -- ุงูุญุงูุฉ
    is_read BOOLEAN DEFAULT FALSE,
    is_dismissed BOOLEAN DEFAULT FALSE,

    -- ุงูุฑุจุท
    source_type VARCHAR(50),  -- email, task, calendar, employee
    source_id VARCHAR(255),   -- ูุนุฑู ุงููุตุฏุฑ

    -- ุงูุฅุฌุฑุงุกุงุช ุงููุชุงุญุฉ
    actions JSONB,  -- [{"id": "create_task", "label": "ุฅูุดุงุก ูููุฉ", "action_type": "..."}]

    -- AI
    ai_priority_score FLOAT,
    ai_category VARCHAR(100),
    ai_suggested_action VARCHAR(100),

    -- ุงููุธุงู
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP,
    user_id INTEGER
);
```

**ุงููููุงุช:**
- `core/database/tables/notifications.sql`
- `modules/notifications/models/notification_models.py`

### J2. ุฃููููุฉ ุงูุฌุฑุณ (Notification Bell)

**ุงููููุฒุงุช:**
- ุชุธูุฑ ูู ุฃุนูู ูููู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
- Badge ูุนุฑุถ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
- ุนูุฏ ุงูููุฑ ุชูุชุญ ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช ุงูุฃุฎูุฑุฉ
- ุฒุฑ "ุนุฑุถ ุงููู" ููุชุญ ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช

**ุงููููุงุช:**
- `modules/notifications/widgets/notification_bell.py`
- `modules/notifications/widgets/notification_popup.py`

### J3. ุตูุญุฉ ูุฑูุฒ ุงูุฅุดุนุงุฑุงุช

**ุงููููุฒุงุช:**
- ูุงุฆูุฉ ูุงููุฉ ุจูู ุงูุฅุดุนุงุฑุงุช
- ููุชุฑุฉ ุญุณุจ: ุงูููุนุ ุงูุฃููููุฉุ ุงูุญุงูุฉ
- ุจุญุซ ูู ุงูุฅุดุนุงุฑุงุช
- ุฅุฌุฑุงุกุงุช ุฌูุงุนูุฉ (ุชุญุฏูุฏ ุงููู ูููุฑูุกุ ุญุฐู ุงููุฏูู)
- ุชุฌููุน ุญุณุจ ุงูููู

**ุงููููุงุช:**
- `modules/notifications/screens/notification_center.py`
- `modules/notifications/widgets/notification_card.py`

### J4. ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ

**ุฃูุซูุฉ ุนูู ุงูุฅุฌุฑุงุกุงุช:**
```python
actions = [
    {
        "id": "create_task",
        "label": "ุฅูุดุงุก ูููุฉ",
        "icon": "fa5s.tasks",
        "action_type": "create_task",
        "params": {"title": "...", "description": "..."}
    },
    {
        "id": "open_email",
        "label": "ูุชุญ ุงูุฅูููู",
        "icon": "fa5s.envelope-open",
        "action_type": "open_module",
        "params": {"module": "email", "item_id": "..."}
    },
    {
        "id": "dismiss",
        "label": "ุชุฌุงูู",
        "icon": "fa5s.times",
        "action_type": "dismiss"
    }
]
```

**ุงููููุงุช:**
- `modules/notifications/actions/action_handler.py`
- `modules/notifications/actions/action_registry.py`

### J5. ุชุญุฏูุฏ ุงูุฃููููุฉ ุจุงูุฐูุงุก

**ูุนุงููุฑ AI ูุชุญุฏูุฏ ุงูุฃููููุฉ:**
- ูููุงุช ููุชุงุญูุฉ (ุนุงุฌูุ ููุฑูุ ุถุฑูุฑู)
- ุงููุฑุณู (ูุฏูุฑุ HRุ ุฅุฏุงุฑุฉ)
- ููุน ุงูุทูุจ (ูุงููุ ูุงููููุ ุชุดุบููู)
- ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- ุชุงุฑูุฎ ุงูุฅูููู (ูุฏูู = ุฃููููุฉ ุฃุนูู)

**ุงููููุงุช:**
- `modules/notifications/ai/priority_detector.py`

### J6. ุฅุดุนุงุฑุงุช ุณุทุญ ุงูููุชุจ

**ุงููููุฒุงุช:**
- ุฅุดุนุงุฑุงุช Windows native
- ุตูุช ุชูุจูู ูุงุจู ููุชุฎุตูุต
- ุฎูุงุฑ ูุชู ุงูุฅุดุนุงุฑุงุช
- ุฌุฏููุฉ "ูุถุน ุงูุชุฑููุฒ"

**ุงููููุงุช:**
- `modules/notifications/desktop/desktop_notifier.py`

---

## ุงููุญูุฑ K: ููุธููุฉ ูููุงุก AI ุงููุชูุงููุฉ (AI Orchestration) โ **ููุชูู**

> **ุงูููููู:** ูุธุงู ูููุงุก AI ูุชูุงูู ูุฏูุฑ ุงูุจุฑูุงูุฌ ุจุงููุงูู
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุญุงูุฉ:** โ ููุชูู ุจุงููุงูู
> **ุงูุฃููููุฉ:** ุซูุฑู - ุงูุนูู ุงููุฏุจุฑ ููุจุฑูุงูุฌ

### ุงูููููู ุงูุนุงู

ููุธููุฉ ูู ูููุงุก AI ูุชุฎุตุตูู ูุนูููู ูุนุงู ูุฃุชูุชุฉ ุณูุฑ ุงูุนูู.

```
                    โโโโโโโโโโโโโโโโโโโโโโโ
                    โ  Coordinator Agent  โ
                    โ   (ุงูููุณู ุงูุฑุฆูุณู)   โ
                    โโโโโโโโโโโโฌโโโโโโโโโโโ
                               โ
        โโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโ
        โ                      โ                      โ
        โผ                      โผ                      โผ
โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ
โ  Email Agent  โ    โ  Task Agent   โ    โ Calendar Agentโ
โ (ูููู ุงูุฅูููู) โ    โ (ูููู ุงูููุงู)  โ    โ(ูููู ุงูุชูููู) โ
โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ
        โ                      โ                      โ
        โโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโ
                               โ
                    โโโโโโโโโโโโดโโโโโโโโโโโ
                    โ                     โ
                    โผ                     โผ
           โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ
           โ  Form Agent   โ    โ Action Agent  โ
           โ(ูููู ุงูููุงุฐุฌ) โ    โ(ูููู ุงูุฅุฌุฑุงุกุงุช)โ
           โโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโ
                    โ                     โ
                    โโโโโโโโโโโโฌโโโโโโโโโโโ
                               โ
                               โผ
                    โโโโโโโโโโโโโโโโโโโโโ
                    โ  Learning Agent   โ
                    โ  (ูููู ุงูุชุนูู)    โ
                    โโโโโโโโโโโโโโโโโโโโโ
```

### K1. ุงูููุณู ุงูุฑุฆูุณู (Coordinator Agent)

**ุงูุฏูุฑ:**
- ุงุณุชูุจุงู ุงูุฃุญุฏุงุซ ูู ูู ุงูููุฏูููุงุช
- ุชูุฌูู ุงูุฃุญุฏุงุซ ูููููู ุงูููุงุณุจ
- ุชูุณูู ุงูุนูู ุจูู ุงููููุงุก
- ุฅุฏุงุฑุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูููุงู

**ูุซุงู ุนูู ุณูุฑ ุงูุนูู:**
```python
# ุญุฏุซ ุฌุฏูุฏ: ูุตูู ุฅูููู
event = Event(type="new_email", data=email_data)

# ุงูููุณู ูุณุชูุจู ุงูุญุฏุซ
coordinator.handle_event(event)

# ุงูููุณู ููุฌู ูููููู ุงูููุงุณุจ
# 1. Email Agent ูุญูู ุงูุฅูููู
# 2. ุฅุฐุง ููุฌุฏุช ูููุฉ โ Task Agent
# 3. ุฅุฐุง ููุฌุฏ ููุนุฏ โ Calendar Agent
# 4. ุฅุฐุง ุทููุจ ุฅุฌุฑุงุก โ Form Agent + Action Agent
```

**ุงููููุงุช:**
- `core/ai/orchestration/coordinator_agent.py`
- `core/ai/orchestration/event_bus.py`
- `core/ai/orchestration/agent_registry.py`

### K2. ูููู ุงูููุงู (Task Agent)

**ุงููุฏุฑุงุช:**
- ุฅูุดุงุก ููุงู ูู ุงูุฅููููุงุช
- ุชุญุฏูุฏ ุฃููููุฉ ุงูููุงู
- ุงูุชุฑุงุญ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- ุงูุชุฑุงุญ ุงูุฅุฌุฑุงุก ุงูููุงุณุจ
- ุชุชุจุน ุงูููุงู ุงููุชุฃุฎุฑุฉ

**ุงููููุงุช:**
- `core/ai/agents/task_agent.py`

### K3. ูููู ุงูููุงุฐุฌ (Form Agent)

**ุงูุฏูุฑ:**
- ููู ููุน ุงููููุฉ (ุชุณููุฉ ุฅุฌุงุฒุฉุ ุชุณููุฉ ุฑุงุชุจุ ุฅูุฎ)
- ูุชุญ ุงููููุฐุฌ ุงูููุงุณุจ
- ููุก ุงูุญููู ุชููุงุฆูุงู ูู:
  - ุจูุงูุงุช ุงูุฅูููู
  - ุฌุฏุงูู ุงูููุธููู
  - ุฌุฏุงูู ุงูุฑูุงุชุจ
  - ุงูุฌุฏุงูู ุงููุฑุชุจุทุฉ

**ุณููุงุฑูู ุชุณููุฉ ุงูุฅุฌุงุฒุฉ:**
```python
# 1. ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ูู ุงูุฅูููู
employee_code = extract_employee_code(email_text)  # "EMP001"
vacation_type = extract_vacation_type(email_text)  # "ุณูููุฉ"
vacation_days = extract_days(email_text)           # 5

# 2. ุฌูุจ ุจูุงูุงุช ุงูููุธู
employee = db.query("SELECT * FROM employees WHERE employee_number = %s", employee_code)

# 3. ุฌูุจ ุนูุงุตุฑ ุงูุฑุงุชุจ
salary_elements = db.query("SELECT * FROM salary_elements WHERE employee_id = %s", employee.id)

# 4. ููุก ุงููููุฐุฌ
form_data = {
    "employee_id": employee.id,
    "employee_name": employee.name_ar,
    "department": employee.department.name,
    "vacation_type": vacation_type,
    "days": vacation_days,
    "basic_salary": salary_elements.basic,
    "housing_allowance": salary_elements.housing,
    # ... ุจุงูู ุงูุญููู
}

# 5. ุนุฑุถ ูููุณุชุฎุฏู ููุงุนุชูุงุฏ
show_settlement_form(form_data, editable=True)
```

**ุงููููุงุช:**
- `core/ai/agents/form_agent.py`
- `core/ai/agents/form_templates/` (ููุงูุจ ุงูููุงุฐุฌ)

### K4. ูููู ุงูุฅุฌุฑุงุกุงุช (Action Agent)

**ุงูุฏูุฑ:**
- ุชูููุฐ ุงูุฅุฌุฑุงุกุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุญูุธ ุจุนุฏ ุงูุงุนุชูุงุฏ
- ุฅุฑุณุงู ุงูุฑุฏูุฏ
- ุทุจุงุนุฉ ุงููุณุชูุฏุงุช

**ุงูุฅุฌุฑุงุกุงุช ุงููุฏุนููุฉ:**
```python
actions = {
    "save_settlement": save_vacation_settlement,
    "print_document": print_document,
    "send_email_reply": send_email_with_attachment,
    "update_employee": update_employee_record,
    "create_notification": create_system_notification,
}
```

**ุงููููุงุช:**
- `core/ai/agents/action_agent.py`
- `core/ai/agents/action_registry.py`

### K5. ูููู ุงูุชุนูู (Learning Agent)

**ุงูุฏูุฑ:**
- ุชุนูู ุฃููุงุท ุงููุณุชุฎุฏู
- ุชุญุณูู ุงูุชุฑุงุญุงุช AI ุจูุฑูุฑ ุงูููุช
- ุชุฐูุฑ ุงูุชูุถููุงุช

**ุฃูุซูุฉ ุนูู ุงูุชุนูู:**
- ุงููุณุชุฎุฏู ุฏุงุฆูุงู ูุนุฏู ุญูู X โ ุงูุชุฑุงุญ ูููุฉ ูุฎุชููุฉ
- ุงููุณุชุฎุฏู ููุถู ุงูููุงู ุตุจุงุญุงู โ ุฌุฏููุฉ ุงูููุงู ุตุจุงุญุงู
- ุงููุณุชุฎุฏู ูุฑูุถ ุงูุชุฑุงุญ Y โ ุชููู ุนู ุงูุชุฑุงุญู

**ุงููููุงุช:**
- `core/ai/agents/learning_agent.py`
- `core/ai/learning/user_preferences.py`
- `core/ai/learning/pattern_detector.py`

### K6. ูุญุฑู ุณูุฑ ุงูุนูู (Workflow Engine)

**ุงูุฏูุฑ:**
- ุชุนุฑูู ุณููุงุฑูููุงุช ุงูุนูู
- ุชูููุฐ ุฎุทูุงุช ุงูุณููุงุฑูู
- ุงูุชุนุงูู ูุน ุงููุฑูุน ูุงูุดุฑูุท

**ูุซุงู ุนูู ุณููุงุฑูู:**
```python
workflow = Workflow("vacation_settlement")
workflow.add_step(Step("analyze_email", email_agent.analyze))
workflow.add_step(Step("create_notification", notification_agent.create))
workflow.add_condition(Condition("user_creates_task",
    then=Step("create_task", task_agent.create),
    else_=Step("dismiss", notification_agent.dismiss)
))
workflow.add_step(Step("user_starts_task",
    then=Step("open_form", form_agent.open_settlement_form)
))
workflow.add_step(Step("fill_form", form_agent.auto_fill))
workflow.add_step(Step("user_approves",
    then=Step("save", action_agent.save_settlement)
))
workflow.add_step(Step("show_options", ["print", "reply_email"]))
```

**ุงููููุงุช:**
- `core/ai/workflow/workflow_engine.py`
- `core/ai/workflow/workflow_definitions/`
- `core/ai/workflow/step.py`
- `core/ai/workflow/condition.py`

---

## ุงููุญูุฑ L: ูุตูู ุงูุชูุงุฑูุฑ ูุงูููุงุฐุฌ (Report & Form Designer) โ

> **ุงูููููู:** ูุธุงู ุชุตููู ุชูุงุฑูุฑ ูููุงุฐุฌ ุงุญุชุฑุงูู ูุซู DevExpress ู Crystal Reports
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุชูู:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุฃููููุฉ:** ุงุญุชุฑุงูู - ุชุตููู ุญุฑ ููุชูุงุฑูุฑ ูุงูููุงุฐุฌ

### ุงูููููู ุงูุนุงู

ูุธุงู ูุชูุงูู ูุชุตููู ุงูุชูุงุฑูุฑ ูุงูููุงุฐุฌ ุจุญุฑูุฉ ุชุงูุฉ ูุน WYSIWYG editor.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ๐จ INTEGRA Designer Studio                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ๐ Report Designer    โ    ๐ Form Builder                 โ
โ  โโโโโโโโโโโโโโโโโ     โ    โโโโโโโโโโโโโโ                  โ
โ  โข ุชูุงุฑูุฑ PDF          โ    โข ููุงุฐุฌ ุฅุฏุฎุงู                   โ
โ  โข ูุดููุงุช Excel       โ    โข ุดุงุดุงุช ุนุฑุถ                    โ
โ  โข ุฎุทุงุจุงุช Word        โ    โข ููุงุฐุฌ ุทุจุงุนุฉ                   โ
โ  โข ููุงุชูุฑ             โ    โข ุงุณุชูุงุฑุงุช                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### L1. ูุญุฑู ุงูุชูุงุฑูุฑ (Report Engine)

**ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ:**
```python
# ุฅูุดุงุก PDF
from reportlab.lib import colors
from reportlab.lib.pagesizes import A4
from reportlab.platypus import SimpleDocTemplate, Table, Paragraph

# ููุงูุจ HTML
from jinja2 import Environment, FileSystemLoader

# ุชุญููู HTML ุฅูู PDF
from weasyprint import HTML, CSS

# Excel
from openpyxl import Workbook
from openpyxl.styles import Font, Alignment

# Word
from docx import Document
from docx.shared import Inches, Pt
```

**ุงููููุฒุงุช:**
- ุฅูุดุงุก ุชูุงุฑูุฑ PDF ุงุญุชุฑุงููุฉ
- ุฏุนู ุงูุฌุฏุงูู ูุงูุฑุณูู ุงูุจูุงููุฉ
- Header ู Footer ูุงุจูุฉ ููุชุฎุตูุต
- ุชุฑููู ุงูุตูุญุงุช ุชููุงุฆูุงู
- ุฏุนู RTL ูุงูุนุฑุจูุฉ
- ุชุตุฏูุฑ Excel ู Word

**ุงููููุงุช:**
- `core/reporting/report_engine.py`
- `core/reporting/pdf_generator.py`
- `core/reporting/excel_generator.py`
- `core/reporting/word_generator.py`

### L2. ูุตูู ุงูุชูุงุฑูุฑ ุงููุฑุฆู (Visual Report Designer)

**ุงููุงุฌูุฉ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ููู  ุชุญุฑูุฑ  ุนุฑุถ  ุฅุฏุฑุงุฌ  ุชูุณูู  ุฃุฏูุงุช  ูุณุงุนุฏุฉ                โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโค
โ ๐๏ธ ุงูุนูุงุตุฑ โ         ููุทูุฉ ุงูุชุตููู            โ  โ๏ธ ุงูุฎุตุงุฆุต   โ
โ            โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ               โ
โ ๐ ูุต      โ  โ     [Header]               โ  โ ุงูููุน: ูุต    โ
โ ๐ ุฌุฏูู    โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโ  โ  โ ุงูุฎุท: Cairo  โ
โ ๐ ุฑุณู     โ  โ                            โ  โ ุงูุญุฌู: 14    โ
โ ๐ผ๏ธ ุตูุฑุฉ    โ  โ     [ุชูุงุตูู ุงูุชูุฑูุฑ]       โ  โ ุงูููู: #000  โ
โ ๐ ุชุงุฑูุฎ   โ  โ                            โ  โ ุงููุญุงุฐุงุฉ: ููููโ
โ ๐ข ุฑูู     โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโ  โ  โ               โ
โ โ ุตูุบุฉ    โ  โ     [Footer]               โ  โ               โ
โ            โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ               โ
โโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโค
โ  ูุนุงููุฉ: [ุตูุญุฉ 1 ูู 5]    [โ] [โถ]    ุชูุจูุฑ: [100%]           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููููุฒุงุช:**
- ุณุญุจ ูุฅููุงุช ุงูุนูุงุตุฑ (Drag & Drop)
- ูุนุงููุฉ ูุจุงุดุฑุฉ (Live Preview)
- Bands: Header, Detail, Footer, Group Header/Footer
- ุชูุณูู ูุดุฑูุท (Conditional Formatting)
- ุตูุบ ูุญุณุงุจุงุช (SUM, AVG, COUNT, etc.)
- ูุชุบูุฑุงุช ุงููุธุงู (ุงูุชุงุฑูุฎุ ุฑูู ุงูุตูุญุฉุ ุงููุณุชุฎุฏู)

**ุงููููุงุช:**
- `modules/designer/report_designer/report_designer_window.py`
- `modules/designer/report_designer/design_canvas.py`
- `modules/designer/report_designer/element_palette.py`
- `modules/designer/report_designer/property_panel.py`
- `modules/designer/report_designer/preview_panel.py`

### L3. ููุดุฆ ุงูููุงุฐุฌ (Form Builder)

**ุงููุงุฌูุฉ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ููู  ุชุญุฑูุฑ  ุนุฑุถ  ุฅุฏุฑุงุฌ  ุชูุณูู  ุฃุฏูุงุช                        โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโค
โ ๐งฐ ุงูุฃุฏูุงุช โ         ููุทูุฉ ุงูุชุตููู            โ  โ๏ธ ุงูุฎุตุงุฆุต   โ
โ            โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ               โ
โ ๐ท๏ธ Label   โ  โ  ุงูุงุณู: [_______________]  โ  โ ุงูุญูู: name  โ
โ ๐ TextBox โ  โ                            โ  โ ูุทููุจ: โ     โ
โ ๐ข Number  โ  โ  ุงูุฑุงุชุจ: [_______________] โ  โ ุงูุญุฏ ุงูุฃุฏูู: 0โ
โ ๐ Date    โ  โ                            โ  โ               โ
โ โ๏ธ CheckBoxโ  โ  ุงููุณู: [โผ ุงุฎุชุฑ ุงููุณู    ]โ  โ               โ
โ ๐ Radio   โ  โ                            โ  โ               โ
โ ๐ ComboBoxโ  โ  [ุญูุธ]  [ุฅูุบุงุก]           โ  โ               โ
โ ๐ Grid    โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ               โ
โ ๐ผ๏ธ Image   โ                                   โ               โ
โโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโ
```

**ุงููููุฒุงุช:**
- ุชุตููู ููุงุฐุฌ ุจุงูุณุญุจ ูุงูุฅููุงุช
- ุฑุจุท ุงูุญููู ุจุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช (Validation Rules)
- ุชูุณูู ูุดุฑูุท ููุญููู
- ุฃุญุฏุงุซ (OnChange, OnValidate, OnSave)
- ุญูุธ ููุงูุจ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู

**ุงููููุงุช:**
- `modules/designer/form_builder/form_builder_window.py`
- `modules/designer/form_builder/form_canvas.py`
- `modules/designer/form_builder/widget_toolbox.py`
- `modules/designer/form_builder/property_editor.py`
- `modules/designer/form_builder/data_binding.py`

### L4. ูุญุฑู ุงูููุงูุจ (Template Engine)

**ููุงูุจ Jinja2:**
```html
<!-- templates/reports/employee_report.html -->
<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .header { text-align: center; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #000; padding: 8px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ report_title }}</h1>
        <p>ุงูุชุงุฑูุฎ: {{ current_date }}</p>
    </div>

    <table>
        <thead>
            <tr>
                <th>ุงูุงุณู</th>
                <th>ุงููุณู</th>
                <th>ุงูุฑุงุชุจ</th>
            </tr>
        </thead>
        <tbody>
            {% for emp in employees %}
            <tr>
                <td>{{ emp.name_ar }}</td>
                <td>{{ emp.department.name }}</td>
                <td>{{ emp.salary | format_currency }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="footer">
        <p>ุงูุฅุฌูุงูู: {{ total | format_currency }}</p>
    </div>
</body>
</html>
```

**ุงููููุงุช:**
- `core/reporting/template_engine.py`
- `core/reporting/templates/` (ูุฌูุฏ ุงูููุงูุจ)
- `core/reporting/filters.py` (ููุงุชุฑ Jinja2 ูุฎุตุตุฉ)

### L5. ุฑุจุท ุงูุจูุงูุงุช (Data Binding)

**ุทุฑููุฉ ุงูุฑุจุท:**
```python
# ุชุนุฑูู ูุตุฏุฑ ุงูุจูุงูุงุช
data_source = DataSource(
    name="employees",
    query="SELECT * FROM employees WHERE department_id = :dept_id",
    parameters={"dept_id": 1}
)

# ุฑุจุท ุงูุชูุฑูุฑ ุจูุตุฏุฑ ุงูุจูุงูุงุช
report.bind_data_source(data_source)

# ุฑุจุท ุญูู ุจุนููุฏ
report.bind_field("employee_name", "employees.name_ar")
report.bind_field("salary", "employees.salary", format="currency")

# ุตูุบ ูุญุณูุจุฉ
report.add_calculated_field(
    name="net_salary",
    formula="salary - deductions",
    format="currency"
)
```

**ุงููููุงุช:**
- `core/reporting/data_binding.py`
- `core/reporting/data_source.py`
- `core/reporting/calculated_fields.py`

### L6. ูุนุงููุฉ ูุทุจุงุนุฉ (Preview & Print)

**ุงููููุฒุงุช:**
- ูุนุงููุฉ ูุจู ุงูุทุจุงุนุฉ
- ุชูุจูุฑ/ุชุตุบูุฑ
- ุงูุชููู ุจูู ุงูุตูุญุงุช
- ุทุจุงุนุฉ ูุจุงุดุฑุฉ
- ุชุตุฏูุฑ PDF/Excel/Word
- ุฅุฑุณุงู ุจุงูุฅูููู ูุจุงุดุฑุฉ

**ุงููููุงุช:**
- `modules/designer/preview/print_preview.py`
- `modules/designer/preview/export_dialog.py`

### L7. ููุงูุจ ุฌุงูุฒุฉ (Built-in Templates)

**ููุงูุจ ุงูุชูุงุฑูุฑ:**
- ุชูุฑูุฑ ููุธููู
- ูุดู ุฑูุงุชุจ
- ุชุณููุฉ ุฅุฌุงุฒุฉ
- ุฎุทุงุจ ุชุนุฑูู
- ุดูุงุฏุฉ ุฎุจุฑุฉ
- ูุงุชูุฑุฉ
- ุฅูุตุงู ุงุณุชูุงู

**ููุงูุจ ุงูููุงุฐุฌ:**
- ูููุฐุฌ ุจูุงูุงุช ููุธู
- ูููุฐุฌ ุทูุจ ุฅุฌุงุฒุฉ
- ูููุฐุฌ ุชูููู ุฃุฏุงุก
- ูููุฐุฌ ูุตุฑููุงุช

**ุงููููุงุช:**
- `core/reporting/templates/reports/`
- `core/reporting/templates/forms/`
- `core/reporting/template_manager.py`

### L8. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
L1 โ Report Engine (ูุญุฑู ุงูุชูุงุฑูุฑ) - ReportLab + WeasyPrint
L2 โ Visual Report Designer (ุงููุตูู ุงููุฑุฆู) - PyQt5 Canvas
L3 โ Form Builder (ููุดุฆ ุงูููุงุฐุฌ) - Drag & Drop
L4 โ Template Engine (ูุญุฑู ุงูููุงูุจ) - Jinja2
L5 โ Data Binding (ุฑุจุท ุงูุจูุงูุงุช) - Dynamic Queries
L6 โ Preview & Print (ูุนุงููุฉ ูุทุจุงุนุฉ)
L7 โ Built-in Templates (ููุงูุจ ุฌุงูุฒุฉ)
```

---

## ุงููุญูุฑ M: ุงูุฑุจุท ูุน Power BI Desktop (BI Connector) ๐

> **ุงูููููู:** ุชูุงูู ูุจุงุดุฑ ูุน Power BI Desktop ุจุฏูู ุชุฑุงุฎูุต Microsoft
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุฃููููุฉ:** ุชุญูููู - ุชุญูููุงุช ูุชูุฏูุฉ ูููุญุงุช ุชุญูู ุงุญุชุฑุงููุฉ

### ุงูููููู ุงูุนุงู

Power BI Desktop ูุฌุงูู ุชูุงูุงู ูููููู ุงูุงุชุตุงู ูุจุงุดุฑุฉ ุจู PostgreSQL.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ๐ INTEGRA BI Integration                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  โโโโโโโโโโโโโโโโ    Direct    โโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ  PostgreSQL   โ โโโโโโโโโโโ โ   Power BI Desktop       โ     โ
โ  โ   Database    โ  Connection โ   (ูุฌุงูู 100%)           โ     โ
โ  โโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ         โ                                โ                       โ
โ         โผ                                โผ                       โ
โ  โโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ  BI Views    โ             โ   Pre-built Dashboards   โ     โ
โ  โ  (ูุญุณููุฉ)    โ             โ   (ููุงูุจ ุฌุงูุฒุฉ .pbix)    โ     โ
โ  โโโโโโโโโโโโโโโโ             โโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ                                                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ููุงุฐุง Power BI Desktopุ

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| **ูุฌุงูู 100%** | ูุง ูุญุชุงุฌ ุชุฑุฎูุต ููุงุณุชุฎุฏุงู ุงููุญูู |
| **ุงุชุตุงู ูุจุงุดุฑ** | PostgreSQL connector ูุฏูุฌ |
| **ุชุญุฏูุซ ุชููุงุฆู** | Scheduled Refresh ูุญููุงู |
| **ููุงูุจ ูุงุจูุฉ ูููุดุงุฑูุฉ** | ูููุงุช .pbix ูููู ุชูุฒูุนูุง |
| **ุฑุณูู ุจูุงููุฉ ูุชูุฏูุฉ** | ุฃููู ูู ุฃู ุญู ูุจูู ูุญููุงู |

### M1. ุฅุนุฏุงุฏ ุงูุงุชุตุงู (Connection Setup)

**ุฎุทูุงุช ุงูุฅุนุฏุงุฏ:**
```
1. Power BI Desktop โ Get Data โ PostgreSQL
2. Server: localhost (ุฃู IP ุงูุณูุฑูุฑ)
3. Database: integra
4. Data Connectivity Mode: DirectQuery ุฃู Import
5. Authentication: Database credentials
```

**ููู ุงูุฅุนุฏุงุฏ:**
```python
# core/bi/connection_config.py

BI_CONNECTION_CONFIG = {
    "server": "localhost",
    "port": 5432,
    "database": "integra",
    "schema": "public",
    "bi_schema": "bi_views"  # Schema ุฎุงุต ุจู Views ุงูุชุญููููุฉ
}
```

**ุงููููุงุช:**
- `core/bi/__init__.py`
- `core/bi/connection_config.py`
- `docs/power_bi_setup.md` (ุฏููู ุงูุฅุนุฏุงุฏ)

### M2. BI Views (ุนุฑูุถ ุชุญููููุฉ ูุญุณููุฉ)

**Views ูุตููุฉ ููุชุญูููุงุช:**
```sql
-- SQL: bi_views/bi_employees_summary.sql

CREATE SCHEMA IF NOT EXISTS bi_views;

-- View: ููุฎุต ุงูููุธููู
CREATE OR REPLACE VIEW bi_views.employees_summary AS
SELECT
    e.id,
    e.name_ar,
    e.name_en,
    c.name_ar AS company_name,
    d.name_ar AS department_name,
    j.name_ar AS job_title,
    es.name_ar AS status,
    e.hire_date,
    e.salary,
    e.created_at,
    DATE_PART('year', AGE(NOW(), e.hire_date)) AS years_of_service,
    CASE
        WHEN e.status_id = 1 THEN 'ูุดุท'
        WHEN e.status_id = 2 THEN 'ููุชูู'
        ELSE 'ุบูุฑ ูุญุฏุฏ'
    END AS status_label
FROM employees e
LEFT JOIN companies c ON e.company_id = c.id
LEFT JOIN departments d ON e.department_id = d.id
LEFT JOIN job_titles j ON e.job_title_id = j.id
LEFT JOIN employee_statuses es ON e.status_id = es.id;

-- View: ุฅุญุตุงุฆูุงุช ุงูุฃูุณุงู
CREATE OR REPLACE VIEW bi_views.department_stats AS
SELECT
    d.id AS department_id,
    d.name_ar AS department_name,
    COUNT(e.id) AS employee_count,
    AVG(e.salary) AS avg_salary,
    SUM(e.salary) AS total_salaries,
    MIN(e.hire_date) AS oldest_hire,
    MAX(e.hire_date) AS newest_hire
FROM departments d
LEFT JOIN employees e ON e.department_id = d.id
GROUP BY d.id, d.name_ar;

-- View: ุงูููุงู ูุงูุฅูุชุงุฌูุฉ (ุจุนุฏ ุชูููุฐ Track H)
CREATE OR REPLACE VIEW bi_views.tasks_productivity AS
SELECT
    DATE(t.created_at) AS task_date,
    e.name_ar AS assigned_to,
    t.status,
    COUNT(*) AS task_count,
    SUM(CASE WHEN t.status = 'completed' THEN 1 ELSE 0 END) AS completed_count
FROM tasks t
LEFT JOIN employees e ON t.employee_id = e.id
GROUP BY DATE(t.created_at), e.name_ar, t.status;
```

**ุงููููุงุช:**
- `core/bi/sql/bi_employees_summary.sql`
- `core/bi/sql/bi_department_stats.sql`
- `core/bi/sql/bi_tasks_productivity.sql`
- `core/bi/sql/bi_payroll_analysis.sql`
- `core/bi/views_manager.py`

### M3. ุชุตุฏูุฑ ุงูุจูุงูุงุช ุงูุชููุงุฆู (Auto Export)

**ุชุตุฏูุฑ ููุชุญููู:**
```python
# core/bi/data_exporter.py

class BIDataExporter:
    """ุชุตุฏูุฑ ุงูุจูุงูุงุช ุจุตูุบ ูุชุนุฏุฏุฉ ูู Power BI"""

    def export_to_csv(self, view_name: str, output_path: str):
        """ุชุตุฏูุฑ View ุฅูู CSV"""
        query = f"SELECT * FROM bi_views.{view_name}"
        df = pd.read_sql(query, connection)
        df.to_csv(output_path, index=False, encoding='utf-8-sig')

    def export_to_excel(self, views: list, output_path: str):
        """ุชุตุฏูุฑ ุนุฏุฉ Views ุฅูู Excel (ูู View ูู sheet)"""
        with pd.ExcelWriter(output_path) as writer:
            for view in views:
                df = pd.read_sql(f"SELECT * FROM bi_views.{view}", connection)
                df.to_excel(writer, sheet_name=view, index=False)

    def schedule_export(self, frequency: str = "daily"):
        """ุฌุฏููุฉ ุงูุชุตุฏูุฑ ุงูุชููุงุฆู"""
        # ุชูุงูู ูุน APScheduler
        pass
```

**ุงููููุงุช:**
- `core/bi/data_exporter.py`
- `core/bi/export_scheduler.py`

### M4. ููุงูุจ Power BI ุฌุงูุฒุฉ (Pre-built Templates)

**ููุงูุจ .pbix ุฌุงูุฒุฉ:**
```
templates/power_bi/
โโโ employees_dashboard.pbix      # ููุญุฉ ุชุญูู ุงูููุธููู
โโโ payroll_analysis.pbix        # ุชุญููู ุงูุฑูุงุชุจ
โโโ department_overview.pbix     # ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุฃูุณุงู
โโโ tasks_productivity.pbix      # ุฅูุชุงุฌูุฉ ุงูููุงู
โโโ attendance_report.pbix       # ุชูุฑูุฑ ุงูุญุถูุฑ
โโโ executive_summary.pbix       # ููุฎุต ุชูููุฐู
```

**ูุญุชููุงุช ูู ูุงูุจ:**
- ุงุชุตุงู PostgreSQL ููุนุฏ ูุณุจูุงู
- ุฑุณูู ุจูุงููุฉ ุฌุงูุฒุฉ
- ููุงุชุฑ ูSlicers
- ุชูุณูู ุนุฑุจู RTL
- ุฃููุงู ูุชูุงููุฉ ูุน INTEGRA

**ุงููููุงุช:**
- `templates/power_bi/` (ูุฌูุฏ ุงูููุงูุจ)
- `core/bi/template_manager.py`

### M5. ูุงุฌูุฉ ุฅุฏุงุฑุฉ BI (BI Management UI)

**ุดุงุดุฉ ุฅุนุฏุงุฏุงุช BI:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   โ๏ธ ุฅุนุฏุงุฏุงุช Power BI                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ  ๐ ุญุงูุฉ ุงูุงุชุตุงู: โ ูุชุตู                                       โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ุชุตุฏูุฑ ุงูุจูุงูุงุช                                          โ   โ
โ  โ โโโโโโโโโโโโโโโโโ                                        โ   โ
โ  โ โ๏ธ ุชุตุฏูุฑ ูููู ุชููุงุฆู                                     โ   โ
โ  โ ๐ ูุฌูุฏ ุงูุชุตุฏูุฑ: [C:\BI_Data\integra]         [ุชุบููุฑ]   โ   โ
โ  โ ๐ ููุช ุงูุชุตุฏูุฑ: [06:00]                                  โ   โ
โ  โ                                                          โ   โ
โ  โ [ุชุตุฏูุฑ ุงูุขู]                                             โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ุงูููุงูุจ ุงููุชุงุญุฉ                                          โ   โ
โ  โ โโโโโโโโโโโโโ                                            โ   โ
โ  โ ๐ ููุญุฉ ุชุญูู ุงูููุธููู     [ูุชุญ] [ุชุญููู]                 โ   โ
โ  โ ๐ฐ ุชุญููู ุงูุฑูุงุชุจ          [ูุชุญ] [ุชุญููู]                 โ   โ
โ  โ ๐ข ูุธุฑุฉ ุนุงูุฉ ุงูุฃูุณุงู      [ูุชุญ] [ุชุญููู]                 โ   โ
โ  โ โ ุฅูุชุงุฌูุฉ ุงูููุงู         [ูุชุญ] [ุชุญููู]                 โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ๐ ุฏููู ุงูุฅุนุฏุงุฏ                                          โ   โ
โ  โ 1. ูู ุจุชุซุจูุช Power BI Desktop (ูุฌุงูู)                   โ   โ
โ  โ 2. ุงูุชุญ ุฃู ูุงูุจ ูู ุงูููุงูุจ ุฃุนูุงู                        โ   โ
โ  โ 3. ุฃุฏุฎู ุจูุงูุงุช ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช                  โ   โ
โ  โ [ุนุฑุถ ุงูุฏููู ุงููุงูู]                                      โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                                 โ
โ                              [ุญูุธ ุงูุฅุนุฏุงุฏุงุช]    [ุฅุบูุงู]        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููููุงุช:**
- `ui/dialogs/bi_settings/bi_settings_dialog.py`
- `ui/dialogs/bi_settings/export_panel.py`
- `ui/dialogs/bi_settings/templates_panel.py`

### M6. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
M1 โ Connection Setup (ุฅุนุฏุงุฏ ุงูุงุชุตุงู) - ุชูุซูู + config
M2 โ BI Views (ุนุฑูุถ ุชุญููููุฉ) - SQL Views ูุญุณููุฉ
M3 โ Auto Export (ุชุตุฏูุฑ ุชููุงุฆู) - CSV/Excel ููุชุญุฏูุซ
M4 โ Pre-built Templates (ููุงูุจ ุฌุงูุฒุฉ) - ูููุงุช .pbix
M5 โ BI Management UI (ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ) - ุฅุนุฏุงุฏุงุช ูุชุตุฏูุฑ
M6 โ Documentation (ุงูุชูุซูู) - ุฏููู ุงููุณุชุฎุฏู
```

---

## ุงููุญูุฑ N: ุงููุณุงุนุฏ ุงูุฐูู ุงููุชูุงูู (INTEGRA AI Copilot) โ **ููุชูู**

> **ุงูููููู:** ูุณุงุนุฏ ุฐูู ูุนุฑู ูู ุดูุก ุนู ุงูุจุฑูุงูุฌ ูุงูุจูุงูุงุช ูุซู NotebookLM
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุญุงูุฉ:** โ ููุชูู ุจุงููุงูู (26 ููู Python ูู modules/copilot/)
> **ุงูุฃููููุฉ:** ุงุณุชุฑุงุชูุฌู - ุงูุนูู ุงููุฏุจุฑ ููุจุฑูุงูุฌ

### ุงูููููู ุงูุนุงู

ูุณุงุนุฏ ุฐูู ูุชูุงูู ูููู ุงูุจุฑูุงูุฌ ุจุงููุงูู ููุณุชุทูุน ุงูุงุณุชุนูุงู ูุงูุชุญููู ูุงูุชูููุฐ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ๐ค INTEGRA AI Copilot                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  ๐ Knowledge Layer (ูุนุฑู ูู ุดูุก)                               โ
โ  โโโ Database Schema (ุงูุฌุฏุงูู ูุงูุนูุงูุงุช)                        โ
โ  โโโ Live Data (ุงูุจูุงูุงุช ุงููุนููุฉ)                               โ
โ  โโโ UI Components (ุงูุดุงุดุงุช ูุงูููุงุฐุฌ)                           โ
โ  โโโ Business Rules (ููุงุนุฏ ุงูุนูู)                               โ
โ                                                                  โ
โ  ๐ฌ Chat Interface (NotebookLM Style)                           โ
โ  โโโ Sidebar (ุดุฑูุท ุฌุงูุจู ุฏุงุฆู)                                  โ
โ  โโโ Popup Window (ูุงูุฐุฉ ูููุตูุฉ)                                โ
โ                                                                  โ
โ  โก Action Levels (ูุณุชููุงุช ุงูุฅุฌุฑุงุกุงุช)                           โ
โ  โโโ ๐ข Level 0: ูุฑุงุกุฉ ููุท (ุงุณุชุนูุงูุงุช) - ููุฑู                   โ
โ  โโโ ๐ก Level 1: ุชููุงุฆู (low risk) + ุฅุดุนุงุฑ                      โ
โ  โโโ ๐ Level 2: ุจุทูุจ (ุฒุฑุงุฑ/ุฃูุฑ ุตูุชู)                           โ
โ  โโโ ๐ด Level 3: ูุณูุฏุฉ (ูููุฐ โ ุงุนุชูุงุฏ/ุฑูุถ/ุชุนุฏูู)                โ
โ                                                                  โ
โ  ๐ Approval Workflow                                            โ
โ  โโโ โ ุงุนุชูุงุฏ โ ูุญูุธ ุงูุชุบููุฑุงุช                                  โ
โ  โโโ โ ุฑูุถ โ ูุญุฐู ูุง ุนููู AI                                    โ
โ  โโโ โ๏ธ ุชุนุฏูู โ ููุชุญ ููุชุนุฏูู ุซู ุงุนุชูุงุฏ                          โ
โ                                                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ููุงุฐุง AI Copilotุ

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| **ูุนุฑูุฉ ุดุงููุฉ** | AI ูุนุฑู ูู ุงูุฌุฏุงูู ูุงูุจูุงูุงุช ูุงูุดุงุดุงุช |
| **ุงุณุชุนูุงู ุทุจูุนู** | ุงุณุฃู ุจุงูุนุฑุจู ูุงุญุตู ุนูู ุฅุฌุงุจุฉ ููุฑูุฉ |
| **ุชุญููู ุฐูู** | ุนูููุงุช ุญุณุงุจูุฉ ูููุทููุฉ ูุงุณุชุฏูุงููุฉ |
| **ุชูููุฐ ุขูู** | ูุณุชููุงุช ุฃูุงู ูุน ุงุนุชูุงุฏ/ุฑูุถ/ุชุนุฏูู |
| **ุณูุงู ูุงุนู** | ูุนุฑู ุฃูู ุฃูุช ูู ุงูุจุฑูุงูุฌ |
| **ุชุนูู ูุณุชูุฑ** | ูุชุนูู ูู ุชูุถููุงุชู ูุชุตุฑูุงุชู |

### N1. ูุญุฑู ุงููุนุฑูุฉ (Knowledge Engine)

**ุงูููููุงุช:**
```python
# core/ai/copilot/knowledge_engine.py

class KnowledgeEngine:
    """ูุญุฑู ุงููุนุฑูุฉ ุงูุดุงููุฉ"""

    def __init__(self):
        self.schema_knowledge = SchemaKnowledge()    # ูุนุฑูุฉ ุงูุฌุฏุงูู
        self.data_knowledge = DataKnowledge()        # ูุนุฑูุฉ ุงูุจูุงูุงุช
        self.ui_knowledge = UIKnowledge()            # ูุนุฑูุฉ ุงูุดุงุดุงุช
        self.business_rules = BusinessRules()        # ููุงุนุฏ ุงูุนูู

    def query(self, question: str) -> str:
        """ุงุณุชุนูุงู ุจูุบุฉ ุทุจูุนูุฉ"""
        pass

    def get_context(self) -> dict:
        """ุงูุญุตูู ุนูู ุงูุณูุงู ุงูุญุงูู"""
        return {
            "current_screen": self.get_current_screen(),
            "current_record": self.get_current_record(),
            "recent_actions": self.get_recent_actions(limit=10)
        }
```

**Schema Knowledge:**
```python
# ูุนุฑูุฉ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
schema_info = {
    "employees": {
        "columns": ["id", "name_ar", "name_en", "salary", "department_id", ...],
        "relationships": {
            "department": "departments.id",
            "company": "companies.id"
        },
        "description": "ุฌุฏูู ุงูููุธููู ุงูุฑุฆูุณู"
    },
    ...
}
```

**ุงููููุงุช:**
- `core/ai/copilot/__init__.py`
- `core/ai/copilot/knowledge_engine.py`
- `core/ai/copilot/schema_knowledge.py`
- `core/ai/copilot/data_knowledge.py`
- `core/ai/copilot/ui_knowledge.py`
- `core/ai/copilot/business_rules.py`

### N2. ูุงุฌูุฉ ุงููุญุงุฏุซุฉ (Chat Interface)

**Sidebar + Popup Window:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ INTEGRA                                               [๐ค] [โ][โก][ร] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโค
โ                                                        โ ๐ฌ AI Copilot   โ
โ                                                        โโโโโโโโโโโโโโโโโโโค
โ                                                        โ                 โ
โ              [ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ]                         โ ๐ค ูู ููุธู ูู   โ
โ                                                        โ    ูุณู ITุ      โ
โ                                                        โ                 โ
โ                                                        โ ๐ค ููุฌุฏ 12 ููุธู โ
โ                                                        โ    โโโ 8 ูุดุทูู  โ
โ                                                        โ    โโโ 3 ุฅุฌุงุฒุฉ  โ
โ                                                        โ    โโโ 1 ููุชูู  โ
โ                                                        โ                 โ
โ                                                        โ ๐ค ูุชูุณุท ุฑูุงุชุจููโ
โ                                                        โ                 โ
โ                                                        โ ๐ค 8,500 ุฑูุงู   โ
โ                                                        โ    [๐] [๐]    โ
โ                                                        โ                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโค
โ  [Tabs/Navigation]                                     โ [ุงูุชุจ ุณุคุงูู...] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโ
```

**NotebookLM Style Features:**
- ุงุณุชุนูุงูุงุช ุจูุบุฉ ุทุจูุนูุฉ
- ุนูููุงุช ุญุณุงุจูุฉ (ูุฌููุนุ ูุชูุณุทุ ูุณุจุ ููุงุฑูุงุช)
- ุนูููุงุช ููุทููุฉ (ููุชุฑุฉุ ุชุฑุชูุจุ ุชุฌููุน)
- ุนูููุงุช ุงุณุชุฏูุงููุฉ (ุชููุนุงุชุ ุฃููุงุทุ ุดุฐูุฐ)
- ุชุตุฏูุฑ ุงููุชุงุฆุฌ (ุฌุฏููุ ุฑุณู ุจูุงููุ Excel)

**ุฃูุซูุฉ ุงูุงุณุชุนูุงูุงุช:**
```
๐ค "ูู ููุธู ูุดุท ูู ุงูุดุฑูุฉุ"
๐ค "ููุฌุฏ 150 ููุธู ูุดุท ูู ุฅุฌูุงูู 180 ููุธู (83%)"

๐ค "ููู ุงูููุธููู ุงููู ุฑุงุชุจูู ููู 10,000ุ"
๐ค "23 ููุธู ุฑุงุชุจูู ููู 10,000:
    1. ุฃุญูุฏ ูุญูุฏ - 15,000 - ุงูุฅุฏุงุฑุฉ
    2. ุณุงุฑุฉ ุฃุญูุฏ - 12,500 - ุงููุงููุฉ
    ..."
    [๐ ุนุฑุถ ูุฌุฏูู] [๐ ุฑุณู ุจูุงูู] [๐ ุชุตุฏูุฑ Excel]

๐ค "ุงุญุณุจ ุฅุฌูุงูู ุฑูุงุชุจ ูุณู ุงููุจูุนุงุช"
๐ค "ุฅุฌูุงูู ุฑูุงุชุจ ูุณู ุงููุจูุนุงุช = 85,000 ุฑูุงู
    - ุนุฏุฏ ุงูููุธููู: 12
    - ุงููุชูุณุท: 7,083 ุฑูุงู
    - ุงูุฃุนูู: 12,000 ุฑูุงู
    - ุงูุฃุฏูู: 4,500 ุฑูุงู"

๐ค "ูุงุฑู ุฑูุงุชุจ ูุฐุง ุงูุดูุฑ ุจุงูุดูุฑ ุงููุงุถู"
๐ค "ููุงุฑูุฉ ุงูุฑูุงุชุจ:
    ุงูุดูุฑ ุงูุญุงูู: 450,000 ุฑูุงู
    ุงูุดูุฑ ุงููุงุถู: 440,000 ุฑูุงู
    ุงููุฑู: +10,000 ุฑูุงู (+2.3%)
    ุงูุณุจุจ: ุชูุธูู 3 ููุธููู ุฌุฏุฏ"
```

**ุงููููุงุช:**
- `ui/components/ai/copilot_sidebar.py`
- `ui/components/ai/copilot_window.py`
- `ui/components/ai/chat_message.py`
- `ui/components/ai/result_viewer.py`

### N3. ุงููุนู ุจุงูุณูุงู (Context Awareness)

**ูุง ูุนุฑูู AI:**
```python
context = {
    "current_screen": "employee_profile",
    "current_record": {
        "id": 123,
        "name": "ุฃุญูุฏ ูุญูุฏ",
        "department": "ุงููุจูุนุงุช"
    },
    "recent_actions": [
        {"action": "view", "table": "employees", "id": 123},
        {"action": "edit", "table": "employees", "id": 120},
        ...
    ],
    "user": {
        "name": "ูุญูุฏ",
        "role": "HR",
        "preferences": {...}
    },
    "time": "2026-02-04 14:30:00"
}
```

**ุงุณุชุฎุฏุงู ุงูุณูุงู:**
```
# ุงููุณุชุฎุฏู ูู ุดุงุดุฉ ููุธู ูุนูู
๐ค "ุฒููุฏ ุฑุงุชุจู 10%"
๐ค "ุชุฑูุฏ ุฒูุงุฏุฉ ุฑุงุชุจ ุฃุญูุฏ ูุญูุฏ ูู 8,000 ุฅูู 8,800ุ
    [โ ุงุนุชูุงุฏ] [โ ุฑูุถ] [โ๏ธ ุชุนุฏูู]"
```

**ุงููููุงุช:**
- `core/ai/copilot/context_manager.py`
- `core/ai/copilot/action_history.py`

### N4. ุจูุฆุฉ ุงููุณูุฏุงุช (Action Sandbox)

**ููู ุชุนูู:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ๐ด Level 3 Action Flow                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                          โ
โ  ๐ค ุงููุณุชุฎุฏู: "ุฃุถู ููุธู ุฌุฏูุฏ ุงุณูู ุณุนูุฏ"                 โ
โ                    โ                                     โ
โ  ๐ค AI ูุฌูุฒ ุงูุจูุงูุงุช ูู Sandbox (ูุง ุชูุญูุธ ุจุนุฏ)          โ
โ                    โ                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ ๐ ูุนุงููุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ                         โ โ
โ  โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโ                       โ โ
โ  โ ุงูุงุณู: ุณุนูุฏ                                        โ โ
โ  โ ุงูุฑูู ุงููุธููู: (ููููุฏ ุชููุงุฆูุงู)                    โ โ
โ  โ ุงููุณู: (ุบูุฑ ูุญุฏุฏ)                                  โ โ
โ  โ ุงูุฑุงุชุจ: (ุบูุฑ ูุญุฏุฏ)                                 โ โ
โ  โ                                                    โ โ
โ  โ โ๏ธ ุจูุงูุงุช ูุงูุตุฉ - ูู ุชุฑูุฏ ุฅููุงููุงุ                 โ โ
โ  โ                                                    โ โ
โ  โ [โ ุงุนุชูุงุฏ] [โ ุฑูุถ] [โ๏ธ ุชุนุฏูู ูุฅููุงู]              โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                    โ                                     โ
โ  โ๏ธ ุงููุณุชุฎุฏู ูุฎุชุงุฑ "ุชุนุฏูู" โ ููุชุญ ูููุฐุฌ ุงูุฅุถุงูุฉ         โ
โ                    โ                                     โ
โ  โ ุงููุณุชุฎุฏู ูููู ููุถุบุท "ุงุนุชูุงุฏ" โ ููุญูุธ                 โ
โ                                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**Draft Recovery:**
```python
# ุงููุณูุฏุงุช ุชุจูู ูุญููุธุฉ ุญุชู ุจุนุฏ ุฅุบูุงู ุงูุจุฑูุงูุฌ
drafts = [
    {
        "id": "draft_001",
        "type": "add_employee",
        "data": {"name": "ุณุนูุฏ", ...},
        "created_at": "2026-02-04 14:30:00",
        "expires_at": "2026-02-05 14:30:00"  # 24 ุณุงุนุฉ
    }
]
```

**ุงููููุงุช:**
- `core/ai/copilot/action_sandbox.py`
- `core/ai/copilot/draft_manager.py`
- `core/ai/copilot/draft_storage.py`

### N5. ุณูุฑ ุงูููุงููุงุช (Approval Workflow)

**ูุณุชููุงุช ุงูุฅุฌุฑุงุกุงุช:**
```python
class ActionLevel(Enum):
    READ_ONLY = 0      # ๐ข ูุฑุงุกุฉ ููุท - ููุฑู ุจุฏูู ุชุฃููุฏ
    AUTO_EXECUTE = 1   # ๐ก ุชููุงุฆู - ูููุฐ + ุฅุดุนุงุฑ
    ON_REQUEST = 2     # ๐ ุจุทูุจ - ูููุฐ ุนูุฏ ุงูุฃูุฑ
    DRAFT_MODE = 3     # ๐ด ูุณูุฏุฉ - ุงุนุชูุงุฏ/ุฑูุถ/ุชุนุฏูู

# ุชุตููู ุงูุฅุฌุฑุงุกุงุช
ACTION_LEVELS = {
    # Level 0: ูุฑุงุกุฉ
    "query_data": ActionLevel.READ_ONLY,
    "calculate": ActionLevel.READ_ONLY,
    "search": ActionLevel.READ_ONLY,

    # Level 1: ุชููุงุฆู
    "classify_email": ActionLevel.AUTO_EXECUTE,
    "create_notification": ActionLevel.AUTO_EXECUTE,
    "suggest_priority": ActionLevel.AUTO_EXECUTE,

    # Level 2: ุจุทูุจ
    "open_form": ActionLevel.ON_REQUEST,
    "fill_form": ActionLevel.ON_REQUEST,
    "generate_report": ActionLevel.ON_REQUEST,

    # Level 3: ูุณูุฏุฉ
    "add_employee": ActionLevel.DRAFT_MODE,
    "edit_salary": ActionLevel.DRAFT_MODE,
    "delete_record": ActionLevel.DRAFT_MODE,
    "approve_request": ActionLevel.DRAFT_MODE,
}
```

**Approval Dialog:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ๏ธ ุฅุฌุฑุงุก ูุญุชุงุฌ ููุงููุฉ                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                         โ
โ  ๐ ููุน ุงูุฅุฌุฑุงุก: ุชุนุฏูู ุฑุงุชุจ                             โ
โ  ๐ค ุงูููุธู: ุฃุญูุฏ ูุญูุฏ                                   โ
โ                                                         โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ ุงููููุฉ ุงูุญุงููุฉ     โ     ุงููููุฉ ุงูุฌุฏูุฏุฉ          โ โ
โ  โ 8,000 ุฑูุงู         โ     8,800 ุฑูุงู              โ โ
โ  โ                     (+10%)                        โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                                         โ
โ  โโโโโโโโโโโ  โโโโโโโโโโโ  โโโโโโโโโโโ                โ
โ  โ โ ุงุนุชูุงุฏ โ  โ โ ุฑูุถ  โ  โ โ๏ธ ุชุนุฏูู โ                โ
โ  โโโโโโโโโโโ  โโโโโโโโโโโ  โโโโโโโโโโโ                โ
โ                                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููููุงุช:**
- `core/ai/copilot/approval_workflow.py`
- `core/ai/copilot/action_classifier.py`
- `ui/dialogs/ai/approval_dialog.py`

### N6. ูุธุงู ุงูุชุนูู (Learning System)

**Hybrid Learning:**
```python
# Global: ูุนุฑูุฉ ูุดุชุฑูุฉ ููู ุงููุณุชุฎุฏููู
global_knowledge = {
    "business_rules": [...],
    "common_queries": [...],
    "best_practices": [...]
}

# Per-User: ุชูุถููุงุช ุดุฎุตูุฉ ููู ูุณุชุฎุฏู
user_preferences = {
    "user_123": {
        "preferred_format": "table",    # ููุถู ุงูุฌุฏุงูู
        "auto_approve": ["notifications"],  # ููุงูู ุชููุงุฆูุงู ุนูู ุงูุฅุดุนุงุฑุงุช
        "rejected_suggestions": [...],   # ุงูุชุฑุงุญุงุช ุฑูุถูุง
        "common_tasks": [...]            # ููุงู ูุชูุฑุฑุฉ
    }
}
```

**Learning Signals:**
```python
def learn_from_action(action, result):
    if result == "approved":
        # ุชุนุฒูุฒ ูุฐุง ุงูุณููู
        reinforce(action)
    elif result == "rejected":
        # ุชูููู ุงุญุชูุงููุฉ ุงูุงูุชุฑุงุญ
        decrease_probability(action)
    elif result == "modified":
        # ุชุนูู ูู ุงูุชุนุฏูู
        learn_modification(action, modified_version)
```

**ุงููููุงุช:**
- `core/ai/copilot/learning_system.py`
- `core/ai/copilot/user_preferences.py`
- `core/ai/copilot/global_knowledge.py`

### N7. ุงูุณุฌู ูุงูุชุงุฑูุฎ (Audit & History)

**ุชุณุฌูู ูู ุงูุฅุฌุฑุงุกุงุช:**
```sql
CREATE TABLE ai_actions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    action_type VARCHAR(100),
    action_level INTEGER,
    request TEXT,
    response TEXT,
    result VARCHAR(50),  -- approved, rejected, modified
    modifications JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);
```

**ุนุฑุถ ุงูุชุงุฑูุฎ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ ุณุฌู ุฅุฌุฑุงุกุงุช AI                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูููู                                               โ
โ โโโ 14:30 - ุงุณุชุนูุงู: "ูู ููุธู ูู ITุ" โ               โ
โ โโโ 14:32 - ุชุนุฏูู ุฑุงุชุจ ุฃุญูุฏ ูุญูุฏ โ ุชู ุงูุงุนุชูุงุฏ        โ
โ โโโ 14:35 - ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ โ ุชู ุงูุฑูุถ                โ
โ โโโ 14:40 - ุชุตููู 5 ุฅููููุงุช ๐ ุชููุงุฆู                  โ
โ                                                         โ
โ ๐ ุฃูุณ                                                  โ
โ โโโ 10:00 - ุชูุฑูุฑ ุงูุฑูุงุชุจ โ                            โ
โ โโโ ...                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงููููุงุช:**
- `core/ai/copilot/audit_logger.py`
- `ui/screens/ai_history/ai_history_page.py`

### N8. Database Schema

```sql
-- ุฌุฏูู ุฅุฌุฑุงุกุงุช AI
CREATE TABLE ai_actions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    session_id VARCHAR(100),
    action_type VARCHAR(100) NOT NULL,
    action_level INTEGER DEFAULT 0,
    request TEXT,
    context JSONB,
    response TEXT,
    result VARCHAR(50),
    modifications JSONB,
    execution_time_ms INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงููุณูุฏุงุช
CREATE TABLE ai_drafts (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    draft_type VARCHAR(100) NOT NULL,
    target_table VARCHAR(100),
    target_id INTEGER,
    draft_data JSONB NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',  -- pending, approved, rejected, expired
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP,
    resolved_at TIMESTAMP
);

-- ุฌุฏูู ุชูุถููุงุช ุงููุณุชุฎุฏู
CREATE TABLE ai_user_preferences (
    id SERIAL PRIMARY KEY,
    user_id INTEGER UNIQUE,
    preferences JSONB DEFAULT '{}',
    learning_data JSONB DEFAULT '{}',
    updated_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงููุนุฑูุฉ ุงูุนุงูุฉ
CREATE TABLE ai_global_knowledge (
    id SERIAL PRIMARY KEY,
    knowledge_type VARCHAR(100),
    key VARCHAR(255),
    value JSONB,
    usage_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_ai_actions_user ON ai_actions(user_id);
CREATE INDEX idx_ai_actions_created ON ai_actions(created_at);
CREATE INDEX idx_ai_drafts_user ON ai_drafts(user_id);
CREATE INDEX idx_ai_drafts_status ON ai_drafts(status);
```

### N9. ูููู ุงููููุงุช

```
core/ai/copilot/
โโโ __init__.py
โโโ copilot_service.py           # ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ
โโโ knowledge_engine.py          # ูุญุฑู ุงููุนุฑูุฉ
โโโ schema_knowledge.py          # ูุนุฑูุฉ ุงูุฌุฏุงูู
โโโ data_knowledge.py            # ูุนุฑูุฉ ุงูุจูุงูุงุช
โโโ ui_knowledge.py              # ูุนุฑูุฉ ุงูุดุงุดุงุช
โโโ business_rules.py            # ููุงุนุฏ ุงูุนูู
โโโ context_manager.py           # ุฅุฏุงุฑุฉ ุงูุณูุงู
โโโ action_sandbox.py            # ุจูุฆุฉ ุงููุณูุฏุงุช
โโโ draft_manager.py             # ุฅุฏุงุฑุฉ ุงููุณูุฏุงุช
โโโ approval_workflow.py         # ุณูุฑ ุงูููุงููุงุช
โโโ action_classifier.py         # ุชุตููู ุงูุฅุฌุฑุงุกุงุช
โโโ learning_system.py           # ูุธุงู ุงูุชุนูู
โโโ user_preferences.py          # ุชูุถููุงุช ุงููุณุชุฎุฏู
โโโ global_knowledge.py          # ุงููุนุฑูุฉ ุงูุนุงูุฉ
โโโ query_executor.py            # ูููุฐ ุงูุงุณุชุนูุงูุงุช
โโโ calculator.py                # ุงูุนูููุงุช ุงูุญุณุงุจูุฉ
โโโ audit_logger.py              # ุชุณุฌูู ุงูุฅุฌุฑุงุกุงุช

ui/components/ai/
โโโ copilot_sidebar.py           # ุงูุดุฑูุท ุงูุฌุงูุจู
โโโ copilot_window.py            # ุงููุงูุฐุฉ ุงููููุตูุฉ
โโโ chat_message.py              # ููุงุนุงุช ุงูุฑุณุงุฆู
โโโ result_viewer.py             # ุนุฑุถ ุงููุชุงุฆุฌ
โโโ chart_result.py              # ุฑุณู ุจูุงูู
โโโ table_result.py              # ุฌุฏูู
โโโ export_result.py             # ุชุตุฏูุฑ

ui/dialogs/ai/
โโโ approval_dialog.py           # ูุงูุฐุฉ ุงูููุงููุฉ
โโโ draft_preview.py             # ูุนุงููุฉ ุงููุณูุฏุฉ
โโโ history_dialog.py            # ุณุฌู ุงูุฅุฌุฑุงุกุงุช

ui/screens/ai_history/
โโโ __init__.py
โโโ ai_history_page.py           # ุตูุญุฉ ุงูุชุงุฑูุฎ
```

### N10. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
N1 โ Knowledge Engine (ูุญุฑู ุงููุนุฑูุฉ) - Schema + Data + UI awareness
N2 โ Chat Interface (ูุงุฌูุฉ ุงููุญุงุฏุซุฉ) - Sidebar + Window + NotebookLM style
N3 โ Context Awareness (ุงููุนู ุจุงูุณูุงู) - Current screen + record + history
N4 โ Action Sandbox (ุจูุฆุฉ ุงููุณูุฏุงุช) - Draft mode + recovery
N5 โ Approval Workflow (ุณูุฑ ุงูููุงููุงุช) - Levels + approve/reject/modify
N6 โ Learning System (ูุธุงู ุงูุชุนูู) - Global + Per-User + feedback
N7 โ Audit & History (ุงูุณุฌู ูุงูุชุงุฑูุฎ) - Full action logging
```

---

## ุงููุญูุฑ O: ุงููุนู ุงูุฒููู ุงููุงุฆู (Hyper Time Intelligence) ๐

> **ุงูููููู:** ูุนู ูุงูู ุจุงูุฒูู ูุงูุชุงุฑูุฎ ูุงูููุช ูุฌุนู AI Copilot ูุงุฆู ุงูุฐูุงุก
> **ุงูุชุงุฑูุฎ:** 4 ูุจุฑุงูุฑ 2026
> **ุงูุฃููููุฉ:** ุฃุณุงุณู - ุงูุจูุนุฏ ุงูุฒููู ููุฐูุงุก

### ุงูููููู ุงูุนุงู

ูุธุงู ูุนู ุฒููู ุดุงูู ููููู AI Copilot ูู ููู ุงูููุช ูุงูุชูุงุฑูุฎ ุจุฐูุงุก ูุงุฆู.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    โฐ INTEGRA Time Intelligence                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  ๐ System Time                                                  โ
โ  โโโ ุงูุชุงุฑูุฎ ุงูุญุงูู: 4 ูุจุฑุงูุฑ 2026                              โ
โ  โโโ ุงูููุช: 14:35:22                                            โ
โ  โโโ ุงูููู: ุงูุฃุฑุจุนุงุก                                            โ
โ  โโโ ุงูุฃุณุจูุน: 6                                                  โ
โ  โโโ ุงูุฑุจุน: Q1                                                   โ
โ                                                                  โ
โ  ๐ ุงูุชูููู ุงููุฌุฑู                                               โ
โ  โโโ ุงูุชุงุฑูุฎ: 5 ุฑุฌุจ 1447                                        โ
โ  โโโ ุงูููุงุณุจุงุช ุงููุงุฏูุฉ: ุฑูุถุงู ุจุนุฏ 52 ููู                        โ
โ                                                                  โ
โ  ๐ข ุณูุงู ุงูุนูู                                                   โ
โ  โโโ ููู ุนูู: โ ูุนู                                            โ
โ  โโโ ุณุงุนุงุช ุงูุนูู: 08:00 - 17:00                                 โ
โ  โโโ ุฏุงุฎู ุณุงุนุงุช ุงูุนูู: โ                                       โ
โ  โโโ ุงูุณูุฉ ุงููุงููุฉ: 2026 (Q1)                                   โ
โ                                                                  โ
โ  ๐ฎ ุงูุชูุจุคุงุช                                                     โ
โ  โโโ ุงููููุฉ ุฏู ูุชุงุฎุฏ: ~2.5 ุณุงุนุฉ                                 โ
โ  โโโ ูู ูุชูุญู ุงูู Deadlineุ โ๏ธ                                  โ
โ  โโโ ุฃูุถู ููุช ููุนูู: ุงูุซูุงุซุงุก 10 ุตุจุงุญุงู                         โ
โ                                                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ููุงุฐุง Time Intelligenceุ

| ุงูููุฒุฉ | ุงููุตู |
|--------|-------|
| **ููู ูุบูู** | ูููู "ุจุนุฏ ุงูุนูุฏ"ุ "ุขุฎุฑ ุงูุดูุฑ"ุ "ูุจู ุฑูุถุงู" |
| **ููุงุฑูุงุช ุฒูููุฉ** | YoY, MoM, QoQ, YTD - ูุซู Power BI |
| **ุชูููู ูุฒุฏูุฌ** | ูููุงุฏู + ูุฌุฑู ูุน ุฅุฌุงุฒุงุช ุงูุฏููุฉ |
| **ุชููุน ุงูุชุฃุฎูุฑ** | ููุจูู ูุจู ููุงุช ุงูู Deadline |
| **ุชุนูู ุงูุฃููุงุท** | ูุชุนูู ุฃููุงุช ุฅูุชุงุฌูุชู ุงูุนุงููุฉ |
| **ุฌุฏููุฉ ุฐููุฉ** | ุฅุนุงุฏุฉ ุชุฑุชูุจ ุชููุงุฆู ุนูุฏ ุงูุชุบููุฑ |

### O1. System Time Core (ููุงุฉ ุงูููุช)

**ูุฑุงุกุฉ ุงูููุช ูู ุงูุฌูุงุฒ:**
```python
# core/time_intelligence/system_time.py

from datetime import datetime, date, time, timedelta
from hijri_converter import Hijri, Gregorian

class SystemTime:
    """ููุงุฉ ุงูููุช - ูุฑุงุกุฉ ุงูููุช ูู ุงูุฌูุงุฒ"""

    @property
    def now(self) -> datetime:
        """ุงูููุช ุงูุญุงูู"""
        return datetime.now()

    @property
    def today(self) -> date:
        """ุชุงุฑูุฎ ุงูููู"""
        return date.today()

    @property
    def current_time(self) -> time:
        """ุงูููุช ุงูุญุงูู"""
        return datetime.now().time()

    @property
    def day_of_week(self) -> str:
        """ุงูููู ูู ุงูุฃุณุจูุน"""
        days_ar = ["ุงูุงุซููู", "ุงูุซูุงุซุงุก", "ุงูุฃุฑุจุนุงุก", "ุงูุฎููุณ", "ุงูุฌูุนุฉ", "ุงูุณุจุช", "ุงูุฃุญุฏ"]
        return days_ar[self.today.weekday()]

    @property
    def week_number(self) -> int:
        """ุฑูู ุงูุฃุณุจูุน ูู ุงูุณูุฉ"""
        return self.today.isocalendar()[1]

    @property
    def quarter(self) -> str:
        """ุงูุฑุจุน ุงูุณููู"""
        month = self.today.month
        if month <= 3:
            return "Q1"
        elif month <= 6:
            return "Q2"
        elif month <= 9:
            return "Q3"
        else:
            return "Q4"

    @property
    def fiscal_year(self) -> int:
        """ุงูุณูุฉ ุงููุงููุฉ (ุชุจุฏุฃ ูู ููุงูุฑ)"""
        return self.today.year

    def to_hijri(self, gregorian_date: date = None) -> dict:
        """ุชุญููู ุฅูู ูุฌุฑู"""
        if gregorian_date is None:
            gregorian_date = self.today
        hijri = Gregorian(
            gregorian_date.year,
            gregorian_date.month,
            gregorian_date.day
        ).to_hijri()
        return {
            "year": hijri.year,
            "month": hijri.month,
            "day": hijri.day,
            "month_name": hijri.month_name(),
            "formatted": f"{hijri.day} {hijri.month_name()} {hijri.year}"
        }
```

**ุงููููุงุช:**
- `core/time_intelligence/__init__.py`
- `core/time_intelligence/system_time.py`
- `core/time_intelligence/hijri_utils.py`

### O2. Working Calendar (ุชูููู ุงูุนูู)

**ุฅุนุฏุงุฏุงุช ูู ุงูุฏููุฉ ูููุฏููู ูุณุชุญูุงุช:**
```python
# core/time_intelligence/working_calendar.py

class WorkingCalendar:
    """ุชูููู ุงูุนูู - ุฃูุงู ุงูุนูู ูุงูุฅุฌุงุฒุงุช"""

    def __init__(self):
        # ูู ุฅุนุฏุงุฏุงุช ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณูุฉ
        self.country = self.get_country_from_settings()  # "SA", "EG", etc.

        # ูู ุฅุนุฏุงุฏุงุช ููุฏููู ูุณุชุญูุงุช
        self.working_days = self.get_working_days_from_mostahaqat()  # [0,1,2,3,4] ุงูุฃุญุฏ-ุงูุฎููุณ
        self.working_hours = self.get_working_hours_from_mostahaqat()  # {"start": "08:00", "end": "17:00"}
        self.weekend_days = self.get_weekend_from_mostahaqat()  # [5,6] ุงูุฌูุนุฉ-ุงูุณุจุช

    def is_working_day(self, check_date: date = None) -> bool:
        """ูู ูุฐุง ููู ุนููุ"""
        if check_date is None:
            check_date = date.today()

        # ุชุญูู ูู ุงูุฅุฌุงุฒุฉ ุงูุฃุณุจูุนูุฉ
        if check_date.weekday() in self.weekend_days:
            return False

        # ุชุญูู ูู ุงูุฅุฌุงุฒุงุช ุงูุฑุณููุฉ
        if self.is_official_holiday(check_date):
            return False

        return True

    def is_working_hours(self, check_time: time = None) -> bool:
        """ูู ูุญู ูู ุณุงุนุงุช ุงูุนููุ"""
        if check_time is None:
            check_time = datetime.now().time()

        start = datetime.strptime(self.working_hours["start"], "%H:%M").time()
        end = datetime.strptime(self.working_hours["end"], "%H:%M").time()

        return start <= check_time <= end

    def get_official_holidays(self, year: int = None) -> list:
        """ุฅุฌุงุฒุงุช ุงูุฏููุฉ ุงูุฑุณููุฉ"""
        if year is None:
            year = date.today().year

        # ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู API ุญุณุจ ุงูุฏููุฉ
        return self.load_holidays_for_country(self.country, year)

    def working_days_between(self, start: date, end: date) -> int:
        """ุนุฏุฏ ุฃูุงู ุงูุนูู ุจูู ุชุงุฑูุฎูู"""
        count = 0
        current = start
        while current <= end:
            if self.is_working_day(current):
                count += 1
            current += timedelta(days=1)
        return count

    def next_working_day(self, from_date: date = None) -> date:
        """ุฃูู ููู ุนูู ุชุงูู"""
        if from_date is None:
            from_date = date.today()

        next_day = from_date + timedelta(days=1)
        while not self.is_working_day(next_day):
            next_day += timedelta(days=1)
        return next_day

    def add_working_days(self, from_date: date, days: int) -> date:
        """ุฃุถู ุฃูุงู ุนูู (ูุน ุชุฌุงูุฒ ุงูุฅุฌุงุฒุงุช)"""
        current = from_date
        added = 0
        while added < days:
            current += timedelta(days=1)
            if self.is_working_day(current):
                added += 1
        return current
```

**ุฅุฌุงุฒุงุช ุงูุฏููุฉ:**
```python
# ุฅุฌุงุฒุงุช ุงูุณุนูุฏูุฉ 2026 (ูุซุงู)
SA_HOLIDAYS_2026 = [
    {"date": "2026-02-22", "name": "ููู ุงูุชุฃุณูุณ", "type": "national"},
    {"date": "2026-03-01", "name": "ุจุฏุงูุฉ ุฑูุถุงู", "type": "religious", "hijri": True},
    {"date": "2026-03-30", "name": "ุนูุฏ ุงููุทุฑ", "type": "religious", "days": 4},
    {"date": "2026-06-06", "name": "ุนูุฏ ุงูุฃุถุญู", "type": "religious", "days": 4},
    {"date": "2026-09-23", "name": "ุงูููู ุงููุทูู", "type": "national"},
]
```

**ุงููููุงุช:**
- `core/time_intelligence/working_calendar.py`
- `core/time_intelligence/holidays/saudi_arabia.py`
- `core/time_intelligence/holidays/egypt.py`
- `core/time_intelligence/holidays/uae.py`

### O3. Natural Language Time Parser (ูุญูู ุงูููุช ุงููุบูู)

**ููู ุงูุชุนุจูุฑุงุช ุงูุฒูููุฉ:**
```python
# core/time_intelligence/time_parser.py

class NaturalTimeParser:
    """ูุญูู ุงูููุช - ููู ุงููุบุฉ ุงูุทุจูุนูุฉ ููุชูุงุฑูุฎ"""

    def parse(self, text: str, reference_date: date = None) -> date:
        """ุชุญููู ูุต ุฅูู ุชุงุฑูุฎ"""
        if reference_date is None:
            reference_date = date.today()

        text = text.strip().lower()

        # ุชุนุจูุฑุงุช ุจุณูุทุฉ
        simple_mappings = {
            "ุงูููู": reference_date,
            "ุฃูุณ": reference_date - timedelta(days=1),
            "ุจูุฑุฉ": reference_date + timedelta(days=1),
            "ุจูุฑู": reference_date + timedelta(days=1),
            "ุบุฏุง": reference_date + timedelta(days=1),
            "ุบุฏุงู": reference_date + timedelta(days=1),
        }

        if text in simple_mappings:
            return simple_mappings[text]

        # ุชุนุจูุฑุงุช ูุณุจูุฉ
        return self._parse_relative(text, reference_date)

    def _parse_relative(self, text: str, ref: date) -> date:
        """ุชุญููู ุงูุชุนุจูุฑุงุช ุงููุณุจูุฉ"""

        # "ุจุนุฏ ุฃุณุจูุน"ุ "ุจุนุฏ ุดูุฑ"ุ "ุจุนุฏ 3 ุฃูุงู"
        if "ุจุนุฏ" in text:
            return self._parse_after(text, ref)

        # "ูุจู ุฃุณุจูุน"ุ "ูุจู ููุงูุฉ ุงูุดูุฑ"
        if "ูุจู" in text:
            return self._parse_before(text, ref)

        # "ุงูุฃุณุจูุน ุงูุฌุงู"ุ "ุงูุดูุฑ ุงููุงุถู"
        if "ุงูุฃุณุจูุน" in text or "ุงูุดูุฑ" in text:
            return self._parse_period(text, ref)

        # "ุฃูู ููู ุนูู"ุ "ุขุฎุฑ ุฎููุณ"
        if "ุฃูู" in text or "ุขุฎุฑ" in text:
            return self._parse_first_last(text, ref)

        # "ุจุนุฏ ุงูุนูุฏ"ุ "ูุจู ุฑูุถุงู"
        if any(word in text for word in ["ุงูุนูุฏ", "ุฑูุถุงู", "ุงููุทูู"]):
            return self._parse_holiday_relative(text, ref)

        return ref

    def parse_examples(self):
        """ุฃูุซูุฉ ุนูู ุงูุชุญููู"""
        examples = {
            "ุงูููู": "2026-02-04",
            "ุจูุฑุฉ": "2026-02-05",
            "ุจุนุฏ ุฃุณุจูุน": "2026-02-11",
            "ุจุนุฏ 3 ุฃูุงู": "2026-02-07",
            "ุงูุฃุณุจูุน ุงูุฌุงู": "2026-02-09 to 2026-02-15",
            "ุงูุดูุฑ ุงููุงุถู": "ููุงูุฑ 2026",
            "ุฃูู ุงูุณูุฉ": "2026-01-01",
            "ููุงูุฉ ุงูุดูุฑ": "2026-02-28",
            "ูุจู ููุงูุฉ ุงูุดูุฑ ุจุฃุณุจูุน": "2026-02-21",
            "ุฃูู ููู ุนูู ุงูุดูุฑ ุงูุฌุงู": "2026-03-01 (ุฃู 2026-03-02 ุฅุฐุง ูุงู ุงูุฃุญุฏ)",
            "ุขุฎุฑ ุฎููุณ ูู ุงูุดูุฑ": "2026-02-26",
            "ุจุนุฏ ุงูุนูุฏ": "ุจุนุฏ ุนูุฏ ุงููุทุฑ 2026",
            "ูุจู ุฑูุถุงู": "ูุจู 1 ุฑูุถุงู 1447",
        }
        return examples
```

**ุงููููุงุช:**
- `core/time_intelligence/time_parser.py`
- `core/time_intelligence/arabic_time_patterns.py`

### O4. Time Intelligence Analytics (ุชุญูููุงุช ุฒูููุฉ)

**ููุงุฑูุงุช ุฒูููุฉ ุงุญุชุฑุงููุฉ:**
```python
# core/time_intelligence/time_analytics.py

class TimeAnalytics:
    """ุชุญูููุงุช ุฒูููุฉ - ูุซู Power BI Time Intelligence"""

    def year_over_year(self, current_value: float, last_year_value: float) -> dict:
        """ููุงุฑูุฉ ุณูููุฉ YoY"""
        diff = current_value - last_year_value
        pct = (diff / last_year_value * 100) if last_year_value else 0
        return {
            "current": current_value,
            "previous": last_year_value,
            "difference": diff,
            "percentage": round(pct, 2),
            "trend": "up" if diff > 0 else "down" if diff < 0 else "flat"
        }

    def month_over_month(self, current_value: float, last_month_value: float) -> dict:
        """ููุงุฑูุฉ ุดูุฑูุฉ MoM"""
        diff = current_value - last_month_value
        pct = (diff / last_month_value * 100) if last_month_value else 0
        return {
            "current": current_value,
            "previous": last_month_value,
            "difference": diff,
            "percentage": round(pct, 2),
            "trend": "up" if diff > 0 else "down" if diff < 0 else "flat"
        }

    def quarter_over_quarter(self, current_value: float, last_quarter_value: float) -> dict:
        """ููุงุฑูุฉ ุฑุจุน ุณูููุฉ QoQ"""
        diff = current_value - last_quarter_value
        pct = (diff / last_quarter_value * 100) if last_quarter_value else 0
        return {
            "current": current_value,
            "previous": last_quarter_value,
            "difference": diff,
            "percentage": round(pct, 2),
            "trend": "up" if diff > 0 else "down" if diff < 0 else "flat"
        }

    def year_to_date(self, values_by_month: list) -> dict:
        """ูู ุฃูู ุงูุณูุฉ ุญุชู ุงูุขู YTD"""
        current_month = date.today().month
        ytd_values = values_by_month[:current_month]
        return {
            "total": sum(ytd_values),
            "average": sum(ytd_values) / len(ytd_values) if ytd_values else 0,
            "months_included": current_month,
            "by_month": ytd_values
        }

    def same_period_last_year(self, current_date: date = None) -> dict:
        """ููุณ ุงููุชุฑุฉ ูู ุงูุณูุฉ ุงููุงุถูุฉ"""
        if current_date is None:
            current_date = date.today()

        last_year = date(
            current_date.year - 1,
            current_date.month,
            min(current_date.day, 28)  # ุชุฌูุจ ูุดุงูู ูุจุฑุงูุฑ
        )

        return {
            "current_period": current_date,
            "last_year_period": last_year,
            "label": f"ููุณ ุงููุชุฑุฉ {last_year.year}"
        }

    def rolling_months(self, months: int = 12) -> dict:
        """ุขุฎุฑ N ุดูุฑ (Rolling)"""
        today = date.today()
        start = today - timedelta(days=months * 30)
        return {
            "start": start,
            "end": today,
            "months": months,
            "label": f"ุขุฎุฑ {months} ุดูุฑ"
        }
```

**ุงููููุงุช:**
- `core/time_intelligence/time_analytics.py`
- `core/time_intelligence/period_calculator.py`

### O5. Productivity Pattern Learning (ุชุนูู ุฃููุงุท ุงูุฅูุชุงุฌูุฉ)

**ุชุนูู ูู ุณููู ุงููุณุชุฎุฏู:**
```python
# core/time_intelligence/productivity_learner.py

class ProductivityLearner:
    """ุชุนูู ุฃููุงุท ุฅูุชุงุฌูุฉ ุงููุณุชุฎุฏู"""

    def __init__(self, user_id: int):
        self.user_id = user_id
        self.patterns = self.load_patterns()

    def record_task_completion(self, task_type: str, duration_minutes: int,
                                completed_at: datetime):
        """ุณุฌู ุฅููุงู ูููุฉ ููุชุนูู"""
        self.patterns["tasks"].append({
            "type": task_type,
            "duration": duration_minutes,
            "hour": completed_at.hour,
            "day_of_week": completed_at.weekday(),
            "completed_at": completed_at
        })

    def get_best_hours(self) -> list:
        """ุฃูุถู ุณุงุนุงุช ุงูุนูู ูููุณุชุฎุฏู"""
        # ุชุญููู ุงูููุงู ุงูููุชููุฉ ุญุณุจ ุงูุณุงุนุฉ
        hour_productivity = {}
        for task in self.patterns["tasks"]:
            hour = task["hour"]
            if hour not in hour_productivity:
                hour_productivity[hour] = {"count": 0, "total_duration": 0}
            hour_productivity[hour]["count"] += 1
            hour_productivity[hour]["total_duration"] += task["duration"]

        # ุชุฑุชูุจ ุญุณุจ ุงูุฅูุชุงุฌูุฉ
        sorted_hours = sorted(
            hour_productivity.items(),
            key=lambda x: x[1]["count"],
            reverse=True
        )

        return [{"hour": h, "productivity": p} for h, p in sorted_hours[:5]]

    def get_average_duration(self, task_type: str) -> int:
        """ูุชูุณุท ููุช ููุน ูุนูู ูู ุงูููุงู"""
        tasks = [t for t in self.patterns["tasks"] if t["type"] == task_type]
        if not tasks:
            return 30  # ุงูุชุฑุงุถู 30 ุฏูููุฉ
        return sum(t["duration"] for t in tasks) // len(tasks)

    def predict_completion_time(self, task_type: str) -> dict:
        """ุชููุน ููุช ุฅููุงุก ูููุฉ"""
        avg_duration = self.get_average_duration(task_type)
        best_hours = self.get_best_hours()

        return {
            "estimated_duration": avg_duration,
            "best_time_to_start": best_hours[0]["hour"] if best_hours else 10,
            "confidence": "high" if len(self.patterns["tasks"]) > 20 else "medium"
        }

    def detect_delay_patterns(self) -> list:
        """ุงูุชุดุงู ุฃููุงุท ุงูุชุฃุฎูุฑ"""
        delayed_tasks = [t for t in self.patterns["tasks"]
                        if t.get("was_delayed", False)]

        patterns = []
        # ุชุญููู: ูู ุงูุชุฃุฎูุฑ ูุญุฏุซ ูู ุฃูุงู ูุนููุฉุ
        # ูู ูุญุฏุซ ูู ููุงูุฉ ุงูุฃุณุจูุนุ
        # ูู ูุญุฏุซ ูุน ุฃููุงุน ูุนููุฉ ูู ุงูููุงูุ

        return patterns
```

**ุงููููุงุช:**
- `core/time_intelligence/productivity_learner.py`
- `core/time_intelligence/pattern_analyzer.py`

### O6. Predictive Deadlines (ุชููุน ุงูููุงุนูุฏ ุงูููุงุฆูุฉ)

**ุชูุจููุงุช ุฐููุฉ ูุจูุฑุฉ:**
```python
# core/time_intelligence/deadline_predictor.py

class DeadlinePredictor:
    """ุชููุน ุงูุชุฃุฎูุฑ ูุจู ุญุฏูุซู"""

    def __init__(self, productivity_learner: ProductivityLearner,
                 working_calendar: WorkingCalendar):
        self.learner = productivity_learner
        self.calendar = working_calendar

    def will_meet_deadline(self, task_type: str, deadline: date,
                           start_date: date = None) -> dict:
        """ูู ุณูุชู ุฅููุงุก ุงููููุฉ ูู ุงูููุชุ"""
        if start_date is None:
            start_date = date.today()

        # ุงุญุณุจ ุงูููุช ุงููุชุงุญ
        available_days = self.calendar.working_days_between(start_date, deadline)

        # ุงุญุณุจ ุงูููุช ุงููุทููุจ
        estimated_duration = self.learner.get_average_duration(task_type)
        estimated_days = estimated_duration / (8 * 60)  # ุชุญููู ุฏูุงุฆู ุฅูู ุฃูุงู ุนูู

        # ุงุญุณุจ ุงููุงูุด
        margin = available_days - estimated_days

        if margin >= 2:
            status = "safe"
            message = "โ ููุช ูุงูู ูุฅููุงุก ุงููููุฉ"
        elif margin >= 0:
            status = "tight"
            message = "โ๏ธ ุงูููุช ุถูู - ุงุจุฏุฃ ูุฑูุจุงู"
        else:
            status = "at_risk"
            message = f"๐ด ุฎุทุฑ ุชุฃุฎูุฑ! ูุญุชุงุฌ ุชุจุฏุฃ ุงูููู ุฃู ุชุทูุจ ุชูุฏูุฏ"

        return {
            "status": status,
            "message": message,
            "available_days": available_days,
            "estimated_days": round(estimated_days, 1),
            "margin_days": round(margin, 1),
            "recommended_start": self._calculate_recommended_start(
                deadline, estimated_days
            )
        }

    def get_at_risk_tasks(self, tasks: list) -> list:
        """ุงูููุงู ุงููุนุฑุถุฉ ููุชุฃุฎูุฑ"""
        at_risk = []
        for task in tasks:
            prediction = self.will_meet_deadline(
                task["type"],
                task["deadline"]
            )
            if prediction["status"] in ["tight", "at_risk"]:
                at_risk.append({
                    "task": task,
                    "prediction": prediction
                })
        return at_risk

    def generate_alerts(self, tasks: list) -> list:
        """ุชูููุฏ ุชูุจููุงุช ุฐููุฉ"""
        alerts = []

        for task in tasks:
            prediction = self.will_meet_deadline(task["type"], task["deadline"])

            if prediction["status"] == "at_risk":
                alerts.append({
                    "type": "deadline_risk",
                    "severity": "high",
                    "task_id": task["id"],
                    "message": f"โ๏ธ ูููุฉ '{task['title']}' ูุนุฑุถุฉ ููุชุฃุฎูุฑ!",
                    "action": "ุงุจุฏุฃ ุงูููู ุฃู ุงุทูุจ ุชูุฏูุฏ"
                })
            elif prediction["status"] == "tight":
                alerts.append({
                    "type": "deadline_warning",
                    "severity": "medium",
                    "task_id": task["id"],
                    "message": f"๐ก ูููุฉ '{task['title']}' - ุงูููุช ุถูู",
                    "action": f"ุงุจุฏุฃ ูุจู {prediction['recommended_start']}"
                })

        return alerts
```

**ุงููููุงุช:**
- `core/time_intelligence/deadline_predictor.py`
- `core/time_intelligence/alert_generator.py`

### O7. Smart Auto-Rescheduling (ุฅุนุงุฏุฉ ุฌุฏููุฉ ุฐููุฉ)

**ุฅุนุงุฏุฉ ุชุฑุชูุจ ุชููุงุฆู:**
```python
# core/time_intelligence/auto_scheduler.py

class AutoScheduler:
    """ุฅุนุงุฏุฉ ุฌุฏููุฉ ุฐููุฉ ุชููุงุฆูุฉ"""

    def __init__(self, working_calendar: WorkingCalendar,
                 productivity_learner: ProductivityLearner):
        self.calendar = working_calendar
        self.learner = productivity_learner

    def reschedule_on_delay(self, delayed_task: dict, other_tasks: list) -> list:
        """ุฅุนุงุฏุฉ ุฌุฏููุฉ ุนูุฏ ุชุฃุฎุฑ ูููุฉ"""
        rescheduled = []

        for task in other_tasks:
            if task["start_date"] > delayed_task["original_deadline"]:
                # ูุง ุชุฃุซูุฑ
                continue

            # ุงุญุณุจ ุงูุชุฃุฎูุฑ
            delay_days = (delayed_task["new_deadline"] -
                         delayed_task["original_deadline"]).days

            # ุญุฑู ุงูููุงู ุงููุชุฃุซุฑุฉ
            new_start = task["start_date"] + timedelta(days=delay_days)
            new_deadline = task["deadline"] + timedelta(days=delay_days)

            rescheduled.append({
                "task_id": task["id"],
                "original_start": task["start_date"],
                "new_start": new_start,
                "original_deadline": task["deadline"],
                "new_deadline": new_deadline,
                "reason": f"ุชุฃุฎุฑ ูููุฉ '{delayed_task['title']}'"
            })

        return rescheduled

    def optimize_schedule(self, tasks: list) -> list:
        """ุชุญุณูู ุงูุฌุฏูู ุจูุงุกู ุนูู ุงูุฃููููุงุช ูุงูุฅูุชุงุฌูุฉ"""
        optimized = []

        # ุฑุชุจ ุญุณุจ ุงูุฃููููุฉ ูุงูู Deadline
        sorted_tasks = sorted(tasks, key=lambda t: (
            -t.get("priority", 0),
            t["deadline"]
        ))

        # ูุฒุน ุนูู ุงูุฃูุงู ูุน ูุฑุงุนุงุฉ ุงูุฅูุชุงุฌูุฉ
        for task in sorted_tasks:
            best_slot = self._find_best_slot(task)
            optimized.append({
                "task": task,
                "suggested_start": best_slot["date"],
                "suggested_time": best_slot["time"],
                "reason": best_slot["reason"]
            })

        return optimized

    def suggest_meeting_time(self, duration_minutes: int,
                            participants: list = None) -> list:
        """ุงูุชุฑุงุญ ููุช ููุงุณุจ ููุงุฌุชูุงุน"""
        suggestions = []
        today = date.today()

        for day_offset in range(7):  # ุฃุณุจูุน ูุงุฏู
            check_date = today + timedelta(days=day_offset)

            if not self.calendar.is_working_day(check_date):
                continue

            # ุงูุฃููุงุช ุงูููุถูุฉ ููุงุฌุชูุงุนุงุช
            preferred_times = ["10:00", "11:00", "14:00", "15:00"]

            for time_str in preferred_times:
                suggestions.append({
                    "date": check_date,
                    "time": time_str,
                    "duration": duration_minutes,
                    "availability": "free"  # ููุญุณุจ ูู ุงูุชูููู
                })

        return suggestions[:5]  # ุฃูุถู 5 ุงูุชุฑุงุญุงุช
```

**ุงููููุงุช:**
- `core/time_intelligence/auto_scheduler.py`
- `core/time_intelligence/schedule_optimizer.py`

### O8. Time-based Triggers (ูุญูุฒุงุช ุฒูููุฉ)

**ุฃุญุฏุงุซ ุชููุงุฆูุฉ ุจูุงุกู ุนูู ุงูููุช:**
```python
# core/time_intelligence/time_triggers.py

class TimeTriggers:
    """ูุญูุฒุงุช ุฒูููุฉ - ุฃุญุฏุงุซ ุชููุงุฆูุฉ"""

    def __init__(self):
        self.triggers = self.load_triggers()

    def register_trigger(self, trigger: dict):
        """ุชุณุฌูู ูุญูุฒ ุฒููู ุฌุฏูุฏ"""
        # ุฃููุงุน ุงููุญูุฒุงุช:
        # - before_date: ูุจู ุชุงุฑูุฎ ูุนูู ุจูุชุฑุฉ
        # - after_date: ุจุนุฏ ุชุงุฑูุฎ ูุนูู
        # - recurring: ูุชูุฑุฑ (ูููู/ุฃุณุจูุนู/ุดูุฑู)
        # - condition: ุนูุฏ ุชุญูู ุดุฑุท ุฒููู

        self.triggers.append({
            "id": trigger.get("id"),
            "type": trigger["type"],
            "target_date": trigger.get("target_date"),
            "offset_days": trigger.get("offset_days", 0),
            "action": trigger["action"],
            "data": trigger.get("data", {}),
            "enabled": True
        })

    def check_triggers(self) -> list:
        """ูุญุต ุงููุญูุฒุงุช ูุชูููุฐ ุงููุงุถุฌุฉ"""
        today = date.today()
        fired = []

        for trigger in self.triggers:
            if not trigger["enabled"]:
                continue

            should_fire = False

            if trigger["type"] == "before_date":
                target = trigger["target_date"] - timedelta(days=trigger["offset_days"])
                should_fire = today >= target

            elif trigger["type"] == "on_date":
                should_fire = today == trigger["target_date"]

            elif trigger["type"] == "recurring":
                should_fire = self._check_recurring(trigger, today)

            if should_fire:
                fired.append(trigger)
                self._execute_trigger(trigger)

        return fired

    def create_contract_expiry_trigger(self, employee_id: int,
                                       expiry_date: date,
                                       days_before: int = 30):
        """ูุญูุฒ ุงูุชูุงุก ุนูุฏ"""
        self.register_trigger({
            "type": "before_date",
            "target_date": expiry_date,
            "offset_days": days_before,
            "action": "notify_contract_expiry",
            "data": {
                "employee_id": employee_id,
                "expiry_date": expiry_date
            }
        })

    def create_reminder_trigger(self, reminder_date: date,
                               message: str, task_id: int = None):
        """ูุญูุฒ ุชุฐููุฑ"""
        self.register_trigger({
            "type": "on_date",
            "target_date": reminder_date,
            "action": "show_reminder",
            "data": {
                "message": message,
                "task_id": task_id
            }
        })
```

**ุงููููุงุช:**
- `core/time_intelligence/time_triggers.py`
- `core/time_intelligence/trigger_executor.py`

### O9. ุงูุชูุงูู ูุน AI Copilot

**ููู ูุณุชุฎุฏู AI Copilot ุงููุนู ุงูุฒููู:**
```python
# ูุซุงู ุนูู ุงุณุชุฎุฏุงู Time Intelligence ูู AI Copilot

class AICopilotWithTime:
    def __init__(self):
        self.time = SystemTime()
        self.calendar = WorkingCalendar()
        self.parser = NaturalTimeParser()
        self.analytics = TimeAnalytics()
        self.predictor = DeadlinePredictor()

    def process_query(self, query: str) -> str:
        """ูุนุงูุฌุฉ ุงุณุชุนูุงู ูุญุชูู ุนูู ุชุนุจูุฑุงุช ุฒูููุฉ"""

        # "ูู ููุธู ุชุนููุง ุงูุดูุฑ ุงููุงุถูุ"
        if "ุงูุดูุฑ ุงููุงุถู" in query:
            period = self.parser.parse("ุงูุดูุฑ ุงููุงุถู")
            # ุงุณุชุนูุงู ุนูู ุงูุจูุงูุงุช ูุน ููุชุฑ ุงูุชุงุฑูุฎ

        # "ูุงุฑู ุฑูุงุชุจ Q1 ุจู Q1 ุงูุณูุฉ ุงููุงุถูุฉ"
        if "ูุงุฑู" in query and ("ุงูุณูุฉ ุงููุงุถูุฉ" in query or "YoY" in query):
            comparison = self.analytics.year_over_year(current, previous)
            return self._format_comparison(comparison)

        # "ุฐูุฑูู ุฃุฌุฏุฏ ุงูุนููุฏ ูุจู ุฑูุถุงู"
        if "ุฐูุฑูู" in query:
            reminder_date = self.parser.parse(query)
            self.create_reminder(reminder_date, query)

        # "ูู ููุญู ุฃุฎูุต ุงููููุฉ ุฏูุ"
        if "ูู ููุญู" in query or "Deadline" in query:
            prediction = self.predictor.will_meet_deadline(task)
            return prediction["message"]
```

### O10. Database Schema

```sql
-- ุฌุฏูู ุฅุฌุงุฒุงุช ุงูุฏูู
CREATE TABLE country_holidays (
    id SERIAL PRIMARY KEY,
    country_code VARCHAR(2) NOT NULL,  -- "SA", "EG", etc.
    holiday_date DATE NOT NULL,
    hijri_date VARCHAR(20),
    name_ar VARCHAR(255) NOT NULL,
    name_en VARCHAR(255),
    holiday_type VARCHAR(50),  -- national, religious, other
    days_count INTEGER DEFAULT 1,
    year INTEGER,
    UNIQUE(country_code, holiday_date)
);

-- ุฌุฏูู ุฃููุงุท ุฅูุชุงุฌูุฉ ุงููุณุชุฎุฏู
CREATE TABLE user_productivity_patterns (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    task_type VARCHAR(100),
    duration_minutes INTEGER,
    completed_hour INTEGER,
    completed_day_of_week INTEGER,
    was_delayed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงููุญูุฒุงุช ุงูุฒูููุฉ
CREATE TABLE time_triggers (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    trigger_type VARCHAR(50) NOT NULL,
    target_date DATE,
    offset_days INTEGER DEFAULT 0,
    action_type VARCHAR(100) NOT NULL,
    action_data JSONB,
    is_enabled BOOLEAN DEFAULT TRUE,
    last_fired_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงูุชุฐููุฑุงุช
CREATE TABLE reminders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    reminder_date DATE NOT NULL,
    reminder_time TIME,
    message TEXT NOT NULL,
    related_task_id INTEGER,
    related_entity_type VARCHAR(50),
    related_entity_id INTEGER,
    is_completed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_holidays_country_year ON country_holidays(country_code, year);
CREATE INDEX idx_productivity_user ON user_productivity_patterns(user_id);
CREATE INDEX idx_triggers_date ON time_triggers(target_date);
CREATE INDEX idx_reminders_date ON reminders(reminder_date);
```

### O11. ูููู ุงููููุงุช

```
core/time_intelligence/
โโโ __init__.py
โโโ system_time.py              # ููุงุฉ ุงูููุช
โโโ hijri_utils.py              # ุงูุชูููู ุงููุฌุฑู
โโโ working_calendar.py         # ุชูููู ุงูุนูู
โโโ time_parser.py              # ูุญูู ุงูููุช ุงููุบูู
โโโ arabic_time_patterns.py     # ุฃููุงุท ุงูููุช ุงูุนุฑุจูุฉ
โโโ time_analytics.py           # ุงูุชุญูููุงุช ุงูุฒูููุฉ
โโโ period_calculator.py        # ุญุณุงุจ ุงููุชุฑุงุช
โโโ productivity_learner.py     # ุชุนูู ุงูุฅูุชุงุฌูุฉ
โโโ pattern_analyzer.py         # ุชุญููู ุงูุฃููุงุท
โโโ deadline_predictor.py       # ุชููุน ุงูููุงุนูุฏ
โโโ alert_generator.py          # ุชูููุฏ ุงูุชูุจููุงุช
โโโ auto_scheduler.py           # ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ
โโโ schedule_optimizer.py       # ุชุญุณูู ุงูุฌุฏูู
โโโ time_triggers.py            # ุงููุญูุฒุงุช ุงูุฒูููุฉ
โโโ trigger_executor.py         # ูููุฐ ุงููุญูุฒุงุช
โโโ holidays/
    โโโ __init__.py
    โโโ saudi_arabia.py         # ุฅุฌุงุฒุงุช ุงูุณุนูุฏูุฉ
    โโโ egypt.py                # ุฅุฌุงุฒุงุช ูุตุฑ
    โโโ uae.py                  # ุฅุฌุงุฒุงุช ุงูุฅูุงุฑุงุช
    โโโ holiday_loader.py       # ุชุญููู ุงูุฅุฌุงุฒุงุช
```

### O12. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
O1 โ System Time Core (ููุงุฉ ุงูููุช) - Gregorian + Hijri
O2 โ Working Calendar (ุชูููู ุงูุนูู) - ูู ุฅุนุฏุงุฏุงุช ุงูุฏููุฉ ููุณุชุญูุงุช
O3 โ Natural Language Parser (ุงููุญูู ุงููุบูู) - ููู "ุจุนุฏ ุงูุนูุฏ"
O4 โ Time Analytics (ุงูุชุญูููุงุช ุงูุฒูููุฉ) - YoY, MoM, QoQ, YTD
O5 โ Productivity Learning (ุชุนูู ุงูุฅูุชุงุฌูุฉ) - ุฃููุงุท ุงููุณุชุฎุฏู
O6 โ Predictive Deadlines (ุชููุน ุงูุชุฃุฎูุฑ) - ุชูุจููุงุช ูุจูุฑุฉ
O7 โ Auto-Rescheduling (ุงูุฌุฏููุฉ ุงูุฐููุฉ) - ุฅุนุงุฏุฉ ุชุฑุชูุจ ุชููุงุฆู
O8 โ Time Triggers (ุงููุญูุฒุงุช ุงูุฒูููุฉ) - ุฃุญุฏุงุซ ุชููุงุฆูุฉ
```

---

## ุงููุญูุฑ P: ูุฏูุฑ ุงููููุงุช ุงูุฐูู (Smart File Manager) ๐

> ููุฏููู ุดุงูู ูุฅุฏุงุฑุฉ ุงููููุงุช ุฏุงุฎู ุงูุจุฑูุงูุฌ ูุนูู ุงูุฌูุงุฒ ูุน ุฏุนู ูุงูู ููุฐูุงุก ุงูุงุตุทูุงุนู

### P1. Excel AI Engine (ูุญุฑู ุฅูุณูู ุงูุฐูู)

**ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ:**
```python
# core/file_manager/excel/excel_ai_engine.py

from enum import Enum
from dataclasses import dataclass
from typing import List, Dict, Any, Optional, Tuple
import pandas as pd

class ColumnType(Enum):
    """ุฃููุงุน ุงูุฃุนูุฏุฉ ุงูููุชุดูุฉ"""
    TEXT = "text"
    NUMBER = "number"
    CURRENCY = "currency"
    DATE = "date"
    PHONE = "phone"
    EMAIL = "email"
    IBAN = "iban"
    PERCENTAGE = "percentage"
    BOOLEAN = "boolean"
    UNKNOWN = "unknown"

@dataclass
class ColumnAnalysis:
    """ุชุญููู ุนููุฏ"""
    name: str
    detected_type: ColumnType
    confidence: float  # 0.0 to 1.0
    sample_values: List[Any]
    null_count: int
    unique_count: int
    suggested_db_column: Optional[str] = None

class ExcelAIEngine:
    """ูุญุฑู Excel ุงููุฏุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"""

    def __init__(self, file_path: str):
        self.file_path = file_path
        self.df: Optional[pd.DataFrame] = None
        self.column_analyses: List[ColumnAnalysis] = []

    def load(self) -> Tuple[bool, str]:
        """ุชุญููู ููู Excel"""
        try:
            if self.file_path.endswith('.csv'):
                # ูุญุงููุฉ ุงูุชุดุงู ุงูุชุฑููุฒ
                encodings = ['utf-8', 'utf-8-sig', 'cp1256', 'iso-8859-6']
                for enc in encodings:
                    try:
                        self.df = pd.read_csv(self.file_path, encoding=enc)
                        break
                    except UnicodeDecodeError:
                        continue
            else:
                self.df = pd.read_excel(self.file_path)
            return True, f"ุชู ุชุญููู {len(self.df)} ุตู"
        except Exception as e:
            return False, str(e)

    def analyze_columns(self) -> List[ColumnAnalysis]:
        """ุชุญููู ุฐูู ููู ุงูุฃุนูุฏุฉ"""
        if self.df is None:
            return []

        analyses = []
        for col in self.df.columns:
            analysis = self._analyze_column(col)
            analyses.append(analysis)

        self.column_analyses = analyses
        return analyses

    def _analyze_column(self, col_name: str) -> ColumnAnalysis:
        """ุชุญููู ุนููุฏ ูุงุญุฏ"""
        series = self.df[col_name]

        # ุฅุญุตุงุฆูุงุช ุฃุณุงุณูุฉ
        null_count = series.isnull().sum()
        unique_count = series.nunique()
        sample_values = series.dropna().head(5).tolist()

        # ุงูุชุดุงู ุงูููุน
        detected_type, confidence = self._detect_type(series)

        # ุงูุชุฑุงุญ ุนููุฏ DB
        suggested_db = self._suggest_db_column(col_name, detected_type)

        return ColumnAnalysis(
            name=col_name,
            detected_type=detected_type,
            confidence=confidence,
            sample_values=sample_values,
            null_count=null_count,
            unique_count=unique_count,
            suggested_db_column=suggested_db
        )

    def _detect_type(self, series: pd.Series) -> Tuple[ColumnType, float]:
        """ุงูุชุดุงู ููุน ุงูุนููุฏ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        non_null = series.dropna()
        if len(non_null) == 0:
            return ColumnType.UNKNOWN, 0.0

        sample = non_null.astype(str).head(100)

        # ูุญุต ุงูุฃููุงุท
        patterns = {
            ColumnType.PHONE: r'^[\+]?[(]?[0-9]{1,3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$',
            ColumnType.EMAIL: r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$',
            ColumnType.IBAN: r'^[A-Z]{2}[0-9]{2}[A-Z0-9]{4,30}$',
            ColumnType.DATE: r'^\d{1,4}[-/]\d{1,2}[-/]\d{1,4}$',
        }

        for col_type, pattern in patterns.items():
            import re
            matches = sample.str.match(pattern, na=False).sum()
            if matches / len(sample) > 0.8:
                return col_type, matches / len(sample)

        # ูุญุต ุฑููู
        try:
            numeric = pd.to_numeric(non_null, errors='coerce')
            if numeric.notna().sum() / len(non_null) > 0.9:
                # ูู ูู ุนููุฉุ
                if numeric.mean() > 100 and numeric.mean() < 1000000:
                    return ColumnType.CURRENCY, 0.7
                return ColumnType.NUMBER, 0.95
        except:
            pass

        return ColumnType.TEXT, 0.5

    def clean_data(self) -> Dict[str, Any]:
        """ุชูุธูู ุงูุจูุงูุงุช ุชููุงุฆูุงู"""
        if self.df is None:
            return {"success": False, "message": "ูู ูุชู ุชุญููู ุงูููู"}

        original_rows = len(self.df)
        changes = []

        # ุฅุฒุงูุฉ ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ
        for col in self.df.select_dtypes(include=['object']).columns:
            self.df[col] = self.df[col].str.strip()
            changes.append(f"ุชูุธูู ุงููุณุงูุงุช ูู {col}")

        # ุชูุญูุฏ ุงูุชูุณููุงุช
        # ุชุญููู ุฃุฑูุงู ุงููุงุชู
        # ุฅุฒุงูุฉ ุงูุตููู ุงููุงุฑุบุฉ ุชูุงูุงู
        self.df = self.df.dropna(how='all')

        return {
            "success": True,
            "original_rows": original_rows,
            "cleaned_rows": len(self.df),
            "removed_rows": original_rows - len(self.df),
            "changes": changes
        }

    def detect_duplicates(self, columns: List[str] = None) -> pd.DataFrame:
        """ุงูุชุดุงู ุงูุตููู ุงูููุฑุฑุฉ"""
        if self.df is None:
            return pd.DataFrame()

        if columns:
            duplicates = self.df[self.df.duplicated(subset=columns, keep=False)]
        else:
            duplicates = self.df[self.df.duplicated(keep=False)]

        return duplicates

    def preview(self, rows: int = 10) -> pd.DataFrame:
        """ูุนุงููุฉ ุงูุจูุงูุงุช"""
        if self.df is None:
            return pd.DataFrame()
        return self.df.head(rows)

    def get_column_mapping_suggestions(self, target_table: str) -> Dict[str, str]:
        """ุงูุชุฑุงุญุงุช ุฑุจุท ุงูุฃุนูุฏุฉ ุจุฌุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
        # ุฎุฑูุทุฉ ุงูุฃุณูุงุก ุงููุนุฑููุฉ
        known_mappings = {
            "employees": {
                "ุงูุงุณู": "name_ar",
                "ุงูุงุณู ุจุงูุนุฑุจู": "name_ar",
                "ุงูุงุณู ุจุงูุงูุฌููุฒู": "name_en",
                "ุฑูู ุงูููุธู": "employee_number",
                "ุงูุฑุงุชุจ": "salary",
                "ุชุงุฑูุฎ ุงูุชุนููู": "hire_date",
                "ุงููุงุชู": "phone",
                "ุงูุฌูุงู": "mobile",
                "ุงูุจุฑูุฏ": "email",
                "IBAN": "iban",
            }
        }

        suggestions = {}
        table_mappings = known_mappings.get(target_table, {})

        for analysis in self.column_analyses:
            # ุจุญุซ ุจุงูุงุณู
            if analysis.name in table_mappings:
                suggestions[analysis.name] = table_mappings[analysis.name]
            elif analysis.suggested_db_column:
                suggestions[analysis.name] = analysis.suggested_db_column

        return suggestions

    def import_to_database(self, table_name: str,
                          column_mapping: Dict[str, str],
                          mode: str = "append") -> Dict[str, Any]:
        """ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
        # mode: "append" | "replace" | "update"

        if self.df is None:
            return {"success": False, "message": "ูู ูุชู ุชุญููู ุงูููู"}

        try:
            # ุชุทุจูู ุงูู mapping
            df_mapped = self.df.rename(columns=column_mapping)

            # ุงูุญููู ุงููุทููุจุฉ ููุท
            valid_columns = list(column_mapping.values())
            df_final = df_mapped[valid_columns]

            # ุงูุงุณุชูุฑุงุฏ ุญุณุจ ุงููุถุน
            # ... implementation

            return {
                "success": True,
                "imported_rows": len(df_final),
                "table": table_name
            }
        except Exception as e:
            return {"success": False, "message": str(e)}
```

**ูุงุฌูุฉ ุงููุณุชุฎุฏู:**
```python
# ui/dialogs/file_manager/excel_import_dialog.py

class ExcelImportDialog(QDialog):
    """ูุงูุฐุฉ ุงุณุชูุฑุงุฏ Excel ุงูุฐููุฉ"""

    def __init__(self, file_path: str, parent=None):
        super().__init__(parent)
        self.engine = ExcelAIEngine(file_path)
        self.setup_ui()

    def setup_ui(self):
        layout = QVBoxLayout(self)

        # ุดุฑูุท ุงูุฎุทูุงุช
        self.steps = QTabWidget()
        self.steps.addTab(self.create_preview_tab(), "1. ูุนุงููุฉ")
        self.steps.addTab(self.create_mapping_tab(), "2. ุฑุจุท ุงูุฃุนูุฏุฉ")
        self.steps.addTab(self.create_options_tab(), "3. ุฎูุงุฑุงุช")
        self.steps.addTab(self.create_confirm_tab(), "4. ุชุฃููุฏ")

        layout.addWidget(self.steps)

        # ุฃุฒุฑุงุฑ
        buttons = QHBoxLayout()
        self.btn_clean = QPushButton("๐งน ุชูุธูู ุงูุจูุงูุงุช")
        self.btn_duplicates = QPushButton("๐ ุงูุชุดุงู ุงูููุฑุฑ")
        self.btn_import = QPushButton("๐ฅ ุงุณุชูุฑุงุฏ")

        buttons.addWidget(self.btn_clean)
        buttons.addWidget(self.btn_duplicates)
        buttons.addStretch()
        buttons.addWidget(self.btn_import)

        layout.addLayout(buttons)
```

### P2. PDF AI Studio (ุงุณุชูุฏูู PDF ุงูุฐูู)

**ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ:**
```python
# core/file_manager/pdf/pdf_ai_studio.py

import fitz  # PyMuPDF
from PIL import Image
import pytesseract
from typing import List, Dict, Optional, BinaryIO
import io

class PDFAIStudio:
    """ุงุณุชูุฏูู PDF ุงููุฏุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"""

    def __init__(self):
        self.documents: Dict[str, fitz.Document] = {}

    # ===============================
    # ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ
    # ===============================

    def open(self, file_path: str) -> str:
        """ูุชุญ ููู PDF"""
        doc_id = f"doc_{len(self.documents)}"
        self.documents[doc_id] = fitz.open(file_path)
        return doc_id

    def split(self, doc_id: str, pages: List[int], output_path: str) -> bool:
        """ูุตู ุตูุญุงุช ูุญุฏุฏุฉ"""
        doc = self.documents.get(doc_id)
        if not doc:
            return False

        new_doc = fitz.open()
        for page_num in pages:
            if 0 <= page_num < len(doc):
                new_doc.insert_pdf(doc, from_page=page_num, to_page=page_num)

        new_doc.save(output_path)
        new_doc.close()
        return True

    def split_all(self, doc_id: str, output_folder: str) -> List[str]:
        """ูุตู ูู ุงูุตูุญุงุช ููููุงุช ูููุฑุฏุฉ"""
        doc = self.documents.get(doc_id)
        if not doc:
            return []

        output_files = []
        for i in range(len(doc)):
            output_path = f"{output_folder}/page_{i+1}.pdf"
            self.split(doc_id, [i], output_path)
            output_files.append(output_path)

        return output_files

    def merge(self, file_paths: List[str], output_path: str) -> bool:
        """ุฏูุฌ ุนุฏุฉ ูููุงุช PDF"""
        try:
            merged = fitz.open()
            for path in file_paths:
                doc = fitz.open(path)
                merged.insert_pdf(doc)
                doc.close()

            merged.save(output_path)
            merged.close()
            return True
        except Exception as e:
            print(f"Error merging: {e}")
            return False

    def extract_pages(self, doc_id: str, start: int, end: int,
                     output_path: str) -> bool:
        """ุงุณุชุฎุฑุงุฌ ูุทุงู ูู ุงูุตูุญุงุช"""
        return self.split(doc_id, list(range(start, end + 1)), output_path)

    def rotate_pages(self, doc_id: str, pages: List[int],
                    angle: int, output_path: str) -> bool:
        """ุชุฏููุฑ ุตูุญุงุช (90, 180, 270)"""
        doc = self.documents.get(doc_id)
        if not doc:
            return False

        for page_num in pages:
            if 0 <= page_num < len(doc):
                page = doc[page_num]
                page.set_rotation(angle)

        doc.save(output_path)
        return True

    def compress(self, doc_id: str, output_path: str,
                quality: str = "medium") -> Dict[str, Any]:
        """ุถุบุท ููู PDF"""
        doc = self.documents.get(doc_id)
        if not doc:
            return {"success": False}

        original_size = doc.tobytes().__len__()

        # ุฅุนุฏุงุฏุงุช ุงูุถุบุท
        if quality == "low":
            doc.save(output_path, garbage=4, deflate=True,
                    clean=True, linear=True)
        elif quality == "medium":
            doc.save(output_path, garbage=3, deflate=True, clean=True)
        else:
            doc.save(output_path, garbage=2, deflate=True)

        compressed_size = fitz.open(output_path).tobytes().__len__()

        return {
            "success": True,
            "original_size": original_size,
            "compressed_size": compressed_size,
            "reduction_percent": round((1 - compressed_size/original_size) * 100, 1)
        }

    # ===============================
    # OCR ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
    # ===============================

    def ocr_page(self, doc_id: str, page_num: int,
                lang: str = "ara+eng") -> str:
        """ุงุณุชุฎุฑุงุฌ ุงููุต ูู ุตูุญุฉ ุจู OCR"""
        doc = self.documents.get(doc_id)
        if not doc or page_num >= len(doc):
            return ""

        page = doc[page_num]

        # ุชุญููู ุงูุตูุญุฉ ุฅูู ุตูุฑุฉ ุนุงููุฉ ุงูุฌูุฏุฉ
        mat = fitz.Matrix(3.0, 3.0)  # 3x zoom for better OCR
        pix = page.get_pixmap(matrix=mat)

        # ุชุญููู ุฅูู PIL Image
        img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)

        # OCR ูุน Tesseract
        # lang: ara = Arabic, eng = English, ara+eng = Both
        text = pytesseract.image_to_string(img, lang=lang, config='--psm 6')

        return text

    def ocr_document(self, doc_id: str, lang: str = "ara+eng") -> List[Dict]:
        """ุงุณุชุฎุฑุงุฌ ุงููุต ูู ูู ุงูุตูุญุงุช"""
        doc = self.documents.get(doc_id)
        if not doc:
            return []

        results = []
        for i in range(len(doc)):
            text = self.ocr_page(doc_id, i, lang)
            results.append({
                "page": i + 1,
                "text": text,
                "word_count": len(text.split())
            })

        return results

    def ocr_with_ai_enhancement(self, doc_id: str, page_num: int) -> Dict:
        """OCR ูุญุณูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        # OCR ุฃุณุงุณู
        raw_text = self.ocr_page(doc_id, page_num)

        # ุชุญุณูู ุจู AI (Ollama)
        from core.ai import get_ai_service
        ai = get_ai_service()

        prompt = f"""
        ุงููุต ุงูุชุงูู ูุณุชุฎุฑุฌ ูู ูุณุชูุฏ PDF ุจู OCR ููุฏ ูุญุชูู ุนูู ุฃุฎุทุงุก.
        ูู ุจุชุตุญูุญ ุงูุฃุฎุทุงุก ุงูุฅููุงุฆูุฉ ูุงููุญููุฉ ูุน ุงูุญูุงุธ ุนูู ุงููุนูู:

        {raw_text}
        """

        corrected = ai.chat(prompt)

        return {
            "raw_text": raw_text,
            "corrected_text": corrected,
            "confidence": 0.85  # ูููู ุญุณุงุจูุง ูู AI
        }

    # ===============================
    # ุชูุฎูุต ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
    # ===============================

    def summarize_document(self, doc_id: str) -> str:
        """ุชูุฎูุต ูุญุชูู PDF ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        doc = self.documents.get(doc_id)
        if not doc:
            return ""

        # ุงุณุชุฎุฑุงุฌ ุงููุต
        full_text = ""
        for page in doc:
            full_text += page.get_text()

        # ุฅุฐุง ูู ููุฌุฏ ูุตุ ุงุณุชุฎุฏู OCR
        if len(full_text.strip()) < 100:
            ocr_results = self.ocr_document(doc_id)
            full_text = "\n".join([r["text"] for r in ocr_results])

        # ุชูุฎูุต ุจู AI
        from core.ai import get_ai_service
        ai = get_ai_service()

        summary = ai.summarize(full_text, max_length=500)
        return summary

    def extract_key_info(self, doc_id: str) -> Dict:
        """ุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ุงูุฑุฆูุณูุฉ ูู ุงููุณุชูุฏ"""
        text = self.get_all_text(doc_id)

        from core.ai import get_ai_service
        ai = get_ai_service()

        prompt = f"""
        ุงุณุชุฎุฑุฌ ุงููุนูููุงุช ุงูุฑุฆูุณูุฉ ูู ุงููุณุชูุฏ ุงูุชุงูู:
        - ุงูููุถูุน ุงูุฑุฆูุณู
        - ุงูุฃุดุฎุงุต ุงููุฐููุฑูู
        - ุงูุชูุงุฑูุฎ
        - ุงููุจุงูุบ ุงููุงููุฉ
        - ุงูุฃุฑูุงู ุงููููุฉ

        ุงููุณุชูุฏ:
        {text[:5000]}  # ุฃูู 5000 ุญุฑู
        """

        response = ai.chat(prompt)
        return {"extracted_info": response}

    # ===============================
    # ุงูุจุญุซ
    # ===============================

    def search(self, doc_id: str, query: str) -> List[Dict]:
        """ุงูุจุญุซ ูู ูุญุชูู PDF"""
        doc = self.documents.get(doc_id)
        if not doc:
            return []

        results = []
        for page_num, page in enumerate(doc):
            text = page.get_text()
            if query.lower() in text.lower():
                # ุงูุจุญุซ ุนู ูููุน ุงููุต
                instances = page.search_for(query)
                results.append({
                    "page": page_num + 1,
                    "count": len(instances),
                    "positions": [{"x": r.x0, "y": r.y0} for r in instances]
                })

        return results

    # ===============================
    # ุงูุญูุงูุฉ ูุงูุนูุงูุฉ ุงููุงุฆูุฉ
    # ===============================

    def add_watermark(self, doc_id: str, text: str,
                     output_path: str, opacity: float = 0.3) -> bool:
        """ุฅุถุงูุฉ ุนูุงูุฉ ูุงุฆูุฉ"""
        doc = self.documents.get(doc_id)
        if not doc:
            return False

        for page in doc:
            # ุฅูุดุงุก ุนูุงูุฉ ูุงุฆูุฉ
            rect = page.rect
            point = fitz.Point(rect.width/4, rect.height/2)
            page.insert_text(
                point, text,
                fontsize=40,
                rotate=45,
                color=(0.7, 0.7, 0.7),
                overlay=True
            )

        doc.save(output_path)
        return True

    def encrypt(self, doc_id: str, password: str,
               output_path: str) -> bool:
        """ุชุดููุฑ PDF ุจูููุฉ ูุฑูุฑ"""
        doc = self.documents.get(doc_id)
        if not doc:
            return False

        doc.save(
            output_path,
            encryption=fitz.PDF_ENCRYPT_AES_256,
            user_pw=password,
            owner_pw=password
        )
        return True

    def get_all_text(self, doc_id: str) -> str:
        """ุงูุญุตูู ุนูู ูู ุงููุต"""
        doc = self.documents.get(doc_id)
        if not doc:
            return ""

        text = ""
        for page in doc:
            text += page.get_text() + "\n"
        return text
```

### P3. Image Tools (ุฃุฏูุงุช ุงูุตูุฑ)

```python
# core/file_manager/image/image_tools.py

from PIL import Image
from pathlib import Path
from typing import List, Dict, Tuple, Optional
import io

class ImageTools:
    """ุฃุฏูุงุช ูุนุงูุฌุฉ ุงูุตูุฑ"""

    @staticmethod
    def resize(image_path: str, output_path: str,
              size: Tuple[int, int] = None,
              scale: float = None) -> Dict:
        """ุชุบููุฑ ุญุฌู ุงูุตูุฑุฉ"""
        img = Image.open(image_path)
        original_size = img.size

        if scale:
            new_size = (int(img.width * scale), int(img.height * scale))
        elif size:
            new_size = size
        else:
            return {"success": False, "message": "ูุฌุจ ุชุญุฏูุฏ size ุฃู scale"}

        resized = img.resize(new_size, Image.Resampling.LANCZOS)
        resized.save(output_path)

        return {
            "success": True,
            "original_size": original_size,
            "new_size": new_size
        }

    @staticmethod
    def convert(image_path: str, output_path: str,
               format: str = "PNG") -> bool:
        """ุชุญููู ุตูุบุฉ ุงูุตูุฑุฉ"""
        img = Image.open(image_path)

        # ูุนุงูุฌุฉ ุฎุงุตุฉ ููู RGBA -> JPEG
        if format.upper() == "JPEG" and img.mode == "RGBA":
            img = img.convert("RGB")

        img.save(output_path, format=format.upper())
        return True

    @staticmethod
    def compress(image_path: str, output_path: str,
                quality: int = 85) -> Dict:
        """ุถุบุท ุงูุตูุฑุฉ"""
        img = Image.open(image_path)
        original_size = Path(image_path).stat().st_size

        # ููู PNG ูุณุชุฎุฏู optimize
        if output_path.lower().endswith('.png'):
            img.save(output_path, optimize=True)
        else:
            if img.mode == "RGBA":
                img = img.convert("RGB")
            img.save(output_path, quality=quality, optimize=True)

        compressed_size = Path(output_path).stat().st_size

        return {
            "success": True,
            "original_size": original_size,
            "compressed_size": compressed_size,
            "reduction_percent": round((1 - compressed_size/original_size) * 100, 1)
        }

    @staticmethod
    def batch_process(image_paths: List[str], output_folder: str,
                     operations: List[Dict]) -> List[Dict]:
        """ูุนุงูุฌุฉ ุฏูุนูุฉ ููุตูุฑ"""
        results = []

        for path in image_paths:
            try:
                img = Image.open(path)

                for op in operations:
                    if op["type"] == "resize":
                        img = img.resize(op["size"], Image.Resampling.LANCZOS)
                    elif op["type"] == "convert":
                        if op["format"] == "JPEG" and img.mode == "RGBA":
                            img = img.convert("RGB")
                    elif op["type"] == "rotate":
                        img = img.rotate(op["angle"], expand=True)

                # ุญูุธ
                filename = Path(path).stem
                ext = operations[-1].get("format", "PNG").lower()
                output_path = f"{output_folder}/{filename}.{ext}"
                img.save(output_path)

                results.append({"file": path, "success": True, "output": output_path})

            except Exception as e:
                results.append({"file": path, "success": False, "error": str(e)})

        return results

    @staticmethod
    def get_info(image_path: str) -> Dict:
        """ูุนูููุงุช ุงูุตูุฑุฉ"""
        img = Image.open(image_path)
        file_size = Path(image_path).stat().st_size

        return {
            "width": img.width,
            "height": img.height,
            "format": img.format,
            "mode": img.mode,
            "file_size": file_size,
            "file_size_formatted": f"{file_size / 1024:.1f} KB"
        }
```

### P4. Word Document Engine (ูุญุฑู ูุณุชูุฏุงุช Word)

```python
# core/file_manager/word/word_engine.py

from docx import Document
from docx.shared import Inches, Pt, RGBColor
from docx.enum.text import WD_ALIGN_PARAGRAPH
from typing import List, Dict, Optional
from pathlib import Path

class WordEngine:
    """ูุญุฑู ูุณุชูุฏุงุช Word"""

    def __init__(self, file_path: str = None):
        if file_path:
            self.doc = Document(file_path)
            self.file_path = file_path
        else:
            self.doc = Document()
            self.file_path = None

    def read_text(self) -> str:
        """ูุฑุงุกุฉ ูู ุงููุต"""
        text = ""
        for para in self.doc.paragraphs:
            text += para.text + "\n"
        return text

    def read_tables(self) -> List[List[List[str]]]:
        """ูุฑุงุกุฉ ุงูุฌุฏุงูู"""
        tables = []
        for table in self.doc.tables:
            table_data = []
            for row in table.rows:
                row_data = [cell.text for cell in row.cells]
                table_data.append(row_data)
            tables.append(table_data)
        return tables

    def add_heading(self, text: str, level: int = 1):
        """ุฅุถุงูุฉ ุนููุงู"""
        self.doc.add_heading(text, level=level)

    def add_paragraph(self, text: str, style: str = None,
                     alignment: str = "right"):
        """ุฅุถุงูุฉ ููุฑุฉ"""
        para = self.doc.add_paragraph(text, style=style)

        if alignment == "right":
            para.alignment = WD_ALIGN_PARAGRAPH.RIGHT
        elif alignment == "center":
            para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        elif alignment == "left":
            para.alignment = WD_ALIGN_PARAGRAPH.LEFT

    def add_table(self, data: List[List[str]],
                 headers: List[str] = None) -> None:
        """ุฅุถุงูุฉ ุฌุฏูู"""
        if headers:
            data = [headers] + data

        table = self.doc.add_table(rows=len(data), cols=len(data[0]))
        table.style = 'Table Grid'

        for i, row_data in enumerate(data):
            row = table.rows[i]
            for j, cell_text in enumerate(row_data):
                row.cells[j].text = str(cell_text)

    def add_image(self, image_path: str, width: float = None):
        """ุฅุถุงูุฉ ุตูุฑุฉ"""
        if width:
            self.doc.add_picture(image_path, width=Inches(width))
        else:
            self.doc.add_picture(image_path)

    def save(self, output_path: str = None):
        """ุญูุธ ุงููุณุชูุฏ"""
        path = output_path or self.file_path
        if path:
            self.doc.save(path)
            return True
        return False

    def to_pdf(self, output_path: str) -> bool:
        """ุชุญููู ุฅูู PDF"""
        # ูุชุทูุจ Microsoft Word ุฃู LibreOffice
        try:
            from docx2pdf import convert

            # ุญูุธ ูุคูุช ุฅุฐุง ูู ููู ูุญููุธ
            if not self.file_path:
                temp_path = "temp_doc.docx"
                self.save(temp_path)
                convert(temp_path, output_path)
                Path(temp_path).unlink()
            else:
                convert(self.file_path, output_path)

            return True
        except Exception as e:
            print(f"Error converting to PDF: {e}")
            return False
```

### P5. File Browser (ูุณุชูุดู ุงููููุงุช)

```python
# core/file_manager/browser/file_browser.py

from pathlib import Path
from dataclasses import dataclass
from typing import List, Dict, Optional
from datetime import datetime
import os
import shutil

@dataclass
class FileInfo:
    """ูุนูููุงุช ููู"""
    name: str
    path: str
    is_dir: bool
    size: int
    modified: datetime
    extension: str
    tags: List[str] = None

class FileBrowser:
    """ูุณุชูุดู ุงููููุงุช ุงููุชูุฏู"""

    def __init__(self):
        self.current_path = Path.home()
        self.favorites: List[Path] = []
        self.recent_files: List[str] = []
        self.file_tags: Dict[str, List[str]] = {}  # path -> tags

    def list_directory(self, path: str = None) -> List[FileInfo]:
        """ุนุฑุถ ูุญุชููุงุช ูุฌูุฏ"""
        target = Path(path) if path else self.current_path

        items = []
        try:
            for item in target.iterdir():
                stat = item.stat()
                items.append(FileInfo(
                    name=item.name,
                    path=str(item),
                    is_dir=item.is_dir(),
                    size=stat.st_size if item.is_file() else 0,
                    modified=datetime.fromtimestamp(stat.st_mtime),
                    extension=item.suffix.lower() if item.is_file() else "",
                    tags=self.file_tags.get(str(item), [])
                ))
        except PermissionError:
            pass

        # ุชุฑุชูุจ: ุงููุฌูุฏุงุช ุฃููุงูุ ุซู ุงููููุงุช
        items.sort(key=lambda x: (not x.is_dir, x.name.lower()))
        return items

    def navigate(self, path: str):
        """ุงูุงูุชูุงู ุฅูู ูุฌูุฏ"""
        new_path = Path(path)
        if new_path.is_dir():
            self.current_path = new_path
            return True
        return False

    def go_up(self):
        """ุงูุงูุชูุงู ูููุฌูุฏ ุงูุฃุนูู"""
        parent = self.current_path.parent
        if parent != self.current_path:
            self.current_path = parent
            return True
        return False

    def search(self, query: str, path: str = None,
              include_content: bool = False) -> List[FileInfo]:
        """ุงูุจุญุซ ุนู ูููุงุช"""
        target = Path(path) if path else self.current_path
        results = []

        for item in target.rglob("*"):
            # ุงูุจุญุซ ุจุงูุงุณู
            if query.lower() in item.name.lower():
                results.append(self._to_file_info(item))
                continue

            # ุงูุจุญุซ ุจุงููุญุชูู (ุงุฎุชูุงุฑู)
            if include_content and item.is_file():
                try:
                    if item.suffix in ['.txt', '.md', '.py', '.json']:
                        content = item.read_text(encoding='utf-8', errors='ignore')
                        if query.lower() in content.lower():
                            results.append(self._to_file_info(item))
                except:
                    pass

            # ุงูุจุญุซ ุจุงููุณูู
            if str(item) in self.file_tags:
                if query.lower() in [t.lower() for t in self.file_tags[str(item)]]:
                    results.append(self._to_file_info(item))

        return results[:100]  # ุฃูู 100 ูุชูุฌุฉ

    def add_tag(self, file_path: str, tag: str):
        """ุฅุถุงูุฉ ูุณู ูููู"""
        if file_path not in self.file_tags:
            self.file_tags[file_path] = []
        if tag not in self.file_tags[file_path]:
            self.file_tags[file_path].append(tag)

    def remove_tag(self, file_path: str, tag: str):
        """ุฅุฒุงูุฉ ูุณู"""
        if file_path in self.file_tags:
            if tag in self.file_tags[file_path]:
                self.file_tags[file_path].remove(tag)

    def add_to_favorites(self, path: str):
        """ุฅุถุงูุฉ ููููุถูุฉ"""
        p = Path(path)
        if p not in self.favorites:
            self.favorites.append(p)

    def get_recent(self, limit: int = 20) -> List[str]:
        """ุงููููุงุช ุงูุฃุฎูุฑุฉ"""
        return self.recent_files[:limit]

    def bulk_rename(self, files: List[str], pattern: str,
                   replacement: str = None,
                   prefix: str = None,
                   suffix: str = None,
                   numbering: bool = False) -> List[Dict]:
        """ุฅุนุงุฏุฉ ุชุณููุฉ ุฌูุงุนูุฉ"""
        results = []

        for i, file_path in enumerate(files, 1):
            path = Path(file_path)
            old_name = path.stem
            ext = path.suffix

            # ุชุทุจูู ุงูุชุบููุฑุงุช
            new_name = old_name

            if pattern and replacement is not None:
                import re
                new_name = re.sub(pattern, replacement, new_name)

            if prefix:
                new_name = prefix + new_name

            if suffix:
                new_name = new_name + suffix

            if numbering:
                new_name = f"{new_name}_{i:03d}"

            new_path = path.parent / f"{new_name}{ext}"

            try:
                path.rename(new_path)
                results.append({
                    "old": str(path),
                    "new": str(new_path),
                    "success": True
                })
            except Exception as e:
                results.append({
                    "old": str(path),
                    "error": str(e),
                    "success": False
                })

        return results

    def copy(self, source: str, dest: str) -> bool:
        """ูุณุฎ ููู/ูุฌูุฏ"""
        src = Path(source)
        dst = Path(dest)

        try:
            if src.is_file():
                shutil.copy2(src, dst)
            else:
                shutil.copytree(src, dst)
            return True
        except Exception as e:
            return False

    def move(self, source: str, dest: str) -> bool:
        """ููู ููู/ูุฌูุฏ"""
        try:
            shutil.move(source, dest)
            return True
        except:
            return False

    def delete(self, path: str, to_trash: bool = True) -> bool:
        """ุญุฐู ููู/ูุฌูุฏ"""
        p = Path(path)

        try:
            if to_trash:
                # ุงูููู ูููุญุฐููุงุช ุจุฏูุงู ูู ุงูุญุฐู ุงูููุงุฆู
                from send2trash import send2trash
                send2trash(path)
            else:
                if p.is_file():
                    p.unlink()
                else:
                    shutil.rmtree(p)
            return True
        except:
            return False

    def _to_file_info(self, path: Path) -> FileInfo:
        """ุชุญููู Path ุฅูู FileInfo"""
        stat = path.stat()
        return FileInfo(
            name=path.name,
            path=str(path),
            is_dir=path.is_dir(),
            size=stat.st_size if path.is_file() else 0,
            modified=datetime.fromtimestamp(stat.st_mtime),
            extension=path.suffix.lower() if path.is_file() else "",
            tags=self.file_tags.get(str(path), [])
        )
```

### P6. Cloud Storage Integration (ุชูุงูู ุงูุชุฎุฒูู ุงูุณุญุงุจู)

```python
# core/file_manager/cloud/cloud_storage.py

from abc import ABC, abstractmethod
from dataclasses import dataclass
from typing import List, Optional, BinaryIO
from enum import Enum

class CloudProvider(Enum):
    GOOGLE_DRIVE = "google_drive"
    ONEDRIVE = "onedrive"
    DROPBOX = "dropbox"

@dataclass
class CloudFile:
    """ููู ุณุญุงุจู"""
    id: str
    name: str
    path: str
    size: int
    is_folder: bool
    shared_link: Optional[str] = None
    provider: CloudProvider = None

class CloudStorageBase(ABC):
    """ูุงุนุฏุฉ ุงูุชุฎุฒูู ุงูุณุญุงุจู"""

    @abstractmethod
    def authenticate(self) -> bool:
        pass

    @abstractmethod
    def list_files(self, folder_id: str = None) -> List[CloudFile]:
        pass

    @abstractmethod
    def download(self, file_id: str, local_path: str) -> bool:
        pass

    @abstractmethod
    def upload(self, local_path: str, folder_id: str = None) -> Optional[CloudFile]:
        pass

    @abstractmethod
    def get_shared_link(self, file_id: str) -> str:
        pass

class GoogleDriveStorage(CloudStorageBase):
    """Google Drive Integration"""

    def __init__(self, credentials_path: str = None):
        self.credentials_path = credentials_path
        self.service = None

    def authenticate(self) -> bool:
        try:
            from google.oauth2.credentials import Credentials
            from googleapiclient.discovery import build
            from google_auth_oauthlib.flow import InstalledAppFlow

            SCOPES = ['https://www.googleapis.com/auth/drive']

            flow = InstalledAppFlow.from_client_secrets_file(
                self.credentials_path, SCOPES)
            creds = flow.run_local_server(port=0)

            self.service = build('drive', 'v3', credentials=creds)
            return True
        except Exception as e:
            print(f"Google Drive auth error: {e}")
            return False

    def list_files(self, folder_id: str = None) -> List[CloudFile]:
        if not self.service:
            return []

        query = f"'{folder_id}' in parents" if folder_id else None
        results = self.service.files().list(
            q=query,
            pageSize=100,
            fields="files(id, name, size, mimeType)"
        ).execute()

        files = []
        for item in results.get('files', []):
            files.append(CloudFile(
                id=item['id'],
                name=item['name'],
                path="",
                size=int(item.get('size', 0)),
                is_folder=item['mimeType'] == 'application/vnd.google-apps.folder',
                provider=CloudProvider.GOOGLE_DRIVE
            ))

        return files

    def download(self, file_id: str, local_path: str) -> bool:
        if not self.service:
            return False

        try:
            from googleapiclient.http import MediaIoBaseDownload
            import io

            request = self.service.files().get_media(fileId=file_id)
            fh = io.FileIO(local_path, 'wb')
            downloader = MediaIoBaseDownload(fh, request)

            done = False
            while not done:
                status, done = downloader.next_chunk()

            return True
        except:
            return False

    def upload(self, local_path: str, folder_id: str = None) -> Optional[CloudFile]:
        # Implementation...
        pass

    def get_shared_link(self, file_id: str) -> str:
        if not self.service:
            return ""

        self.service.permissions().create(
            fileId=file_id,
            body={'type': 'anyone', 'role': 'reader'}
        ).execute()

        file = self.service.files().get(
            fileId=file_id,
            fields='webViewLink'
        ).execute()

        return file.get('webViewLink', '')

class OneDriveStorage(CloudStorageBase):
    """OneDrive Integration"""
    # Implementation similar to Google Drive...
    pass

class DropboxStorage(CloudStorageBase):
    """Dropbox Integration"""
    # Implementation similar to Google Drive...
    pass

class CloudStorageManager:
    """ูุฏูุฑ ุงูุชุฎุฒูู ุงูุณุญุงุจู ุงูููุญุฏ"""

    def __init__(self):
        self.providers: Dict[CloudProvider, CloudStorageBase] = {}

    def add_provider(self, provider: CloudProvider, storage: CloudStorageBase):
        """ุฅุถุงูุฉ ูุฒูุฏ ุชุฎุฒูู"""
        self.providers[provider] = storage

    def authenticate_all(self) -> Dict[CloudProvider, bool]:
        """ุชุณุฌูู ุงูุฏุฎูู ููู ุงููุฒูุฏูู"""
        results = {}
        for provider, storage in self.providers.items():
            results[provider] = storage.authenticate()
        return results

    def download_from_link(self, link: str, local_path: str) -> bool:
        """ุชุญููู ูู ุฑุงุจุท ุณุญุงุจู"""
        # ุงูุชุดุงู ุงููุฒูุฏ ูู ุงูุฑุงุจุท
        if "drive.google.com" in link:
            provider = CloudProvider.GOOGLE_DRIVE
        elif "onedrive" in link or "sharepoint" in link:
            provider = CloudProvider.ONEDRIVE
        elif "dropbox.com" in link:
            provider = CloudProvider.DROPBOX
        else:
            return False

        storage = self.providers.get(provider)
        if not storage:
            return False

        # ุงุณุชุฎุฑุงุฌ file_id ูู ุงูุฑุงุจุท
        file_id = self._extract_file_id(link, provider)
        return storage.download(file_id, local_path)

    def _extract_file_id(self, link: str, provider: CloudProvider) -> str:
        """ุงุณุชุฎุฑุงุฌ ูุนุฑู ุงูููู ูู ุงูุฑุงุจุท"""
        # Implementation per provider...
        pass
```

### P7. Document Attachments (ูุฑููุงุช ุงููุณุชูุฏุงุช)

```python
# core/file_manager/attachments/attachment_manager.py

from dataclasses import dataclass
from typing import List, Optional, BinaryIO
from enum import Enum
from datetime import datetime
import hashlib
import os

class StorageType(Enum):
    """ููุน ุงูุชุฎุฒูู"""
    DATABASE_BLOB = "blob"       # ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    LOCAL_PATH = "local"         # ูุณุงุฑ ุนูู ุงูุฌูุงุฒ
    CLOUD_LINK = "cloud"         # ุฑุงุจุท ุณุญุงุจู

@dataclass
class Attachment:
    """ูุฑูู"""
    id: int
    filename: str
    storage_type: StorageType
    storage_path: str           # ุงููุณุงุฑ ุฃู ุงูุฑุงุจุท
    file_size: int
    mime_type: str
    entity_type: str            # employees, companies, etc.
    entity_id: int
    version: int = 1
    checksum: str = None
    created_at: datetime = None
    created_by: int = None

class AttachmentManager:
    """ูุฏูุฑ ุงููุฑููุงุช"""

    def __init__(self, base_path: str = "attachments"):
        self.base_path = base_path
        os.makedirs(base_path, exist_ok=True)

    def attach_file(self, file_path: str, entity_type: str, entity_id: int,
                   storage_type: StorageType = StorageType.LOCAL_PATH,
                   user_id: int = None) -> Optional[Attachment]:
        """ุฑุจุท ููู ุจุณุฌู"""

        if not os.path.exists(file_path):
            return None

        filename = os.path.basename(file_path)
        file_size = os.path.getsize(file_path)

        # ุญุณุงุจ checksum
        checksum = self._calculate_checksum(file_path)

        # ุชุญุฏูุฏ ูุณุงุฑ ุงูุชุฎุฒูู
        if storage_type == StorageType.LOCAL_PATH:
            # ูุณุฎ ุงูููู ูููุฌูุฏ ุงูููุธู
            dest_folder = f"{self.base_path}/{entity_type}/{entity_id}"
            os.makedirs(dest_folder, exist_ok=True)
            dest_path = f"{dest_folder}/{filename}"

            import shutil
            shutil.copy2(file_path, dest_path)
            storage_path = dest_path

        elif storage_type == StorageType.DATABASE_BLOB:
            # ูุฑุงุกุฉ ุงูููู ูุญูุธู ูู DB
            with open(file_path, 'rb') as f:
                content = f.read()
            storage_path = self._save_to_database(content, filename)

        else:
            # ุฑุงุจุท ุณุญุงุจู - ูููุฑุฑ ููุง ูู
            storage_path = file_path

        # ุฅูุดุงุก ุณุฌู ุงููุฑูู
        attachment = Attachment(
            id=None,  # ุณููุญุฏุฏ ูู DB
            filename=filename,
            storage_type=storage_type,
            storage_path=storage_path,
            file_size=file_size,
            mime_type=self._get_mime_type(filename),
            entity_type=entity_type,
            entity_id=entity_id,
            checksum=checksum,
            created_at=datetime.now(),
            created_by=user_id
        )

        # ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        self._save_attachment_record(attachment)

        return attachment

    def attach_from_cloud(self, cloud_link: str, entity_type: str,
                         entity_id: int, filename: str = None) -> Optional[Attachment]:
        """ุฑุจุท ููู ูู ุงูุชุฎุฒูู ุงูุณุญุงุจู"""

        if not filename:
            # ุงุณุชุฎุฑุงุฌ ุงุณู ุงูููู ูู ุงูุฑุงุจุท
            filename = cloud_link.split("/")[-1].split("?")[0]

        attachment = Attachment(
            id=None,
            filename=filename,
            storage_type=StorageType.CLOUD_LINK,
            storage_path=cloud_link,
            file_size=0,  # ุบูุฑ ูุนุฑูู
            mime_type=self._get_mime_type(filename),
            entity_type=entity_type,
            entity_id=entity_id,
            created_at=datetime.now()
        )

        self._save_attachment_record(attachment)
        return attachment

    def get_attachments(self, entity_type: str, entity_id: int) -> List[Attachment]:
        """ุงูุญุตูู ุนูู ูุฑููุงุช ุณุฌู"""
        from core.database import select_all

        columns, rows = select_all("""
            SELECT * FROM attachments
            WHERE entity_type = %s AND entity_id = %s
            ORDER BY created_at DESC
        """, (entity_type, entity_id))

        return [self._row_to_attachment(row, columns) for row in rows]

    def get_file_content(self, attachment: Attachment) -> Optional[bytes]:
        """ุงูุญุตูู ุนูู ูุญุชูู ุงูููู"""

        if attachment.storage_type == StorageType.LOCAL_PATH:
            with open(attachment.storage_path, 'rb') as f:
                return f.read()

        elif attachment.storage_type == StorageType.DATABASE_BLOB:
            return self._load_from_database(attachment.storage_path)

        elif attachment.storage_type == StorageType.CLOUD_LINK:
            # ุชุญููู ูู ุงูุณุญุงุจุฉ
            from core.file_manager.cloud import CloudStorageManager
            manager = CloudStorageManager()

            import tempfile
            temp_path = tempfile.mktemp()
            if manager.download_from_link(attachment.storage_path, temp_path):
                with open(temp_path, 'rb') as f:
                    content = f.read()
                os.remove(temp_path)
                return content

        return None

    def create_new_version(self, attachment_id: int,
                          new_file_path: str) -> Optional[Attachment]:
        """ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ ูู ุงููุฑูู"""
        # ุงูุญุตูู ุนูู ุงููุฑูู ุงูุฃุตูู
        original = self.get_attachment_by_id(attachment_id)
        if not original:
            return None

        # ุฅูุดุงุก ูุฑูู ุฌุฏูุฏ ุจููุณ ุงูุจูุงูุงุช ููู version + 1
        new_attachment = self.attach_file(
            new_file_path,
            original.entity_type,
            original.entity_id,
            original.storage_type
        )

        if new_attachment:
            new_attachment.version = original.version + 1
            self._update_attachment_record(new_attachment)

        return new_attachment

    def get_versions(self, entity_type: str, entity_id: int,
                    filename: str) -> List[Attachment]:
        """ุงูุญุตูู ุนูู ูู ูุณุฎ ููู"""
        from core.database import select_all

        columns, rows = select_all("""
            SELECT * FROM attachments
            WHERE entity_type = %s AND entity_id = %s AND filename = %s
            ORDER BY version DESC
        """, (entity_type, entity_id, filename))

        return [self._row_to_attachment(row, columns) for row in rows]

    def _calculate_checksum(self, file_path: str) -> str:
        """ุญุณุงุจ checksum ููููู"""
        sha256 = hashlib.sha256()
        with open(file_path, 'rb') as f:
            for chunk in iter(lambda: f.read(8192), b''):
                sha256.update(chunk)
        return sha256.hexdigest()

    def _get_mime_type(self, filename: str) -> str:
        """ุชุญุฏูุฏ ููุน ุงูููู"""
        import mimetypes
        mime_type, _ = mimetypes.guess_type(filename)
        return mime_type or "application/octet-stream"

    def _save_attachment_record(self, attachment: Attachment):
        """ุญูุธ ุณุฌู ุงููุฑูู ูู DB"""
        from core.database import insert_returning_id

        attachment.id = insert_returning_id("""
            INSERT INTO attachments
            (filename, storage_type, storage_path, file_size, mime_type,
             entity_type, entity_id, version, checksum, created_at, created_by)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        """, (
            attachment.filename,
            attachment.storage_type.value,
            attachment.storage_path,
            attachment.file_size,
            attachment.mime_type,
            attachment.entity_type,
            attachment.entity_id,
            attachment.version,
            attachment.checksum,
            attachment.created_at,
            attachment.created_by
        ))

    def _save_to_database(self, content: bytes, filename: str) -> str:
        """ุญูุธ ูุญุชูู ุงูููู ูู DB ูู BLOB"""
        from core.database import insert_returning_id

        blob_id = insert_returning_id("""
            INSERT INTO file_blobs (filename, content, created_at)
            VALUES (%s, %s, NOW())
        """, (filename, content))

        return f"blob://{blob_id}"

    def _load_from_database(self, storage_path: str) -> Optional[bytes]:
        """ุชุญููู ูุญุชูู ูู DB"""
        if not storage_path.startswith("blob://"):
            return None

        blob_id = int(storage_path.replace("blob://", ""))

        from core.database import select_one
        result = select_one(
            "SELECT content FROM file_blobs WHERE id = %s",
            (blob_id,)
        )

        return result[0] if result else None
```

### P8. Database Schema

```sql
-- ุฌุฏูู ุงููุฑููุงุช
CREATE TABLE attachments (
    id SERIAL PRIMARY KEY,
    filename VARCHAR(255) NOT NULL,
    storage_type VARCHAR(20) NOT NULL,  -- 'blob', 'local', 'cloud'
    storage_path TEXT NOT NULL,
    file_size BIGINT DEFAULT 0,
    mime_type VARCHAR(100),
    entity_type VARCHAR(50) NOT NULL,   -- 'employees', 'companies', etc.
    entity_id INTEGER NOT NULL,
    version INTEGER DEFAULT 1,
    checksum VARCHAR(64),
    created_at TIMESTAMP DEFAULT NOW(),
    created_by INTEGER REFERENCES users(id)
);

-- ุฌุฏูู ูุญุชูู ุงููููุงุช (BLOB)
CREATE TABLE file_blobs (
    id SERIAL PRIMARY KEY,
    filename VARCHAR(255),
    content BYTEA NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ูุณูู ุงููููุงุช
CREATE TABLE file_tags (
    id SERIAL PRIMARY KEY,
    file_path TEXT NOT NULL,
    tag VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(file_path, tag)
);

-- ุฌุฏูู ุงููููุงุช ุงูุฃุฎูุฑุฉ
CREATE TABLE recent_files (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    file_path TEXT NOT NULL,
    accessed_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุงูููุถูุฉ
CREATE TABLE favorite_paths (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    path TEXT NOT NULL,
    name VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(user_id, path)
);

-- Indexes
CREATE INDEX idx_attachments_entity ON attachments(entity_type, entity_id);
CREATE INDEX idx_attachments_filename ON attachments(filename);
CREATE INDEX idx_file_tags_path ON file_tags(file_path);
CREATE INDEX idx_file_tags_tag ON file_tags(tag);
CREATE INDEX idx_recent_files_user ON recent_files(user_id, accessed_at DESC);
```

### P9. ูููู ุงููููุงุช

```
core/file_manager/
โโโ __init__.py
โโโ excel/
โ   โโโ __init__.py
โ   โโโ excel_ai_engine.py      # ูุญุฑู Excel ุงูุฐูู
โ   โโโ column_detector.py      # ุงูุชุดุงู ุฃููุงุน ุงูุฃุนูุฏุฉ
โ   โโโ data_cleaner.py         # ุชูุธูู ุงูุจูุงูุงุช
โ   โโโ db_importer.py          # ุงุณุชูุฑุงุฏ ููุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ pdf/
โ   โโโ __init__.py
โ   โโโ pdf_ai_studio.py        # ุงุณุชูุฏูู PDF
โ   โโโ pdf_ocr.py              # OCR ููู PDF
โ   โโโ pdf_tools.py            # ุฃุฏูุงุช ุฃุณุงุณูุฉ
โ   โโโ pdf_summarizer.py       # ุชูุฎูุต ุจุงูู AI
โโโ image/
โ   โโโ __init__.py
โ   โโโ image_tools.py          # ุฃุฏูุงุช ุงูุตูุฑ
โโโ word/
โ   โโโ __init__.py
โ   โโโ word_engine.py          # ูุญุฑู Word
โโโ browser/
โ   โโโ __init__.py
โ   โโโ file_browser.py         # ูุณุชูุดู ุงููููุงุช
โ   โโโ file_search.py          # ุจุญุซ ุงููููุงุช
โ   โโโ bulk_operations.py      # ุนูููุงุช ุฌูุงุนูุฉ
โโโ cloud/
โ   โโโ __init__.py
โ   โโโ cloud_storage.py        # ุฅุฏุงุฑุฉ ููุญุฏุฉ
โ   โโโ google_drive.py         # Google Drive
โ   โโโ onedrive.py             # OneDrive
โ   โโโ dropbox.py              # Dropbox
โโโ attachments/
โ   โโโ __init__.py
โ   โโโ attachment_manager.py   # ูุฏูุฑ ุงููุฑููุงุช
โโโ ocr/
    โโโ __init__.py
    โโโ arabic_ocr.py           # OCR ุนุฑุจู ูุญุณูู
    โโโ ocr_enhancer.py         # ุชุญุณูู ุจุงูู AI

ui/dialogs/file_manager/
โโโ __init__.py
โโโ excel_import_dialog.py      # ูุงูุฐุฉ ุงุณุชูุฑุงุฏ Excel
โโโ pdf_studio_dialog.py        # ูุงูุฐุฉ PDF Studio
โโโ file_browser_dialog.py      # ูุงูุฐุฉ ูุณุชูุดู ุงููููุงุช
โโโ cloud_connect_dialog.py     # ุฑุจุท ุงูุชุฎุฒูู ุงูุณุญุงุจู
โโโ attachment_viewer.py        # ุนุงุฑุถ ุงููุฑููุงุช

modules/file_manager/
โโโ __init__.py
โโโ window/
โ   โโโ file_manager_window.py  # ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
โโโ screens/
โ   โโโ pdf_studio/             # ุดุงุดุฉ PDF Studio
โ   โโโ excel_manager/          # ุดุงุดุฉ Excel
โ   โโโ document_browser/       # ูุณุชุนุฑุถ ุงููุณุชูุฏุงุช
โโโ widgets/
    โโโ file_preview.py         # ูุนุงููุฉ ุงููููุงุช
    โโโ dual_pane.py            # ุนุฑุถ ูุฒุฏูุฌ
    โโโ tag_editor.py           # ูุญุฑุฑ ุงููุณูู
```

### P10. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
P1 โ Excel AI Engine (ูุญุฑู Excel ุงูุฐูู) - Smart Import, Cleaning, Mapping
P2 โ PDF AI Studio (ุงุณุชูุฏูู PDF) - Split, Merge, OCR Arabic+English
P3 โ Image Tools (ุฃุฏูุงุช ุงูุตูุฑ) - Resize, Convert, Compress, Batch
P4 โ Word Engine (ูุญุฑู Word) - Read, Write, Convert
P5 โ File Browser (ูุณุชูุดู ุงููููุงุช) - Dual Pane, Tags, Search
P6 โ Cloud Integration (ุงูุชุฎุฒูู ุงูุณุญุงุจู) - Google Drive, OneDrive, Dropbox
P7 โ Attachments (ุงููุฑููุงุช) - Hybrid Storage, Versioning
P8 โ AI Copilot Integration (ุชูุงูู ุงูููุจุงูููุช) - ุฃูุงูุฑ ุทุจูุนูุฉ ูููููุงุช
```

### P11. ููุงุท ุงูููุฉ ุงููุฑูุฏุฉ

| ุงูููุฒุฉ | ุงููุตู | ุงูููุงูุณูู |
|--------|-------|-----------|
| **AI-Powered OCR** | ุงุณุชุฎุฑุงุฌ ุงููุต ุงูุนุฑุจู ูุงูุฅูุฌููุฒู ุจุฏูุฉ ุนุงููุฉ ุฌุฏุงู | ููุท Sage ู NetSuite |
| **Smart Excel Import** | ุงูุชุดุงู ุฐูู ูุฃููุงุน ุงูุจูุงูุงุช + ุชูุธูู ุชููุงุฆู | ุบูุฑ ููุฌูุฏ |
| **Hybrid Storage** | BLOB + Local + Cloud ูู ูุธุงู ูุงุญุฏ | ูุงุฏุฑ |
| **AI Summarization** | ุชูุฎูุต PDF/Word ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู | ุบูุฑ ููุฌูุฏ ูู ERP |
| **Natural Commands** | "ุงุฏูุฌ ุงููููุงุช ุฏู" - ุฃูุงูุฑ ุทุจูุนูุฉ | ุบูุฑ ููุฌูุฏ |

---

## ุงููุญูุฑ Q: ุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ ูุงูุทุงุจุนุงุช (Device & Printer Manager) โ **ููุชูู** (2026-02-06)

> ููุฏููู ูุฅุฏุงุฑุฉ ุงูุทุงุจุนุงุช ูุงููุงุณุญุงุช ุงูุถูุฆูุฉ ุงููุชุตูุฉ ุจุงูููุจููุชุฑ ุฃู ุนุจุฑ ุงูุดุจูุฉ ุฃู ุงูุจููุชูุซ

### Q1. Printer Management (ุฅุฏุงุฑุฉ ุงูุทุงุจุนุงุช)

**ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ:**
```python
# core/devices/printer/printer_manager.py

import win32print
import win32api
from typing import List, Dict, Optional
from dataclasses import dataclass
from enum import Enum

class PrinterType(Enum):
    LOCAL = "local"
    NETWORK = "network"
    BLUETOOTH = "bluetooth"
    VIRTUAL = "virtual"

@dataclass
class PrinterInfo:
    """ูุนูููุงุช ุงูุทุงุจุนุฉ"""
    name: str
    port: str
    driver: str
    printer_type: PrinterType
    is_default: bool
    status: str
    jobs_count: int

class PrinterManager:
    """ูุฏูุฑ ุงูุทุงุจุนุงุช"""

    def get_available_printers(self) -> List[PrinterInfo]:
        """ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูุทุงุจุนุงุช ุงููุชุงุญุฉ"""
        printers = []
        default_printer = win32print.GetDefaultPrinter()

        for printer in win32print.EnumPrinters(
            win32print.PRINTER_ENUM_LOCAL | win32print.PRINTER_ENUM_CONNECTIONS
        ):
            name = printer[2]
            handle = win32print.OpenPrinter(name)
            try:
                info = win32print.GetPrinter(handle, 2)
                printers.append(PrinterInfo(
                    name=name,
                    port=info.get('pPortName', ''),
                    driver=info.get('pDriverName', ''),
                    printer_type=self._detect_type(info),
                    is_default=(name == default_printer),
                    status=self._get_status(info.get('Status', 0)),
                    jobs_count=info.get('cJobs', 0)
                ))
            finally:
                win32print.ClosePrinter(handle)

        return printers

    def set_default_printer(self, printer_name: str) -> bool:
        """ุชุนููู ุงูุทุงุจุนุฉ ุงูุงูุชุฑุงุถูุฉ"""
        try:
            win32print.SetDefaultPrinter(printer_name)
            return True
        except:
            return False

    def print_document(self, file_path: str, printer_name: str = None,
                      copies: int = 1, orientation: str = "portrait",
                      paper_size: str = "A4") -> Dict:
        """ุทุจุงุนุฉ ูุณุชูุฏ"""
        if not printer_name:
            printer_name = win32print.GetDefaultPrinter()

        try:
            # ููู PDF
            if file_path.lower().endswith('.pdf'):
                return self._print_pdf(file_path, printer_name, copies)

            # ููุตูุฑ
            elif file_path.lower().endswith(('.png', '.jpg', '.jpeg')):
                return self._print_image(file_path, printer_name, copies)

            # ููููุงุช ุฃุฎุฑู
            else:
                win32api.ShellExecute(
                    0, "print", file_path,
                    f'/d:"{printer_name}"', ".", 0
                )
                return {"success": True, "printer": printer_name}

        except Exception as e:
            return {"success": False, "error": str(e)}

    def print_raw_data(self, data: bytes, printer_name: str,
                      doc_name: str = "INTEGRA Print") -> bool:
        """ุทุจุงุนุฉ ุจูุงูุงุช ุฎุงู (ููุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ)"""
        try:
            handle = win32print.OpenPrinter(printer_name)
            try:
                job = win32print.StartDocPrinter(handle, 1, (doc_name, None, "RAW"))
                win32print.StartPagePrinter(handle)
                win32print.WritePrinter(handle, data)
                win32print.EndPagePrinter(handle)
                win32print.EndDocPrinter(handle)
                return True
            finally:
                win32print.ClosePrinter(handle)
        except:
            return False

    def get_print_queue(self, printer_name: str) -> List[Dict]:
        """ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุทุจุงุนุฉ"""
        handle = win32print.OpenPrinter(printer_name)
        try:
            jobs = win32print.EnumJobs(handle, 0, 100, 1)
            return [{
                "id": job["JobId"],
                "document": job["pDocument"],
                "status": job["Status"],
                "pages": job["TotalPages"],
                "submitted": job["Submitted"]
            } for job in jobs]
        finally:
            win32print.ClosePrinter(handle)

    def cancel_job(self, printer_name: str, job_id: int) -> bool:
        """ุฅูุบุงุก ูููุฉ ุทุจุงุนุฉ"""
        handle = win32print.OpenPrinter(printer_name)
        try:
            win32print.SetJob(handle, job_id, 0, None,
                            win32print.JOB_CONTROL_DELETE)
            return True
        except:
            return False
        finally:
            win32print.ClosePrinter(handle)

    def _detect_type(self, info: dict) -> PrinterType:
        """ุงูุชุดุงู ููุน ุงูุทุงุจุนุฉ"""
        port = info.get('pPortName', '').lower()
        if 'usb' in port:
            return PrinterType.LOCAL
        elif 'bth' in port or 'bluetooth' in port:
            return PrinterType.BLUETOOTH
        elif '\\\\' in port or 'tcp' in port:
            return PrinterType.NETWORK
        else:
            return PrinterType.LOCAL

    def _get_status(self, status_code: int) -> str:
        """ุชุญููู ููุฏ ุงูุญุงูุฉ ููุต"""
        statuses = {
            0: "Ready",
            1: "Paused",
            2: "Error",
            4: "Pending Deletion",
            8: "Paper Jam",
            16: "Paper Out",
            32: "Manual Feed",
            64: "Paper Problem",
        }
        return statuses.get(status_code, "Unknown")
```

### Q2. Scanner Management (ุฅุฏุงุฑุฉ ุงููุงุณุญุงุช ุงูุถูุฆูุฉ)

```python
# core/devices/scanner/scanner_manager.py

import twain
from PIL import Image
from typing import List, Dict, Optional, Tuple
from dataclasses import dataclass
from enum import Enum

class ColorMode(Enum):
    BLACK_WHITE = "bw"
    GRAYSCALE = "gray"
    COLOR = "color"

class PaperSource(Enum):
    FLATBED = "flatbed"
    ADF = "adf"
    DUPLEX = "duplex"

@dataclass
class ScannerInfo:
    """ูุนูููุงุช ุงููุงุณุญ ุงูุถูุฆู"""
    name: str
    manufacturer: str
    has_adf: bool
    has_duplex: bool
    max_resolution: int

@dataclass
class ScanSettings:
    """ุฅุนุฏุงุฏุงุช ุงููุณุญ"""
    resolution: int = 300  # DPI
    color_mode: ColorMode = ColorMode.COLOR
    paper_source: PaperSource = PaperSource.FLATBED
    paper_size: str = "A4"
    brightness: int = 0  # -100 to 100
    contrast: int = 0    # -100 to 100
    auto_crop: bool = True

class ScannerManager:
    """ูุฏูุฑ ุงููุงุณุญุงุช ุงูุถูุฆูุฉ"""

    def __init__(self):
        self.source_manager = None
        self.current_source = None

    def get_available_scanners(self) -> List[ScannerInfo]:
        """ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงููุงุณุญุงุช ุงููุชุงุญุฉ"""
        scanners = []

        self.source_manager = twain.SourceManager(0)
        try:
            sources = self.source_manager.GetSourceList()
            for source_name in sources:
                # ูุชุญ ุงููุตุฏุฑ ููุญุตูู ุนูู ุงููุนูููุงุช
                source = self.source_manager.OpenSource(source_name)
                if source:
                    try:
                        caps = source.GetCapability(twain.ICAP_SUPPORTEDSIZES)
                        has_adf = self._check_adf(source)

                        scanners.append(ScannerInfo(
                            name=source_name,
                            manufacturer=self._get_manufacturer(source_name),
                            has_adf=has_adf,
                            has_duplex=self._check_duplex(source),
                            max_resolution=self._get_max_resolution(source)
                        ))
                    finally:
                        source.destroy()
        finally:
            self.source_manager.destroy()
            self.source_manager = None

        return scanners

    def scan(self, scanner_name: str = None,
            settings: ScanSettings = None,
            output_path: str = None) -> Dict:
        """ูุณุญ ุถูุฆู"""
        if settings is None:
            settings = ScanSettings()

        try:
            self.source_manager = twain.SourceManager(0)

            # ุงุฎุชูุงุฑ ุงููุงุณุญ
            if scanner_name:
                self.current_source = self.source_manager.OpenSource(scanner_name)
            else:
                self.current_source = self.source_manager.OpenSource()

            if not self.current_source:
                return {"success": False, "error": "ูู ูุชู ุงุฎุชูุงุฑ ูุงุณุญ ุถูุฆู"}

            # ุชุทุจูู ุงูุฅุนุฏุงุฏุงุช
            self._apply_settings(settings)

            # ุจุฏุก ุงููุณุญ
            self.current_source.RequestAcquire(0, 0)

            # ุงูุญุตูู ุนูู ุงูุตูุฑุฉ
            images = []
            while True:
                try:
                    (handle, more) = self.current_source.XferImageNatively()
                    img = twain.DIBToBMFile(handle)
                    pil_img = Image.open(io.BytesIO(img))

                    # Auto-crop ุฅุฐุง ููุนู
                    if settings.auto_crop:
                        pil_img = self._auto_crop(pil_img)

                    images.append(pil_img)

                    if not more:
                        break
                except twain.excDSTransferCancelled:
                    break

            # ุญูุธ ุงูุตูุฑ
            if output_path:
                if len(images) == 1:
                    images[0].save(output_path)
                else:
                    # ุญูุธ ูู PDF ูุชุนุฏุฏ ุงูุตูุญุงุช
                    if output_path.lower().endswith('.pdf'):
                        images[0].save(
                            output_path, "PDF",
                            save_all=True,
                            append_images=images[1:]
                        )
                    else:
                        # ุญูุธ ูุตูุฑ ูููุฑุฏุฉ
                        for i, img in enumerate(images):
                            name, ext = output_path.rsplit('.', 1)
                            img.save(f"{name}_{i+1}.{ext}")

            return {
                "success": True,
                "pages_scanned": len(images),
                "output_path": output_path,
                "images": images if not output_path else None
            }

        except Exception as e:
            return {"success": False, "error": str(e)}

        finally:
            if self.current_source:
                self.current_source.destroy()
            if self.source_manager:
                self.source_manager.destroy()

    def scan_to_pdf(self, scanner_name: str = None,
                   output_path: str = "scan.pdf",
                   settings: ScanSettings = None) -> Dict:
        """ูุณุญ ูุจุงุดุฑ ุฅูู PDF"""
        result = self.scan(scanner_name, settings)

        if result["success"] and result.get("images"):
            images = result["images"]
            images[0].save(
                output_path, "PDF",
                save_all=True,
                append_images=images[1:] if len(images) > 1 else []
            )
            result["output_path"] = output_path

        return result

    def batch_scan(self, scanner_name: str = None,
                  pages: int = None,
                  output_folder: str = "scans",
                  settings: ScanSettings = None) -> Dict:
        """ูุณุญ ุฏูุนู ูุนุฏุฉ ุตูุญุงุช"""
        if settings is None:
            settings = ScanSettings()

        # ุงุณุชุฎุฏุงู ADF ุฅุฐุง ูุชุงุญ
        settings.paper_source = PaperSource.ADF

        results = []
        page_count = 0

        while pages is None or page_count < pages:
            result = self.scan(scanner_name, settings)

            if not result["success"]:
                break

            for img in result.get("images", []):
                page_count += 1
                output_path = f"{output_folder}/page_{page_count:03d}.png"
                img.save(output_path)
                results.append(output_path)

            # ุฅุฐุง ูู ููู ููุงู ุงููุฒูุฏ ูู ADF
            if result.get("pages_scanned", 0) == 0:
                break

        return {
            "success": True,
            "total_pages": page_count,
            "files": results
        }

    def _apply_settings(self, settings: ScanSettings):
        """ุชุทุจูู ุฅุนุฏุงุฏุงุช ุงููุณุญ"""
        # ุงูุฏูุฉ
        self.current_source.SetCapability(
            twain.ICAP_XRESOLUTION,
            twain.TWTY_FIX32,
            settings.resolution
        )
        self.current_source.SetCapability(
            twain.ICAP_YRESOLUTION,
            twain.TWTY_FIX32,
            settings.resolution
        )

        # ูุถุน ุงูุฃููุงู
        color_map = {
            ColorMode.BLACK_WHITE: twain.TWPT_BW,
            ColorMode.GRAYSCALE: twain.TWPT_GRAY,
            ColorMode.COLOR: twain.TWPT_RGB
        }
        self.current_source.SetCapability(
            twain.ICAP_PIXELTYPE,
            twain.TWTY_UINT16,
            color_map[settings.color_mode]
        )

        # ูุตุฏุฑ ุงููุฑู
        if settings.paper_source == PaperSource.ADF:
            self.current_source.SetCapability(
                twain.CAP_FEEDERENABLED,
                twain.TWTY_BOOL,
                True
            )

    def _auto_crop(self, image: Image) -> Image:
        """ูุต ุชููุงุฆู ููุญูุงู ุงูุจูุถุงุก"""
        # ุชุญููู ูู grayscale ููุชุญููู
        gray = image.convert('L')

        # ุงูุจุญุซ ุนู ุงูุญุฏูุฏ
        bbox = gray.getbbox()

        if bbox:
            # ุฅุถุงูุฉ ูุงูุด ุตุบูุฑ
            margin = 10
            bbox = (
                max(0, bbox[0] - margin),
                max(0, bbox[1] - margin),
                min(image.width, bbox[2] + margin),
                min(image.height, bbox[3] + margin)
            )
            return image.crop(bbox)

        return image

    def _check_adf(self, source) -> bool:
        """ูุญุต ูุฌูุฏ ADF"""
        try:
            return source.GetCapability(twain.CAP_FEEDERENABLED) is not None
        except:
            return False

    def _check_duplex(self, source) -> bool:
        """ูุญุต ูุฌูุฏ Duplex"""
        try:
            return source.GetCapability(twain.CAP_DUPLEX) is not None
        except:
            return False

    def _get_max_resolution(self, source) -> int:
        """ุงูุญุตูู ุนูู ุฃูุตู ุฏูุฉ"""
        try:
            resolutions = source.GetCapability(twain.ICAP_XRESOLUTION)
            if isinstance(resolutions, list):
                return max(resolutions)
            return 600  # ุงูุชุฑุงุถู
        except:
            return 600
```

### Q3. Bluetooth Management (ุฅุฏุงุฑุฉ ุงูุจููุชูุซ)

```python
# core/devices/bluetooth/bluetooth_manager.py

import asyncio
from bleak import BleakScanner, BleakClient
from typing import List, Dict, Optional
from dataclasses import dataclass

@dataclass
class BluetoothDevice:
    """ุฌูุงุฒ ุจููุชูุซ"""
    name: str
    address: str
    rssi: int  # ููุฉ ุงูุฅุดุงุฑุฉ
    is_paired: bool
    device_type: str  # printer, scanner, other

class BluetoothManager:
    """ูุฏูุฑ ุงูุจููุชูุซ"""

    def __init__(self):
        self.known_devices: Dict[str, BluetoothDevice] = {}

    async def discover_devices(self, timeout: int = 10) -> List[BluetoothDevice]:
        """ุงูุชุดุงู ุฃุฌูุฒุฉ ุงูุจููุชูุซ"""
        devices = []

        discovered = await BleakScanner.discover(timeout=timeout)

        for device in discovered:
            bt_device = BluetoothDevice(
                name=device.name or "Unknown",
                address=device.address,
                rssi=device.rssi,
                is_paired=device.address in self.known_devices,
                device_type=self._detect_device_type(device.name)
            )
            devices.append(bt_device)

        return devices

    async def pair_device(self, address: str) -> bool:
        """ุงูุงูุชุฑุงู ุจุฌูุงุฒ"""
        try:
            async with BleakClient(address) as client:
                if client.is_connected:
                    # ุญูุธ ุงูุฌูุงุฒ
                    device = await self._get_device_info(client, address)
                    self.known_devices[address] = device
                    return True
        except Exception as e:
            print(f"Pairing error: {e}")
            return False

    async def connect(self, address: str) -> Optional[BleakClient]:
        """ุงูุงุชุตุงู ุจุฌูุงุฒ"""
        try:
            client = BleakClient(address)
            await client.connect()
            return client
        except:
            return None

    async def disconnect(self, client: BleakClient):
        """ูุทุน ุงูุงุชุตุงู"""
        if client.is_connected:
            await client.disconnect()

    def get_known_devices(self) -> List[BluetoothDevice]:
        """ุงูุฃุฌูุฒุฉ ุงููุนุฑููุฉ"""
        return list(self.known_devices.values())

    def forget_device(self, address: str):
        """ูุณูุงู ุฌูุงุฒ"""
        if address in self.known_devices:
            del self.known_devices[address]

    def _detect_device_type(self, name: str) -> str:
        """ุงูุชุดุงู ููุน ุงูุฌูุงุฒ"""
        if not name:
            return "other"

        name_lower = name.lower()
        if any(x in name_lower for x in ['printer', 'print', 'hp', 'canon', 'brother', 'epson']):
            return "printer"
        elif any(x in name_lower for x in ['scanner', 'scan']):
            return "scanner"
        else:
            return "other"
```

### Q4. Database Schema

```sql
-- ุฌุฏูู ุงูุทุงุจุนุงุช ุงูููุถูุฉ
CREATE TABLE favorite_printers (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    printer_name VARCHAR(255) NOT NULL,
    is_default BOOLEAN DEFAULT FALSE,
    settings JSONB,  -- ุฅุนุฏุงุฏุงุช ุงูุทุจุงุนุฉ ุงูุงูุชุฑุงุถูุฉ
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(user_id, printer_name)
);

-- ุฌุฏูู ุงููุงุณุญุงุช ุงูููุถูุฉ
CREATE TABLE favorite_scanners (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    scanner_name VARCHAR(255) NOT NULL,
    default_settings JSONB,  -- ุฅุนุฏุงุฏุงุช ุงููุณุญ ุงูุงูุชุฑุงุถูุฉ
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(user_id, scanner_name)
);

-- ุฌุฏูู ุฃุฌูุฒุฉ ุงูุจููุชูุซ ุงููุนุฑููุฉ
CREATE TABLE known_bluetooth_devices (
    id SERIAL PRIMARY KEY,
    address VARCHAR(20) NOT NULL UNIQUE,
    name VARCHAR(255),
    device_type VARCHAR(50),
    last_connected TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);

-- ุฌุฏูู ุณุฌู ุงููุณุญ ุงูุถูุฆู
CREATE TABLE scan_history (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    scanner_name VARCHAR(255),
    pages_count INTEGER,
    output_path TEXT,
    settings JSONB,
    scanned_at TIMESTAMP DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_fav_printers_user ON favorite_printers(user_id);
CREATE INDEX idx_fav_scanners_user ON favorite_scanners(user_id);
CREATE INDEX idx_scan_history_user ON scan_history(user_id, scanned_at DESC);
```

### Q5. ูููู ุงููููุงุช

```
core/devices/
โโโ __init__.py
โโโ printer/
โ   โโโ __init__.py
โ   โโโ printer_manager.py      # ุฅุฏุงุฑุฉ ุงูุทุงุจุนุงุช
โ   โโโ print_preview.py        # ูุนุงููุฉ ุงูุทุจุงุนุฉ
โ   โโโ print_queue.py          # ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
โ   โโโ thermal_printer.py      # ุทุงุจุนุงุช ุญุฑุงุฑูุฉ (ูุณุชูุจูู)
โโโ scanner/
โ   โโโ __init__.py
โ   โโโ scanner_manager.py      # ุฅุฏุงุฑุฉ ุงููุงุณุญุงุช
โ   โโโ twain_wrapper.py        # ุบูุงู TWAIN
โ   โโโ wia_wrapper.py          # ุบูุงู WIA
โ   โโโ scan_processor.py       # ูุนุงูุฌุฉ ุงูุตูุฑ ุงูููุณูุญุฉ
โโโ bluetooth/
โ   โโโ __init__.py
โ   โโโ bluetooth_manager.py    # ุฅุฏุงุฑุฉ ุงูุจููุชูุซ
โ   โโโ device_pairing.py       # ุงูุงูุชุฑุงู ุจุงูุฃุฌูุฒุฉ
โโโ common/
    โโโ __init__.py
    โโโ device_detector.py      # ุงูุชุดุงู ุงูุฃุฌูุฒุฉ
    โโโ device_status.py        # ุญุงูุฉ ุงูุฃุฌูุฒุฉ

ui/dialogs/devices/
โโโ __init__.py
โโโ printer_dialog.py           # ูุงูุฐุฉ ุงุฎุชูุงุฑ ุงูุทุงุจุนุฉ
โโโ print_settings_dialog.py    # ุฅุนุฏุงุฏุงุช ุงูุทุจุงุนุฉ
โโโ scanner_dialog.py           # ูุงูุฐุฉ ุงููุณุญ ุงูุถูุฆู
โโโ scan_preview_dialog.py      # ูุนุงููุฉ ุงููุณุญ
โโโ bluetooth_dialog.py         # ุฅุฏุงุฑุฉ ุงูุจููุชูุซ
```

### Q6. ุงููุฑุงุญู ุงูุชูููุฐูุฉ

```
Q1 โ Printer Discovery (ุงูุชุดุงู ุงูุทุงุจุนุงุช) - Local + Network
Q2 โ Print Preview & Settings (ุงููุนุงููุฉ ูุงูุฅุนุฏุงุฏุงุช)
Q3 โ Scanner Discovery (ุงูุชุดุงู ุงููุงุณุญุงุช) - TWAIN/WIA
Q4 โ Scan to PDF/Image (ุงููุณุญ ุฅูู PDF/ุตูุฑุฉ)
Q5 โ Batch Scanning (ุงููุณุญ ุงูุฏูุนู) - ADF Support
Q6 โ Bluetooth Management (ุฅุฏุงุฑุฉ ุงูุจููุชูุซ)
Q7 โ Integration with PDF Studio (ุชูุงูู ูุน Track P)
```

### Q7. ุงูุชูุณุนุงุช ุงููุณุชูุจููุฉ (ูุญุฌูุฒุฉ)

| ุงูุฌูุงุฒ | ุงูุงุณุชุฎุฏุงู | ุงููุฑุญูุฉ |
|--------|-----------|---------|
| Thermal Printers | ุทุจุงุนุฉ ููุงุชูุฑ POS | ูุชูุฏูุฉ |
| Barcode Scanner | ูุฑุงุกุฉ ุจุงุฑููุฏ ุงูููุชุฌุงุช | ูุชูุฏูุฉ |
| Label Printer | ุทุจุงุนุฉ ููุตูุงุช | ูุชูุฏูุฉ |
| Card Reader | ูุฑุงุกุฉ ุจุทุงูุงุช ุงูููุธููู | ูุชูุฏูุฉ |
| Signature Pad | ุงูุชูููุน ุงูุฅููุชุฑููู | ูุชูุฏูุฉ |
| Digital Scale | ุงูููุงุฒูู ุงูุฅููุชุฑูููุฉ | ูุชูุฏูุฉ |

---

## ุงููุญูุฑ R: ุชูุงูู ุชุทุจููุงุช ุณุทุญ ุงูููุชุจ (Desktop Apps Integration) โ **ููุชูู**

> **ุชุงุฑูุฎ ุงูุงูุชูุงู:** 6 ูุจุฑุงูุฑ 2026

### ูุธุฑุฉ ุนุงูุฉ

ุชูุงูู INTEGRA ูุน ุชุทุจููุงุช ุณุทุญ ุงูููุชุจ ุงูุดุงุฆุนุฉ:

| ุงูุชุทุจูู | ุงูุงุณุชุฎุฏุงู | ุงูุญุงูุฉ |
|---------|-----------|--------|
| **WhatsApp Desktop** | ุฅุฑุณุงู ุฅุดุนุงุฑุงุช/ุชูุงุฑูุฑ ููุนููุงุก ูุงูููุธููู | โ ููุชูู |
| **Telegram Bot** | Bot ููุชูุจููุงุช ูุงูุงุณุชุนูุงู ุนู ุงูุจูุงูุงุช | โ ููุชูู |
| **Microsoft Teams** | ุชูุงูู ูุน ุจูุฆุฉ ุงูุนูู ุงููุคุณุณูุฉ (Webhooks + Adaptive Cards) | โ ููุชูู |
| **Desktop Automation** | ุฃุชูุชุฉ ุณุทุญ ุงูููุชุจ (Win32/Linux) | โ ููุชูู |

### R1. WhatsApp Desktop Integration โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-06)
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/desktop_apps/whatsapp/whatsapp_manager.py` โ
- **ุงูููุฒุงุช:**
  - ุฅุฑุณุงู ุฑุณุงุฆู ูุตูุฉ ุนุจุฑ WhatsApp Web URL โ
  - ุฏุนู WhatsApp Business API โ
  - ููุงูุจ ุฑุณุงุฆู ุฌุงูุฒุฉ (ุฑุงุชุจุ ุฅุฌุงุฒุฉุ ูููุฉุ ุชูุฑูุฑ) โ
  - ุฅุฏุงุฑุฉ ุฌูุงุช ุงูุงุชุตุงู โ
  - ูุงุฆูุฉ ุฅุฑุณุงู ูุน ุฅุนุงุฏุฉ ุงููุญุงููุฉ โ
  - ุฅุฑุณุงู ุฌูุงุนู โ

### R2. Telegram Bot Integration โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-06)
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/desktop_apps/telegram/telegram_bot.py` โ
- **ุงูููุฒุงุช:**
  - ุฅุนุฏุงุฏ ูุฅุฏุงุฑุฉ ุงูุจูุช โ
  - ุฅุฑุณุงู ุชูุจููุงุช ุจูุณุชููุงุช ุฃููููุฉ โ
  - ุฃูุงูุฑ ูุฏูุฌุฉ (/salary, /leave, /tasks, /approve, /reject) โ
  - ุฃุฒุฑุงุฑ ุชูุงุนููุฉ ููููุงููุงุช (Inline Keyboard) โ
  - ุฅุฑุณุงู ูููุงุช ูุตูุฑ โ
  - ุจุซ ุฑุณุงุฆู ููู ุงููุญุงุฏุซุงุช โ
  - ุชูุฌูู ุงูุชูุจููุงุช ุญุณุจ ุงูุฃููููุฉ โ

### R3. Microsoft Teams Integration โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-06)
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/desktop_apps/teams/teams_connector.py` โ
- **ุงูููุฒุงุช:**
  - Incoming Webhooks ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช โ
  - Adaptive Cards ูููุญุชูู ุงูุบูู โ
  - ุจุทุงูุงุช ูุณุจูุฉ ุงูุจูุงุก (ุชูุจููุ ููุงููุฉุ ุชูุฑูุฑุ ุญุงูุฉุ ูููุฉ) โ
  - AdaptiveCardBuilder ูุจูุงุก ุจุทุงูุงุช ูุฎุตุตุฉ โ
  - ุชูุฌูู ุงููููุงุช ุญุณุจ ุงูููุน โ
  - ุจุซ ููู ุงููููุงุช โ

### R4. Desktop Automation โ **ููุชูู**
- **ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ (2026-02-06)
- **ุงููููุงุช ุงููููุฐุฉ:**
  - `core/desktop_apps/automation/desktop_automation.py` โ
- **ุงูููุฒุงุช:**
  - ุฅุฏุงุฑุฉ ุงูููุงูุฐ (ุจุญุซุ ุชุฑููุฒุ ุชุตุบูุฑุ ุชูุจูุฑุ ุฅุบูุงู) โ
  - ุฏุนู Windows (Win32 API) ู Linux (wmctrl/xdotool) โ
  - ุชุดุบูู ููุญุต ุงูุชุทุจููุงุช โ
  - ุนูููุงุช ุงูุญุงูุธุฉ (ูุณุฎ/ูุตู) โ
  - ุงูุชูุงุท ููุทุงุช ุงูุดุงุดุฉ โ
  - ูุญุฑู ุณููุงุฑูููุงุช ุงูุฃุชูุชุฉ (Workflow Engine) โ
  - ุชุณุฌูู ุงูุชุทุจููุงุช ูุงููุณุงุฑุงุช โ

---

## ๐ ุฃููุงุฑ ุฅุจุฏุงุนูุฉ ูุชุทููุฑ ุงูููุธููุฉ

### 1. Smart Inbox (ุตูุฏูู ูุงุฑุฏ ุฐูู)
- ุชุตููู ุชููุงุฆู ููุฅููููุงุช
- ูุตู ุงูุฅููููุงุช ุงููููุฉ ุนู ุงูุนุงุฏูุฉ
- ุนุฑุถ ููุฎุต AI ููู ุฅูููู ูู ุงููุงุฆูุฉ

### 2. Daily Briefing (ููุฎุต ูููู)
- ุนูุฏ ูุชุญ ุงูุจุฑูุงูุฌ ุตุจุงุญุงู
- ููุฎุต: ุฅููููุงุช ุฌุฏูุฏุฉุ ููุงู ุงููููุ ููุงุนูุฏ
- AI ูุญุฏุฏ ุฃูู 3 ุฃุดูุงุก ุชุญุชุงุฌ ุงูุชุจุงู

### 3. Smart Compose (ูุชุงุจุฉ ุฐููุฉ)
- AI ูููู ุงูุฌูู ุฃุซูุงุก ุงููุชุงุจุฉ
- ููุงูุจ ุฑุฏูุฏ ุฌุงูุฒุฉ ุญุณุจ ุงูุณูุงู
- ุงูุชุฑุงุญ ูุจุฑุฉ ุงูุฑุฏ (ุฑุณูู/ูุฏู)

### 4. Context Switching (ุชุจุฏูู ุงูุณูุงู)
- AI ูุชุฐูุฑ ุขุฎุฑ ุดูุก ููุช ุชุนูู ุนููู
- ุนูุฏ ุงูุนูุฏุฉ ูุณุฃู "ูู ุชุฑูุฏ ุฅููุงู Xุ"

### 5. Proactive Assistant (ูุณุงุนุฏ ุงุณุชุจุงูู)
- AI ููุจูู ูุจู ููุงุช ุงูููุงุนูุฏ
- ููุชุฑุญ ููุช ููุงุณุจ ููููุงู ุงูุตุนุจุฉ
- ููุจู ุฅุฐุง ูุงู ุฌุฏููู ูุฒุฏุญู

### 6. Voice Control (ุงูุชุญูู ุงูุตูุชู)
- "ุฃูุดุฆ ูููุฉ: ุชุณููุฉ ุฅุฌุงุฒุฉ ุฃุญูุฏ"
- "ูุง ููุงุนูุฏู ุงููููุ"
- "ุฑุฏ ุนูู ุขุฎุฑ ุฅูููู ุจุงูููุงููุฉ"

### 7. Natural Language Processing
- "ุฐูุฑูู ุฃุณูู ุงูุชุณููุฉ ุจูุฑุฉ ุงูุณุงุนุฉ 10"
- "ุฃุฌู ุงูุงุฌุชูุงุน ุณุงุนุฉ"
- "ูุฑููู ุฅููููุงุช HR ูู ูุฐุง ุงูุฃุณุจูุน"

### 8. Smart Templates (ููุงูุจ ุฐููุฉ)
- AI ูุฎุชุงุฑ ุงููุงูุจ ุงูููุงุณุจ
- ูููุฃ ุงูุจูุงูุงุช ุชููุงุฆูุงู
- ูุชุนูู ุงูุชุนุฏููุงุช ุงููุชูุฑุฑุฉ

### 9. Anomaly Detection (ุงูุชุดุงู ุงูุดุฐูุฐ)
- ุชูุจูู ุฅุฐุง ูุงูุช ููู ุงูุชุณููุฉ ุบูุฑ ุนุงุฏูุฉ
- ููุงุฑูุฉ ูุน ุชุณููุงุช ุณุงุจูุฉ
- ุชุญุฐูุฑ ูู ุฃุฎุทุงุก ูุญุชููุฉ

### 10. Report Generation (ุชูููุฏ ุงูุชูุงุฑูุฑ)
- "ุฃุนุทูู ุชูุฑูุฑ ุงูููุงู ูุฐุง ุงูุดูุฑ"
- "ูู ุชุณููุฉ ุนูููุง ุงูุฃุณุจูุน ุงููุงุถูุ"
- ุชูุงุฑูุฑ PDF/Excel ุชููุงุฆูุฉ

### 11. Integration Hub (ูุฑูุฒ ุงูุชูุงูู)
- API ููุชูุงูู ูุน ุฃูุธูุฉ ุฃุฎุฑู
- Webhooks ููุฃุญุฏุงุซ
- ุชูุงูู ูุน Microsoft Teams

### 12. Mobile Notifications (ุฅุดุนุงุฑุงุช ุงูุฌูุงู)
- ุฅุดุนุงุฑ ุนูู ุงูุฌูุงู ููุฃููุฑ ุงูุนุงุฌูุฉ
- ููุงููุฉ ุณุฑูุนุฉ ูู ุงูุฌูุงู
- ุนุฑุถ ููุฎุต ุงูููุงู

---

### ุงููุฑุญูุฉ 10: ููุฏููู ุงูููุงู (Tasks Module) โ **ููุชูู** (2026-02-04)
```
H1 โ Task Data Models + Database Schema โ (567 ุณุทุฑ models + 300 ุณุทุฑ SQL + 905 ุณุทุฑ repository)
H2 โ Task List UI (ูุงุฆูุฉ ุงูููุงู) โ (502 ุณุทุฑ task_list_screen)
H3 โ Task Board (Kanban View) โ (494 ุณุทุฑ kanban_board ูุน Drag&Drop)
H4 โ Task-Email Integration โ (205 ุณุทุฑ email_integration + 302 ุณุทุฑ calendar_sync)
H5 โ Recurring Tasks โ (302 ุณุทุฑ recurrence_manager)
H6 โ Task AI Agent โ (618 ุณุทุฑ task_agent)
```
**20 ููู Python ูู modules/tasks/**

### ุงููุฑุญูุฉ 11: ููุฏููู ุงูุชูููู (Calendar Module) โ **ููุชูู** (2026-02-04)
```
I1 โ Calendar Data Models + Database Schema โ (757 ุณุทุฑ models + 406 ุณุทุฑ SQL + 827 ุณุทุฑ repository)
I2 โ Month View (ุนุฑุถ ุดูุฑู) โ (339 ุณุทุฑ)
I3 โ Week View (ุนุฑุถ ุฃุณุจูุนู) โ (363 ุณุทุฑ)
I4 โ Day View (ุนุฑุถ ูููู) โ (ููู day_view.py ููุฌูุฏ)
I5 โ Task-Calendar Sync โ (task_calendar_sync.py)
I6 โ Outlook Calendar Sync โ (outlook_calendar_sync.py)
I7 โ Calendar AI Agent โ (736 ุณุทุฑ calendar_agent)
```
**19 ููู Python ูู modules/calendar/ + Agenda View ุฅุถุงูู**

### ุงููุฑุญูุฉ 12: ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุฐูู (Smart Notifications) โ **ููุชูู**
```
J1 โ Notification Models + Database โ
J2 โ Notification Bell Widget (ุฃููููุฉ ุงูุฌุฑุณ) โ
J3 โ Notification Center Page โ
J4 โ Quick Actions from Notifications โ
J5 โ AI Priority Detection โ
J6 โ Push Notifications (Desktop) โ
```
**ุชุงุฑูุฎ ุงูุงูุชูุงู:** 4 ูุจุฑุงูุฑ 2026

### ุงููุฑุญูุฉ 13: ููุธููุฉ ูููุงุก AI ุงููุชูุงููุฉ (AI Orchestration) โ **ููุชูู**
```
K1 โ Coordinator Agent (ุงูููุณู ุงูุฑุฆูุณู) โ
K2 โ Task Agent (ูููู ุงูููุงู - ุชูุงูู) โ
K3 โ Form Agent (ูููู ุงูููุงุฐุฌ) โ
K4 โ Action Agent (ูููู ุงูุฅุฌุฑุงุกุงุช) โ
K5 โ Learning Agent (ูููู ุงูุชุนูู) โ
K6 โ Workflow Engine โ
```
**ุชุงุฑูุฎ ุงูุงูุชูุงู:** 4 ูุจุฑุงูุฑ 2026

### ุงููุฑุญูุฉ 14: ูุตูู ุงูุชูุงุฑูุฑ ูุงูููุงุฐุฌ (Report & Form Designer) โ **ููุชูู** (2026-02-04)
```
L1 โ Report Engine (ูุญุฑู ุงูุชูุงุฑูุฑ) โ (754 ุณุทุฑ report_engine - 36 ุฏุงูุฉุ 9 ููุงุณุงุช)
L2 โ Visual Report Designer (ุงููุตูู ุงููุฑุฆู) โ (788 ุณุทุฑ report_designer_window + 862 ุณุทุฑ design_canvas)
L3 โ Form Builder (ููุดุฆ ุงูููุงุฐุฌ) โ (520 ุณุทุฑ form_builder_window + 757 ุณุทุฑ form_canvas)
L4 โ Template Engine (ูุญุฑู ุงูููุงูุจ) โ (template_engine.py)
L5 โ Data Binding (ุฑุจุท ุงูุจูุงูุงุช) โ (data_binding.py)
L6 โ Preview & Print (ูุนุงููุฉ ูุทุจุงุนุฉ) โ (600 ุณุทุฑ preview.py)
L7 โ Built-in Templates (ููุงูุจ ุฌุงูุฒุฉ) โ (builtin_templates.py + templates/reports/ + templates/forms/)
```
**+ PDF Generator (801 ุณุทุฑ) + Excel Generator (703 ุณุทุฑ) + Word Generator (645 ุณุทุฑ)**

### ุงููุฑุญูุฉ 15: ุงูุฑุจุท ูุน Power BI Desktop (BI Connector) โ **ููุชูู - 4 ูุจุฑุงูุฑ 2026**
```
M1 โ Connection Setup (ุฅุนุฏุงุฏ ุงูุงุชุตุงู) โ
M2 โ BI Views (ุนุฑูุถ ุชุญููููุฉ ูุญุณููุฉ) โ
M3 โ Auto Export (ุชุตุฏูุฑ ุชููุงุฆู) โ
M4 โ Pre-built Templates (ููุงูุจ .pbix ุฌุงูุฒุฉ) โ
M5 โ BI Management UI (ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ) โ
M6 โ Documentation (ุงูุชูุซูู) โ
```

### ุงููุฑุญูุฉ 16: ุงููุณุงุนุฏ ุงูุฐูู ุงููุชูุงูู (AI Copilot) โ **ููุชูู**
```
N1 โ Knowledge Engine (ูุญุฑู ุงููุนุฑูุฉ) โ
N2 โ Chat Interface (ูุงุฌูุฉ ุงููุญุงุฏุซุฉ - Sidebar + Window) โ
N3 โ Context Awareness (ุงููุนู ุจุงูุณูุงู) โ
N4 โ Action Sandbox (ุจูุฆุฉ ุงููุณูุฏุงุช) โ
N5 โ Approval Workflow (ุณูุฑ ุงูููุงููุงุช) โ
N6 โ Learning System (ูุธุงู ุงูุชุนูู) โ
N7 โ Audit & History (ุงูุณุฌู ูุงูุชุงุฑูุฎ) โ
```

### ุงููุฑุญูุฉ 17: ุงููุนู ุงูุฒููู ุงููุงุฆู (Time Intelligence) โ **ููุชูู - 5 ูุจุฑุงูุฑ 2026**
```
O1 โ System Time Core (ููุงุฉ ุงูููุช) - Gregorian + Hijri โ
O2 โ Working Calendar (ุชูููู ุงูุนูู) - ุฅุนุฏุงุฏุงุช ุงูุฏููุฉ ููุณุชุญูุงุช โ
O3 โ Natural Language Parser (ุงููุญูู ุงููุบูู) - "ุจุนุฏ ุงูุนูุฏ" โ
O4 โ Time Analytics (ุงูุชุญูููุงุช ุงูุฒูููุฉ) - YoY, MoM, QoQ, YTD โ
O5 โ Productivity Learning (ุชุนูู ุงูุฅูุชุงุฌูุฉ) - ุฃููุงุท ุงููุณุชุฎุฏู โ
O6 โ Predictive Deadlines (ุชููุน ุงูุชุฃุฎูุฑ) - ุชูุจููุงุช ูุจูุฑุฉ โ
O7 โ Auto-Rescheduling (ุงูุฌุฏููุฉ ุงูุฐููุฉ) - ุฅุนุงุฏุฉ ุชุฑุชูุจ ุชููุงุฆู โ
O8 โ Time Triggers (ุงููุญูุฒุงุช ุงูุฒูููุฉ) - ุฃุญุฏุงุซ ุชููุงุฆูุฉ โ
```

### ุงููุฑุญูุฉ 18: ูุฏูุฑ ุงููููุงุช ุงูุฐูู (Smart File Manager) โ **ููุชูู** (2026-02-05)
```
P1 โ Excel AI Engine (ูุญุฑู Excel ุงูุฐูู) - Smart Import, Cleaning, Mapping โ
P2 โ PDF AI Studio (ุงุณุชูุฏูู PDF) - Split, Merge, OCR Arabic+English โ
P3 โ Image Tools (ุฃุฏูุงุช ุงูุตูุฑ) - Resize, Convert, Compress, Batch โ
P4 โ Word Engine (ูุญุฑู Word) - Read, Write, Convert โ
P5 โ File Browser (ูุณุชูุดู ุงููููุงุช) - Dual Pane, Tags, Search โ
P6 โ Cloud Integration (ุงูุชุฎุฒูู ุงูุณุญุงุจู) - Google Drive, OneDrive, Dropbox โ
P7 โ Attachments (ุงููุฑููุงุช) - Hybrid Storage, Versioning โ
P8 โ AI Copilot Integration (ุชูุงูู ุงูููุจุงูููุช) - ุฃูุงูุฑ ุทุจูุนูุฉ ูููููุงุช โ
```

### ุงููุฑุญูุฉ 19: ุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ ูุงูุทุงุจุนุงุช (Device Manager) โ **ููุชูู** (2026-02-06)
```
Q1 โ Printer Discovery (ุงูุชุดุงู ุงูุทุงุจุนุงุช) โ (460 ุณุทุฑ printer_discovery)
Q2 โ Print Preview & Settings (ุงููุนุงููุฉ ูุงูุฅุนุฏุงุฏุงุช) โ (502 ุณุทุฑ print_manager)
Q3 โ Scanner Discovery (ุงูุชุดุงู ุงููุงุณุญุงุช) โ (495 ุณุทุฑ scanner_discovery - TWAIN/WIA/SANE)
Q4 โ Scan to PDF/Image (ุงููุณุญ ุฅูู PDF/ุตูุฑุฉ) โ (765 ุณุทุฑ scan_engine)
Q5 โ Batch Scanning (ุงููุณุญ ุงูุฏูุนู) โ (batch_scanner.py - ADF Support)
Q6 โ Bluetooth Management (ุฅุฏุงุฑุฉ ุงูุจููุชูุซ) โ (701 ุณุทุฑ bluetooth_manager)
Q7 โ Integration with PDF Studio (ุชูุงูู ูุน Track P) โ (558 ุณุทุฑ pdf_studio_bridge)
```
**ูุงูุฐุฉ ุงูููุฏููู: modules/device_manager/window/device_manager_window.py (85 ุณุทุฑ)**

### ุงููุฑุญูุฉ 20: ุชูุงูู ุชุทุจููุงุช ุณุทุญ ุงูููุชุจ (Desktop Apps) โ **ููุชูู - 6 ูุจุฑุงูุฑ 2026**
```
R1 โ WhatsApp Desktop Integration (Web URL + Business API) โ
R2 โ Telegram Bot Integration (Bot API + Inline Keyboards) โ
R3 โ Microsoft Teams Integration (Webhooks + Adaptive Cards) โ
R4 โ Desktop Automation (Win32 API + Linux + Workflows) โ
```

### ุงููุฑุญูุฉ 21: ุงูุชุฌุงุฑูุฉ (ูุณุชูุจููุฉ)
```
E1 โ Licensing System
E2 โ Auto-Update
E3 โ Installer
E4 โ Multi-Company
```

### ุงููุฑุญูุฉ 22: ุงูุชูุณุน (ูุณุชูุจููุฉ)
```
F1 โ API Layer
F2 โ Plugin System
F3 โ Cloud Version
F4 โ Mobile App
```

---

## ๐ ุชูุฑูุฑ ุงูุชุฏููู ุงูุดุงูู (8 ูุจุฑุงูุฑ 2026)

> **ุชู ุฅุฌุฑุงุก ุชุฏููู ุดุงูู ููู ููู ูู ุงููุดุฑูุน ูููุงุฑูุชู ุจุงูุฎุทุฉ**

### ุฅุญุตุงุฆูุงุช ุงููุดุฑูุน ุงููุนููุฉ

| ุงููููุงุณ | ุงููููุฉ |
|---------|--------|
| **ุฅุฌูุงูู ูููุงุช Python** | 519 ููู |
| **ุฅุฌูุงูู ุฃุณุทุฑ ุงูููุฏ** | 92,002 ุณุทุฑ |
| **ูููุงุช SQL** | 5 ูููุงุช (973 ุณุทุฑ) |
| **ูููุงุช ุจููุฏ ุญูููู (>200 ุณุทุฑ)** | 65+ ููู |
| **ุฃูุจุฑ ููู** | modules/tasks/repository/task_repository.py (905 ุณุทุฑ) |
| **ุฃูุซุฑ track ูููุงุช** | Track A - ุงูุจููุฉ ุงูุชุญุชูุฉ |

### ููุฎุต ุญุงูุฉ ูู ุงููุญุงูุฑ

| ุงููุญูุฑ | ุงููุตู | ุงููููุงุช | ุฃุณุทุฑ ุงูููุฏ | ุงูุญุงูุฉ |
|--------|-------|---------|-----------|--------|
| **A** | ุงูุจููุฉ ุงูุชุญุชูุฉ (A1-A10) | 30+ | ~6,500 | โ ููุชูู |
| **B** | ุงูุฐูุงุก ุงูุงุตุทูุงุนู (B1-B5) | 12+ | ~4,500 | โ ููุชูู |
| **C** | ููุฏููู ุงูุฅูููู (C1-C4) | 8+ | ~2,600 | โ ููุชูู |
| **D** | ุชุญุณููุงุช ุงูููุชุจุงุช (D1-D13) | 15+ | ~4,200 | โ ููุชูู |
| **G** | ุงูุฅูููู ุงููุชูุฏู (G1-G6) | 7 | ~2,800 | โ ููุชูู (8 ูุจุฑุงูุฑ 2026) |
| **H** | ููุฏููู ุงูููุงู (H1-H6) | 20 | ~4,800 | โ ููุชูู |
| **I** | ููุฏููู ุงูุชูููู (I1-I7) | 19 | ~4,700 | โ ููุชูู |
| **J** | ุงูุฅุดุนุงุฑุงุช ุงูุฐููุฉ (J1-J6) | 16 | ~3,400 | โ ููุชูู |
| **K** | ูููุงุก AI (K1-K6) | 8+ | ~3,800 | โ ููุชูู |
| **L** | ูุตูู ุงูุชูุงุฑูุฑ (L1-L7) | 15+ | ~7,500 | โ ููุชูู |
| **M** | Power BI (M1-M6) | 6 | ~2,100 | โ ููุชูู |
| **N** | AI Copilot (N1-N7) | 26 | ~5,200 | โ ููุชูู |
| **O** | ุงููุนู ุงูุฒููู (O1-O8) | 18 | ~3,100 | โ ููุชูู |
| **P** | ูุฏูุฑ ุงููููุงุช (P1-P8) | 22 | ~3,800 | โ ููุชูู |
| **Q** | ุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ (Q1-Q7) | 12 | ~4,500 | โ ููุชูู |
| **R** | ุชูุงูู ุณุทุญ ุงูููุชุจ (R1-R4) | 8+ | ~2,800 | โ ููุชูู |

### ูุง ูู ูููุฐ ุจุนุฏ

| ุงูุจูุฏ | ุงููุตู | ุงูููุงุญุธุงุช |
|-------|-------|---------|
| **E1-E4** | ุงููุฑุญูุฉ ุงูุชุฌุงุฑูุฉ | Licensing, Auto-Update, Installer, Multi-Company |
| **F1-F4** | ุงูุชูุณุน | API Layer, Plugin System, Cloud Version, Mobile App |
| **M2 SQL** | BI Views SQL files | ููู core/bi/sql/ ุบูุฑ ููุฌูุฏ - ุงูู Views ูู views_manager.py |

### ุชุตุญูุญุงุช ุงูุชูุซูู ุงูุชู ุชูุช

| ุงูุจูุฏ | ุงูุญุงูุฉ ุงููุฏููุฉ | ุงูุญุงูุฉ ุงูุตุญูุญุฉ | ุงูุณุจุจ |
|-------|-------------|-------------|--------|
| B1-B5 | โณ | โ ููุชูู | ุงููููุงุช ููุฌูุฏุฉ ููููุง ููุฏ ุญูููู (ollama_client, ai_service, agents) |
| C1-C4 | โณ | โ ููุชูู | outlook_connector (696 ุณุทุฑ), email_cache (527 ุณุทุฑ), email_panel (591 ุณุทุฑ) |
| H1-H6 | ๐ด ุฌุฏูุฏ | โ ููุชูู | 20 ููู Python + SQL schema - task_repository (905 ุณุทุฑ) |
| I1-I7 | โ (ุจุฏูู ุชูุงุตูู) | โ ููุชูู | 19 ููู + 4 views + sync + calendar_agent (736 ุณุทุฑ) |
| L1-L7 | ๐ด ุฌุฏูุฏ | โ ููุชูู | report_engine + designer_window + form_canvas + generators |
| Q1-Q7 | ๐ด ุฌุฏูุฏ | โ ููุชูู | printer/scanner discovery + bluetooth + scan_engine |
| A5 pool | โณ ูุงุญูุงู | โ ููุชูู | pool.py (224 ุณุทุฑ) ููุฌูุฏ ูู D2 |
| D2,D3,D6 | ุจุฏูู โ | โ ููุชูู | pool.py, toast_manager.py, fluent/widgets.py |

### ูุณุจุฉ ุงูุฅูุฌุงุฒ ุงูุฅุฌูุงููุฉ

```
ุงููุญุงูุฑ ุงููุฎุทุทุฉ: 18 ูุญูุฑ (A-R)
ุงููุญุงูุฑ ุงูููุชููุฉ: 16 ูุญูุฑ โ
ุงููุญุงูุฑ ุบูุฑ ุงูููุชููุฉ: 0 ูุญูุฑ
ุงููุญุงูุฑ ุงููุณุชูุจููุฉ: 2 ูุญูุฑ (E, F)

ูุณุจุฉ ุฅูุฌุงุฒ ุงููุฎุทุท: 16/16 = 100% โ
(ุจุงุณุชุซูุงุก E ู F ุงููุณุชูุจููุฉ)
```
